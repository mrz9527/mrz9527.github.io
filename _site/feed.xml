<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>mrz9527</title>
    <description>欢迎来到我的个人站~</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Tue, 12 Apr 2022 17:33:33 +0800</pubDate>
    <lastBuildDate>Tue, 12 Apr 2022 17:33:33 +0800</lastBuildDate>
    <generator>Jekyll v4.2.2</generator>
    
      <item>
        <title>Ndk性能分析工具之simpleperf</title>
        <description>&lt;h1 id=&quot;simpleperf&quot;&gt;simpleperf&lt;/h1&gt;

&lt;p&gt;simpleperf是ndk包下的一个性能分析工具，专门用于分析ndk。&lt;/p&gt;

&lt;p&gt;simpleperf有两种工作方式，一种是可执行文件的方式，一种是脚本的方式。&lt;/p&gt;

&lt;p&gt;下载ndk包，里面自带simpleperf。&lt;/p&gt;

&lt;p&gt;/Users/xm210408/Library/Android/sdk/ndk/21.1.6352462/simpleperf&lt;/p&gt;

&lt;p&gt;准备工作&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;simpleperf输出性能数据和报告的命令，主要是在pc端运行。
simpleperf用到了adb，需要有adb环境。
手机连接pc机。
执行app_profiler.py脚本，按照提示，手动启动手机上相应app，自动输出性能数据
执行report_html.py脚本，输出报告。

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;输出性能数据&quot;&gt;输出性能数据&lt;/h2&gt;

&lt;p&gt;记录设备上app运行过程，在本机pc上生成性能数据perf.data。用到的脚本是app_profiler.py。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python app_profiler.py -p simpleperf.example.cpp -lib /Users/xm210408/programs/extras/simpleperf/demo/SimpleperfExampleCpp/app/build/intermediates/cmake/debug/obj/arm64-v8a/

python app_profiler.py -p com.tencent.olhct2soLibrary -lib /Users/xm210408/program2/olhct_sdk/app/build/intermediates/cmake/debug/obj/arm64-v8a/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;-p simpleperf.example.cpp是手机中android项目的进程，-lib libdir是ndk编译的so所在的目录，运行python脚本需要python3的环境。&lt;/p&gt;

&lt;h2 id=&quot;生成报告&quot;&gt;生成报告&lt;/h2&gt;

&lt;p&gt;解析性能数据文件perf.data，生成分析报告。&lt;/p&gt;

&lt;p&gt;report_html.py在simpleperf目录下。–source_dirs ../demo是源码cpp所在目录。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python report_html.py --add_source_code --source_dirs ../demo --add_disassembly

python report_html.py --add_source_code --source_dirs /Users/xm210408/program2/olhct_sdk/app/src/main/cpp --add_disassembly -o xxx.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;其他功能&quot;&gt;其他功能&lt;/h2&gt;

&lt;p&gt;在simpleperf目录下，还有很多其他的脚本可供使用。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;py&quot;&lt;/span&gt;
__init__.py
annotate.py
api_profiler.py
app_profiler.py
binary_cache_builder.py
debug_unwind_reporter.py
pprof_proto_generator.py
profile_pb2.py
report.py
report_html.py
report_sample.py
run_simpleperf_on_device.py
run_simpleperf_without_usb_connection.py
simpleperf_report_lib.py
utils.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;官方资料&quot;&gt;官方资料&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://developer.android.com/ndk/guides/simpleperf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Tue, 12 Apr 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/04/ndk%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E4%B9%8Bsimpleperf/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/04/ndk%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E4%B9%8Bsimpleperf/</guid>
        
        
      </item>
    
      <item>
        <title>Elasticsearch使用</title>
        <description>&lt;p&gt;elasticsearch搜索引擎&lt;/p&gt;

&lt;h1 id=&quot;0-概念和语法&quot;&gt;0. 概念和语法&lt;/h1&gt;

&lt;p&gt;在elasticsearch中。&lt;/p&gt;

&lt;p&gt;index：索引，类似于数据库的一张表&lt;/p&gt;

&lt;p&gt;mapping：索引的映射，类似于表的表头，包含了表的所有字段以及字段的类型&lt;/p&gt;

&lt;p&gt;properties:映射属性，里面烦恼歌如索引的映射的所有字段&lt;/p&gt;

&lt;p&gt;text：映射中字段的类型，text表示全文索引，会分词&lt;/p&gt;

&lt;p&gt;keyword：映射中的字段类型，keyword表示关键字，不会分词，作为一个整体来搜索&lt;/p&gt;

&lt;p&gt;type：在映射中，代表字段的类型，在文档中，代表文档的类型，在分词器中，代表分词器类型&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;elasticsearch提供的默认关键字&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;uri关键字&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;_open, _close, _cat, _update, _mapping, _doc, _cluster, _analyze&lt;/p&gt;

&lt;p&gt;/shop/_open:打开索引&lt;/p&gt;

&lt;p&gt;/shop/_close:关闭索引&lt;/p&gt;

&lt;p&gt;/_cat/indices?v:查看所有索引&lt;/p&gt;

&lt;p&gt;/shop/_doc:索引名为shop下的文档类型，7.2版本默认只有一个文档类型_doc，不存在多个类型&lt;/p&gt;

&lt;p&gt;/shop/_update/1:更该文档内容后更新&lt;/p&gt;

&lt;p&gt;/_cluster/settings:集群设置&lt;/p&gt;

&lt;p&gt;/_analyze:分词工具，（analyzer是分词器，两者有区别，在实际配置分词器时，用的是analyzer）&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;响应或请求中数据的关键字&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;_id, _source, _version, _shards, _score, _source&lt;/p&gt;

&lt;p&gt;elasticsearch服务器的uri结构，elasticsearch系统uri以下划线开头，比如_open, _close, _cat, _update, _mapping, _doc等&lt;/p&gt;

&lt;p&gt;通用情况下，uri的1级路径是索引名(如shop)，2级路径是文档_doc，3级路径是文档id&lt;/p&gt;

&lt;p&gt;localhost:9200/shop/_doc/1&lt;/p&gt;

&lt;p&gt;shop:就是索引&lt;/p&gt;

&lt;p&gt;1：就是索引中文档id为1的文档&lt;/p&gt;

&lt;p&gt;集群设置，自动增加索引&lt;/p&gt;

&lt;p&gt;http://localhost:9200/_cluster/settings&lt;/p&gt;

&lt;p&gt;auto_create_index&lt;/p&gt;

&lt;h1 id=&quot;1下载安装启动配置文件&quot;&gt;1.下载安装、启动、配置文件&lt;/h1&gt;

&lt;p&gt;官网：elastic.co下载&lt;/p&gt;

&lt;p&gt;解压之后，假定es_home代表安装目录&lt;/p&gt;

&lt;p&gt;$(es_home)/bin/elasticsearch是可执行文件，直接启动&lt;/p&gt;

&lt;p&gt;启动后，默认端口是9200。&lt;/p&gt;

&lt;p&gt;$(es_home)/config/elasticsearch.yml是配置文件，可以修改默认端口&lt;/p&gt;

&lt;p&gt;浏览器中输入http://localhost:9200，即可成功请求elasticsearch服务器，我这里使用postman工具&lt;/p&gt;

&lt;h1 id=&quot;2-索引增删改查&quot;&gt;2. 索引：增删改查&lt;/h1&gt;

&lt;p&gt;elasticsearch的索引，相当于数据库的一张表&lt;/p&gt;

&lt;h2 id=&quot;创建索引&quot;&gt;创建索引&lt;/h2&gt;

&lt;p&gt;PUT	localhost:9200/&lt;strong&gt;shop&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;这里shop就是我创建的索引，索引在服务器根目录下&lt;/p&gt;

&lt;p&gt;PUT	localhost:9200/&lt;strong&gt;nba&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;这里nba也是我创建的索引，索引在服务器根目录下&lt;/p&gt;

&lt;h2 id=&quot;查看指定索引&quot;&gt;&lt;strong&gt;查看指定索引&lt;/strong&gt;&lt;/h2&gt;

&lt;p&gt;GET	localhost:9200/&lt;strong&gt;shop&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;GET	localhost:9200/&lt;strong&gt;shop,nba&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;查看所有索引&quot;&gt;&lt;strong&gt;查看所有索引&lt;/strong&gt;&lt;/h2&gt;

&lt;p&gt;GET localhost:9200/_all&lt;/p&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;p&gt;GET localhost:9200/_cat/indices?v&lt;/p&gt;

&lt;h2 id=&quot;关闭索引&quot;&gt;关闭索引&lt;/h2&gt;

&lt;p&gt;POST localhost:9200/shop/_close&lt;/p&gt;

&lt;h2 id=&quot;打开索引&quot;&gt;打开索引&lt;/h2&gt;

&lt;p&gt;POST localhost:9200/shop/_open&lt;/p&gt;

&lt;h1 id=&quot;3映射mapping&quot;&gt;3.映射mapping&lt;/h1&gt;

&lt;p&gt;索引的映射，相当于表的表结构（或者表头），也就是字段&lt;/p&gt;

&lt;h2 id=&quot;创建索引的映射&quot;&gt;创建索引的映射&lt;/h2&gt;

&lt;p&gt;以json的形式创建字段&lt;/p&gt;

&lt;p&gt;PUT 	localhost:9200/shop/_mapping -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d’&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​    “properties”:{&lt;/p&gt;

&lt;p&gt;​        “name”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”text”&lt;/p&gt;

&lt;p&gt;​        },&lt;/p&gt;

&lt;p&gt;​        “price”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”keyword”&lt;/p&gt;

&lt;p&gt;​        },&lt;/p&gt;

&lt;p&gt;​        “tag”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”keyword”&lt;/p&gt;

&lt;p&gt;​        }&lt;/p&gt;

&lt;p&gt;​    }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211111162918875.png&quot; alt=&quot;image-20211111162918875&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;查看索引的映射&quot;&gt;查看索引的映射&lt;/h2&gt;

&lt;p&gt;GET 	localhost:9200/shop/_mapping&lt;/p&gt;

&lt;p&gt;GET 	localhost:9200/shop,nba/_mapping&lt;/p&gt;

&lt;p&gt;GET 	localhost:9200/shop/_mappings&lt;/p&gt;

&lt;p&gt;GET 	localhost:9200/shop,nba/_mappings&lt;/p&gt;

&lt;h2 id=&quot;查看所有索引的映射&quot;&gt;查看所有索引的映射&lt;/h2&gt;

&lt;p&gt;GET localhost:9200/_mapping&lt;/p&gt;

&lt;p&gt;或者&lt;/p&gt;

&lt;p&gt;GET localhost:9200/_all/_mapping&lt;/p&gt;

&lt;h2 id=&quot;增加映射的字段不能修改字段的类型&quot;&gt;增加映射的字段（不能修改字段的类型）&lt;/h2&gt;

&lt;p&gt;PUT 	localhost:9200/shop/_mapping -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​    “properties”:{&lt;/p&gt;

&lt;p&gt;​        “name”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”text”&lt;/p&gt;

&lt;p&gt;​        },&lt;/p&gt;

&lt;p&gt;​        “price”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”keyword”&lt;/p&gt;

&lt;p&gt;​        },&lt;/p&gt;

&lt;p&gt;​        “tag”:{&lt;/p&gt;

&lt;p&gt;​            “type”:”keyword”&lt;/p&gt;

&lt;p&gt;​        },&lt;/p&gt;

&lt;p&gt;​		&lt;strong&gt;“date”:{&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;​		&lt;strong&gt;“type”:”text”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;​		&lt;strong&gt;}&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;​    }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;在原来基础上增加date字段&lt;/p&gt;

&lt;h2 id=&quot;创建索引的同时创建映射和其他配置项比如分词器&quot;&gt;创建索引的同时创建映射和其他配置项，比如分词器&lt;/h2&gt;

&lt;p&gt;POST	localhost:9200/kikaindex -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​    “settings”:{&lt;/p&gt;

&lt;p&gt;​        “analysis”:{&lt;/p&gt;

&lt;p&gt;​            “analyzer”:{&lt;/p&gt;

&lt;p&gt;​                “ws_analyze”:{&lt;/p&gt;

&lt;p&gt;​                    “type”:”whitespace”&lt;/p&gt;

&lt;p&gt;​                },&lt;/p&gt;

&lt;p&gt;​                “s_analyze”:{&lt;/p&gt;

&lt;p&gt;​                    “type”:”standard”&lt;/p&gt;

&lt;p&gt;​                }&lt;/p&gt;

&lt;p&gt;​             }&lt;/p&gt;

&lt;p&gt;​         }&lt;/p&gt;

&lt;p&gt;​    },&lt;/p&gt;

&lt;p&gt;​    “mappings”: {&lt;/p&gt;

&lt;p&gt;​        “properties”:{&lt;/p&gt;

&lt;p&gt;​            “name”:{&lt;/p&gt;

&lt;p&gt;​                “type”:”keyword”&lt;/p&gt;

&lt;p&gt;​            },&lt;/p&gt;

&lt;p&gt;​            “tag”:{&lt;/p&gt;

&lt;p&gt;​                “type”:”text”,&lt;/p&gt;

&lt;p&gt;​                “analyzer”:”ws_analyze”&lt;/p&gt;

&lt;p&gt;​            },&lt;/p&gt;

&lt;p&gt;​            “position”:{&lt;/p&gt;

&lt;p&gt;​                “type”:”text”,&lt;/p&gt;

&lt;p&gt;​                “analyzer”:”s_analyze”&lt;/p&gt;

&lt;p&gt;​            },&lt;/p&gt;

&lt;p&gt;​            “personCount”:{&lt;/p&gt;

&lt;p&gt;​                “type”:”long”&lt;/p&gt;

&lt;p&gt;​            }&lt;/p&gt;

&lt;p&gt;​        }&lt;/p&gt;

&lt;p&gt;​    }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;创建索引kikaime的同时，指定了settings和mappings，&lt;/p&gt;

&lt;h1 id=&quot;4-文档&quot;&gt;4. 文档&lt;/h1&gt;

&lt;p&gt;索引中的文档，相当于数据库中表的记录record。&lt;/p&gt;

&lt;h2 id=&quot;新增文档&quot;&gt;新增文档&lt;/h2&gt;

&lt;p&gt;创建指定文档和文档的索引&lt;/p&gt;

&lt;p&gt;PUT 	localhost:9200/shop/_doc/1 -H ‘Content-type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​	“name”:”小米”,&lt;/p&gt;

&lt;p&gt;​	“price”:”1.2”,&lt;/p&gt;

&lt;p&gt;​	“tag”:”属于食品”,&lt;/p&gt;

&lt;p&gt;​	“date”:”2021.9.10”&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211111172020265.png&quot; alt=&quot;image-20211111172020265&quot; /&gt;&lt;/p&gt;

&lt;p&gt;创建文档时不指定文档内的id，会自动创建文档索引&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211111172304123.png&quot; alt=&quot;image-20211111172304123&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;查看文档&quot;&gt;查看文档&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211111171928445.png&quot; alt=&quot;image-20211111171928445&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;查看多个文档&quot;&gt;查看多个文档&lt;/h2&gt;

&lt;p&gt;post	localhost:9200/_mget -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​		“docs”:[&lt;/p&gt;

&lt;p&gt;​				{&lt;/p&gt;

&lt;p&gt;​						“_index”:”shop”,&lt;/p&gt;

&lt;p&gt;​						“_type”:”_doc”,&lt;/p&gt;

&lt;p&gt;​						“_id”:”1”&lt;/p&gt;

&lt;p&gt;​				}&lt;/p&gt;

&lt;p&gt;​		]&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;或者在指定索引下查看多个文档&lt;/p&gt;

&lt;p&gt;POST	localhost:9200/shop/_mget -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​		“docs”:[&lt;/p&gt;

&lt;p&gt;​				{&lt;/p&gt;

&lt;p&gt;​						“_type”:”_doc”,&lt;/p&gt;

&lt;p&gt;​						“_id”:”1”&lt;/p&gt;

&lt;p&gt;​				}&lt;/p&gt;

&lt;p&gt;​		]&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;h2 id=&quot;修改文档&quot;&gt;修改文档&lt;/h2&gt;

&lt;p&gt;POST	localhost:9200/shop/_update/1 -H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’ -d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​	“name”:”小米”,&lt;/p&gt;

&lt;p&gt;​	&lt;strong&gt;“price”:”2”,&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;​	“tag”:”属于食品”,&lt;/p&gt;

&lt;p&gt;​	“date”:”2021.9.10”&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;h1 id=&quot;5-搜索&quot;&gt;5. 搜索&lt;/h1&gt;

&lt;p&gt;term：词条查询，词条查询不会分析查询条件，&lt;/p&gt;

&lt;p&gt;full text：全文查询&lt;/p&gt;

&lt;h2 id=&quot;term查询&quot;&gt;term查询&lt;/h2&gt;

&lt;p&gt;POST	localhost:9200/shop/_search 	-H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’	-d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​	“query”:{&lt;/p&gt;

&lt;p&gt;​		“term”:{&lt;/p&gt;

&lt;p&gt;​				“name”:”来一桶”&lt;/p&gt;

&lt;p&gt;​			}&lt;/p&gt;

&lt;p&gt;​	}&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;term查询不支持一个字段查询多个值，比如只能查“来一桶”，不能一次查“来一桶”和“小米”。&lt;/p&gt;

&lt;h2 id=&quot;full-text查询&quot;&gt;full text查询&lt;/h2&gt;

&lt;h3 id=&quot;match_all查询全部&quot;&gt;match_all查询全部&lt;/h3&gt;

&lt;p&gt;match_all默认只显示10条，如果想显示全部，可以指定分页&lt;/p&gt;

&lt;p&gt;POST	localhost:9200/shop/_search 	-H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’	-d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​	“query”:{&lt;/p&gt;

&lt;p&gt;​		“match_all”:{}&lt;/p&gt;

&lt;p&gt;​	},&lt;/p&gt;

&lt;p&gt;​	“from”:0&lt;/p&gt;

&lt;p&gt;​	“size”:100&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;这里从0开始，显示100条结果&lt;/p&gt;

&lt;h3 id=&quot;match普通查询&quot;&gt;match普通查询&lt;/h3&gt;

&lt;p&gt;POST	localhost:9200/shop/_search 	-H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’	-d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​	“query”:{&lt;/p&gt;

&lt;p&gt;​		“match”:{&lt;/p&gt;

&lt;p&gt;​			“name”:”小米”&lt;/p&gt;

&lt;p&gt;​		}&lt;/p&gt;

&lt;p&gt;​	}&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;h3 id=&quot;multi_match多字段查询&quot;&gt;multi_match多字段查询&lt;/h3&gt;

&lt;p&gt;POST	localhost:9200/nba/_search 	-H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’	-d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​    “query”:{&lt;/p&gt;

&lt;p&gt;​        “multi_match”:{&lt;/p&gt;

&lt;p&gt;​            “query”:”科比”,&lt;/p&gt;

&lt;p&gt;​            “fields”:[“team”,”name”]&lt;/p&gt;

&lt;p&gt;​        }&lt;/p&gt;

&lt;p&gt;​    }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;h3 id=&quot;match_phrase&quot;&gt;match_phrase&lt;/h3&gt;

&lt;p&gt;类似term词条查询，查询字符串不会拆分&lt;/p&gt;

&lt;p&gt;语法类似match和term&lt;/p&gt;

&lt;h3 id=&quot;match_phrase_prefix-前缀查询&quot;&gt;match_phrase_prefix 前缀查询&lt;/h3&gt;

&lt;p&gt;match_phrase_prefix语法和match和term一致，一般针对英文单词来进行前缀查询&lt;/p&gt;

&lt;h1 id=&quot;6-分词&quot;&gt;6. 分词&lt;/h1&gt;

&lt;p&gt;查看分词效果&lt;/p&gt;

&lt;p&gt;POST	localhost:9200/_analyze 	-H ‘Content-Type:&lt;/p&gt;

&lt;p&gt;application/json’	-d ‘&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

&lt;p&gt;​    “analyzer”:”standard”,&lt;/p&gt;

&lt;p&gt;​    “text”:”best 3-points Curry!”&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;’&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211112103331923.png&quot; alt=&quot;image-20211112103331923&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;常见分词器&quot;&gt;常见分词器&lt;/h2&gt;

&lt;h2 id=&quot;内置分词器analyzer&quot;&gt;内置分词器analyzer&lt;/h2&gt;

&lt;p&gt;​	standard:标准分词器是默认的分词器，大写会变成小写，字母和数字以外的字符会丢弃&lt;/p&gt;

&lt;p&gt;​	simple：simple分词器，大写变成小写，字母以外的字符会丢弃&lt;/p&gt;

&lt;p&gt;​	whitespace：空白字符分词器，按照空白符分词，所有字符都不会丢弃（除了空白字符）&lt;/p&gt;

&lt;p&gt;​	stop：停用词分词器，在simple基础上，将停用词丢弃（the is at in of等等会被丢弃），会有一个专门的停用词列表&lt;/p&gt;

&lt;p&gt;​	language：特定语言的分词器，比如英语english，内置语言：几十种海外语言&lt;/p&gt;

&lt;p&gt;​	pattern：正则分词器，使用正则表达式将文本进行分词，默认正则表达式是\W+，（这种默认表达式，保留字母和数字，其余字符丢弃），可以修改正则表达式。&lt;/p&gt;

&lt;h2 id=&quot;中文分词器&quot;&gt;中文分词器&lt;/h2&gt;

&lt;p&gt;内置分词器对中文不友好，需要使用中文分词器。&lt;/p&gt;

&lt;h3 id=&quot;smartcn分词器&quot;&gt;smartcn分词器&lt;/h3&gt;

&lt;p&gt;是中文或中英混合分词器&lt;/p&gt;

&lt;p&gt;安装：进入$(es_home)/bin/目录，在该目录下执行&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sh elasticsearch-plugin &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;analysis-smartcn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;安装完成后重启es服务，即可使用该分词器。&lt;/p&gt;

&lt;p&gt;重新启动es时可能会报”org.elasticsearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to obtain node locks“错误，是因为上一次启动的es没有关闭，需要关闭。&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ps -ef&lt;/td&gt;
      &lt;td&gt;grep ‘elastic’查看es进程号，然后kill关闭该进程。然后再启动。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;ik分词器&quot;&gt;ik分词器&lt;/h3&gt;

&lt;p&gt;下载：https://github.com/medcl/elasticsearch-analysis-ik/releases&lt;/p&gt;

&lt;p&gt;下载与es版本一致的ik版本，本地使用的es是7.2.1，所以ik也选择7.2.1&lt;/p&gt;

&lt;p&gt;ik分词器的型别为：ik_max_word&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/Users/xm210408/Library/Application Support/typora-user-images/image-20211112144355134.png&quot; alt=&quot;image-20211112144355134&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;7-常见字段类型&quot;&gt;7. 常见字段类型&lt;/h1&gt;

&lt;h2 id=&quot;字符串类型&quot;&gt;字符串类型&lt;/h2&gt;

&lt;p&gt;text&lt;/p&gt;

&lt;p&gt;keyword&lt;/p&gt;

&lt;h2 id=&quot;数值型&quot;&gt;数值型&lt;/h2&gt;

&lt;p&gt;long,integer,short,byte,double,float,half_float,scaled_float&lt;/p&gt;

&lt;h2 id=&quot;布尔型&quot;&gt;布尔型&lt;/h2&gt;

&lt;p&gt;boolean&lt;/p&gt;

&lt;h2 id=&quot;二进制&quot;&gt;二进制&lt;/h2&gt;

&lt;p&gt;binary&lt;/p&gt;

&lt;p&gt;该类型的字段把值当做经过base64编码的字符串，默认不存储，且不可搜索&lt;/p&gt;

&lt;h2 id=&quot;范围类型&quot;&gt;范围类型&lt;/h2&gt;

&lt;p&gt;范围类型表示值是一个范围，而不是一个具体值&lt;/p&gt;

&lt;p&gt;integer_range, float_range, long_range, double_range, date_range&lt;/p&gt;

&lt;p&gt;比如age的类型是integer_range，那么值可以是{“gte”:20, “lte”:40}; 搜索”term”:{“age”:21}可以搜索该值&lt;/p&gt;

&lt;p&gt;gte:大于等于，greate than equal&lt;/p&gt;

&lt;p&gt;lte:小于等于&lt;/p&gt;

&lt;h2 id=&quot;日期类型&quot;&gt;日期类型&lt;/h2&gt;

&lt;p&gt;date&lt;/p&gt;

&lt;h2 id=&quot;数组类型&quot;&gt;数组类型&lt;/h2&gt;

&lt;h2 id=&quot;对象类型&quot;&gt;对象类型&lt;/h2&gt;

&lt;h2 id=&quot;专有类型&quot;&gt;专有类型&lt;/h2&gt;

&lt;p&gt;ip地址&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Apr 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/04/elasticsearch%E4%BD%BF%E7%94%A8/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/04/elasticsearch%E4%BD%BF%E7%94%A8/</guid>
        
        
      </item>
    
      <item>
        <title>网络分析工具</title>
        <description>&lt;h1 id=&quot;工具分类&quot;&gt;工具分类&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;网络配置相关：ifconfig、ip&lt;/li&gt;
  &lt;li&gt;路由相关：route、netstat、ip&lt;/li&gt;
  &lt;li&gt;查看端口工具：netstat、lsof、ss、nc、telnet&lt;/li&gt;
  &lt;li&gt;下载工具：curl、wget、axel&lt;/li&gt;
  &lt;li&gt;防火墙：iptables、ipset&lt;/li&gt;
  &lt;li&gt;流量相关：iftop、nethogs&lt;/li&gt;
  &lt;li&gt;连通性及响应速度：ping、traceroute、mtr、tracepath&lt;/li&gt;
  &lt;li&gt;域名相关：nslookup、dig、whois&lt;/li&gt;
  &lt;li&gt;web服务器：python、nginx&lt;/li&gt;
  &lt;li&gt;抓包相关：tcpdump&lt;/li&gt;
  &lt;li&gt;网桥相关：ip、brctl、ifconfig、ovs&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;部分工具介绍&quot;&gt;部分工具介绍&lt;/h1&gt;

&lt;h2 id=&quot;ping&quot;&gt;ping&lt;/h2&gt;

&lt;p&gt;采用的协议是ICMP&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;常见命令参数
-q 不显示任何传送封包的信息，只显示最后的结果
-n 只输出数值
-R 记录路由过程
-c count 总次数
-i 时间间隔
-t 存活数值：设置存活数值TTL的大小
-s 设置发送包的大小。默认情况下，ping命令是以64字节大小的数据包来测试网络连通性
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;测试对方ip是否存在&quot;&gt;测试对方ip是否存在&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 2 10.10.10.221
PING 10.10.10.221 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.221&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 56 data bytes
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.433 ms
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.441 ms
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; 10.10.10.221 ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max/stddev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0.433/0.437/0.441/0.000 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果对方禁止ICMP协议，也会ping不通&lt;/p&gt;

&lt;h3 id=&quot;测试网速&quot;&gt;测试网速&lt;/h3&gt;

&lt;p&gt;就是查看网络延迟&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.433 ms
&lt;span class=&quot;c&quot;&gt;# time=0.433 ms，表示网络延迟为0.433 ms&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;解析域名&quot;&gt;解析域名&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 域名转ip&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 2 www.baidu.com
PING www.a.shifen.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;220.181.38.150&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 56 data bytes
64 bytes from 220.181.38.150: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;44 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5.874 ms
64 bytes from 220.181.38.150: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;44 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;9.107 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ping对方主机，发送4个包，每个包间隔1秒&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 4 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 1 10.10.10.221
PING 10.10.10.221 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.221&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 56 data bytes
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.447 ms
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.802 ms
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.681 ms
64 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.597 ms
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; 10.10.10.221 ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0.447/0.632/0.802/0.129 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;测试mtu&quot;&gt;测试MTU&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# -s 选项来发现网络环境中有关MTU（网络上传最大的数据包）的问题&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 4 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 40 10.10.10.221
PING 10.10.10.221 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.221&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 40 data bytes
48 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.354 ms
48 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.587 ms
48 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.399 ms
48 bytes from 10.10.10.221: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;64 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0.422 ms
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; 10.10.10.221 ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0.354/0.440/0.587/0.088 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# -s 发送8192个字节数据，发送失败，包过大&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 4 &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 8192 10.10.10.221
PING 10.10.10.221 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.221&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 8192 data bytes
ping: sending packet: Message too long
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;telnet&quot;&gt;telnet&lt;/h2&gt;

&lt;h3 id=&quot;测试对方开放的端口&quot;&gt;测试对方开放的端口&lt;/h3&gt;

&lt;p&gt;netstat也可以查看端口，但&lt;strong&gt;局限于本机&lt;/strong&gt;。netstat -tnlp，可以查看本地处于监听的端口号。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;telnet ip port
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 22端口存在&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 10.10.10.221 22
Trying 10.10.10.221...
Connected to 10.10.10.221.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 5005端口不存在&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 10.10.10.221 5005
Trying 10.10.10.221...
telnet: Unable to connect to remote host: Connection refused
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;lsof&quot;&gt;lsof&lt;/h2&gt;

&lt;p&gt;list open files。Linux中一切皆文件，socket、pipe等也是文件，因此能够查看网络连接以及网络设备，其中和网络相关的是&lt;strong&gt;-i&lt;/strong&gt;选项。&lt;/p&gt;

&lt;h3 id=&quot;查看网络通信的进程号&quot;&gt;查看网络通信的进程号&lt;/h3&gt;

&lt;p&gt;lsof有很多选项，每个选项有不同的作用。&lt;strong&gt;使用-i选项，用于查看网络通信的本地进程&lt;/strong&gt;。lsof命令必须有sudo权限&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 用法&lt;/span&gt;
lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;46] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;protocol][@hostname|hostaddr][:service|port]

lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; //显示所有打开的端口
lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;:80 //显示所有打开80端口的进程
lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; //显示所有打开的端口和UNIX domain文件
lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; UDP@[url]www.akadia.com:123 //显示那些进程打开了到www.akadia.com的UDP的123&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ntp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;端口的链接
lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; tcp@ohaha.ks.edu.tw:ftp &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; //lsof &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 不将IP转换为hostname，缺省是不加上-n参数
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 查看本机与10.10.10.221:6380的tcp通信的本地进程，查到本机进程id为18434，程序为redis-cli&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;lsof &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; tcp@10.10.10.221:6380
Password:
COMMAND     PID     USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
redis-cli 18434 xm210408    3u  IPv4 0x9864983a46f27629      0t0  TCP 10.10.10.1:62403-&amp;gt;10.10.10.221:6380 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ESTABLISHED&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 通过ps，的确查到18434进程。&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;redis-cli
  501 18533 18000   0  2:13下午 ttys001    0:00.00 &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;redis-cli
  501 18434 18281   0 12:50下午 ttys005    0:00.01 redis-cli &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6380 &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.221
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;netstat&quot;&gt;netstat&lt;/h2&gt;

&lt;p&gt;netstat一般&lt;strong&gt;用于检验本机各端口的网络连接情况&lt;/strong&gt;，显示与IP、TCP、UDP和ICMP协议相关的统计数据，netstat是在内核中访问网络及相关信息的程序。
&lt;strong&gt;常用选项&lt;/strong&gt;：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;all&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;显示所有选项，默认不显示LISTEN相关
&lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;仅显示tcp相关选项
&lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;udp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;仅显示udp相关选项
&lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 拒绝显示别名，能显示数字的全部转化成数字
&lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 仅列出有在 Listen &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;监听&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 的服務状态
&lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 显示建立相关链接的程序名
&lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; 显示路由信息，路由表
&lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; 显示扩展信息，例如uid等
&lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 按各个协议进行统计
&lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 每隔一个固定时间，执行该netstat命令
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;状态status&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LISTEN：侦听来自远方的TCP端口的连接请求
SYN-SENT：再发送连接请求后等待匹配的连接请求（如果有大量这样的状态包，检查是否中招了）
SYN-RECEIVED：再收到和发送一个连接请求后等待对方对连接请求的确认（如有大量此状态，估计被flood攻击了）
ESTABLISHED：代表一个打开的连接
FIN-WAIT-1：等待远程TCP连接中断请求，或先前的连接中断请求的确认
FIN-WAIT-2：从远程TCP等待连接中断请求
CLOSE-WAIT：等待从本地用户发来的连接中断请求
CLOSING：等待远程TCP对连接中断的确认
LAST-ACK：等待原来的发向远程TCP的连接中断请求的确认（不是什么好东西，此项出现，检查是否被攻击）
TIME-WAIT：等待足够的时间以确保远程TCP接收到连接中断请求的确认
CLOSED：没有任何连接状态
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;查看处于监听的tcp连接及端口号&quot;&gt;查看处于监听的tcp连接及端口号&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;netstat &lt;span class=&quot;nt&quot;&gt;-tnlp&lt;/span&gt;
Active Internet connections &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;only servers&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:33622         0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      68787/python3.5 
tcp        0      0 0.0.0.0:22              0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      877/sshd        
tcp        0      0 0.0.0.0:6379            0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      60037/redis-server 
tcp        0      0 0.0.0.0:6380            0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      60049/redis-server 
tcp        0      0 0.0.0.0:6381            0.0.0.0:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;               LISTEN      60055/redis-server 
tcp6       0      0 :::22                   :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      877/sshd        
tcp6       0      0 :::6380                 :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      60049/redis-server 
tcp6       0      0 :::6381                 :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      60055/redis-server 
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netstat &lt;span class=&quot;nt&quot;&gt;-lntp&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $4}'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f2&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;: | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'[0-9]*'&lt;/span&gt;
33622
22
6379
6380
6381
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;端口号33622、22、6379、6380、6381处于监听状态。&lt;/p&gt;

&lt;h3 id=&quot;查看路由&quot;&gt;查看路由&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netstat  &lt;span class=&quot;nt&quot;&gt;-rn&lt;/span&gt;
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         10.10.10.2      0.0.0.0         UG        0 0          0 ens33
10.10.10.0      0.0.0.0         255.255.255.0   U         0 0          0 ens33
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Flags：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;U &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;route is up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：该路由是有效的；
H &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;target is a host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：目标是主机而非网域；
G &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;use gateway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：需要透过外部的主机 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gateway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 来转递封包（一般指向默认网关）；
R &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;reinstate route &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;dynamic routing&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：使用动态路由时，恢复路由资讯的旗标；
D &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dynamically installed by daemon or redirect&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：已经由服务或转 port 功能设定为动态路由 &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
M &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;modified from routing daemon or redirect&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：路由已经被修改了；
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;reject route&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;：这个路由将不会被接受&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;用来抵挡不安全的网域&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;查看网关&quot;&gt;查看网关&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;netstat  &lt;span class=&quot;nt&quot;&gt;-rn&lt;/span&gt;  | &lt;span class=&quot;nb&quot;&gt;grep  &lt;/span&gt;UG  | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;  | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-f2&lt;/span&gt;
10.10.10.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;traceroute&quot;&gt;traceroute&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;traceroute &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;
Usage: traceroute &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;OPTION...] HOST
Print the route packets trace to network host.


  &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--max-hop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NUM          设置检测数据包的最大跳数，默认64
  &lt;span class=&quot;nt&quot;&gt;-M&lt;/span&gt;, &lt;span class=&quot;nt&quot;&gt;--type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;METHOD          use METHOD &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;icmp&lt;span class=&quot;s1&quot;&gt;' or `udp'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;traceroute
                             operations, defaulting to &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;udp&lt;span class=&quot;s1&quot;&gt;'
  -p, --port=PORT            use destination PORT port (default: 33434)
  -w, --wait=NUM             超时时间，设置等待远端主机回应的时间为NUM秒 (default: 3)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在windows上，使用tracert代替。
查看本机与目标之间的所有路由路径，能看到每一跳的ip和耗时。&lt;/p&gt;

&lt;h3 id=&quot;查看主机及目标之间的路由路径&quot;&gt;查看主机及目标之间的路由路径&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;traceroute www.baidu.com
traceroute to www.a.shifen.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;220.181.38.150&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 64 hops max
  1   10.13.12.1  7.245ms  9.447ms  6.432ms 
  2   10.13.1.1  3.703ms  7.225ms  4.653ms 
  3   211.103.216.33  45.470ms  6.834ms  13.013ms 
  4   10.255.55.17  20.143ms  6.391ms  8.641ms 
  5   10.255.199.173  6.213ms  4.279ms  3.210ms 
  6   124.205.98.141  5.556ms  4.385ms  3.103ms 
  7   124.205.98.53  6.918ms  9.023ms  5.157ms 
  8   218.241.244.149  7.692ms  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 
  9   61.149.212.225  6.847ms  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 
 10   202.96.13.49  7.415ms  9.764ms  19.080ms 
 11   124.65.194.153  5.189ms  6.904ms  4.337ms 
 12   219.158.13.90  5.172ms  8.460ms  8.154ms 
 13   219.158.44.134  5.351ms  8.369ms  5.777ms 
 14   202.97.18.121  13.423ms  10.767ms  6.134ms 
 15   36.110.246.230  7.364ms  7.476ms  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 
 16   36.110.246.205  16.692ms  17.621ms  10.109ms 
 17   &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 
 18   106.38.244.134  44.541ms  28.065ms  31.264ms 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;第一跳是本机局域网的网关:	10.13.12.1
&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;：可能是防火墙封掉了ICMP的返回信息
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;设置跳数 -m&lt;/p&gt;

&lt;h2 id=&quot;nc&quot;&gt;nc&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;nc&lt;/strong&gt;（或&lt;strong&gt;netcat&lt;/strong&gt;）几乎涉及所有 TCP 或 UDP 的事情。它可以打开 TCP 连接、发送 UDP 数据包、侦听任意 TCP 和 UDP 端口。
默认是TCP，-u参数调整为udp。&lt;/p&gt;

&lt;h3 id=&quot;测试对方开放的端口-1&quot;&gt;测试对方开放的端口&lt;/h3&gt;

&lt;p&gt;黑客攻击必备&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 以tcp的方式向主机10.10.10.221的20到30号端口发送连接请求&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-zv&lt;/span&gt; 10.10.10.221 20-30
nc: connectx to 10.10.10.221 port 20 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 21 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
found 0 associations
found 1 connections:
     1: &lt;span class=&quot;nv&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;82&amp;lt;CONNECTED,PREFERRED&amp;gt;
        outif vmnet2
        src 10.10.10.1 port 64439
        dst 10.10.10.221 port 22
        rank info not available
        TCP aux info available

Connection to 10.10.10.221 port 22 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;tcp/ssh] succeeded!
nc: connectx to 10.10.10.221 port 23 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 24 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 26 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 27 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 28 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 29 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
nc: connectx to 10.10.10.221 port 30 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; failed: Connection refused
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-z	: 只连接,不发送数据
-v	:详细信息
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;当做聊天工具&quot;&gt;当做聊天工具&lt;/h3&gt;

&lt;p&gt;输入输出都在终端上。
搭建：client1和client2聊天&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 在client1的本机(10.10.10.221)上监听一个端口，比如1567&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 1567
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# client2向client1发起tcp连接请求，连接成功后即可通信&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 10.10.10.221
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# client1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 1567
hello
good
你好，zhongguoren
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# client2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 10.10.10.221 1567
hello
good
你好，zhongguoren
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;文件传输&quot;&gt;文件传输&lt;/h3&gt;

&lt;p&gt;主机a向主机b传输文件。
文件传输就是在聊天功能的基础上加入了重定向到文件的功能。
搭建：client1和client2文件传输&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# &amp;lt;发送文件&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 1567 &amp;lt; a.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# &amp;gt;接收文件&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc 10.10.10.221 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; a.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Tue, 29 Mar 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/03/%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/03/%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</guid>
        
        
      </item>
    
      <item>
        <title>C++统计代码段耗时</title>
        <description>&lt;p&gt;c/c++ 统计程序运行时间&lt;/p&gt;

&lt;h1 id=&quot;案例&quot;&gt;案例&lt;/h1&gt;

&lt;h2 id=&quot;写10万次redis数据&quot;&gt;写10万次redis数据&lt;/h2&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;redisContext&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;redisReply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  
&lt;span class=&quot;c1&quot;&gt;// 写10w条数据&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;redis_write_10w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;memset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sizeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;set c++k%d %d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;redisReply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redisCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      	&lt;span class=&quot;n&quot;&gt;freeReplyObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;redis_flushdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  	&lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;redisReply&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redisCommand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;flushdb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  	&lt;span class=&quot;n&quot;&gt;freeReplyObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// redis 连接&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redisConnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;// gettimeofday&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt;  &lt;span class=&quot;nc&quot;&gt;timeval&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gettimeofday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nullptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redis_write_10w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gettimeofday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nullptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;costtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_sec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_usec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_usec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;timeval : %f s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;costtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;n&quot;&gt;redis_flushdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;// time&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;time_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redis_write_10w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;time : %d s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;n&quot;&gt;redis_flushdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;// clock&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;clock_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redis_write_10w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;clock : %f s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CLOCKS_PER_SEC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;// 断开连接&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redisFree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;耗时结果&quot;&gt;耗时结果&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;timeval : 18.871461 s
time : 19 s
clock : 3.684796 s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;结果分析&quot;&gt;结果分析&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;为什么clock的耗时结果很离谱呢？

gettimeofday:获取当前系统时间，精确到微秒。
time:获取当前系统时间。精确到秒，精度较差
clock:获取cpu运行时间，精度到毫秒。

clock返回的是 CPU 耗费在本程序上的时间。也就是说，途中 有阻塞函数 的话，由于 CPU 资源被释放，那段时间将不被计算在内。因此，若函数中存在阻塞函数，则阻塞函数消耗的时间将不包含在内；而案例中使用的是redis的同步api，每次请求都会造成阻塞。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;函数用法&quot;&gt;函数用法&lt;/h1&gt;

&lt;h2 id=&quot;1-gettimeofday&quot;&gt;1. gettimeofday&lt;/h2&gt;

&lt;p&gt;获取当前时间，精确到微秒。
配合结构体struct  timeval使用。&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c1&quot;&gt;// gettimeofday&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt;  &lt;span class=&quot;nc&quot;&gt;timeval&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gettimeofday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nullptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// 执行耗时代码&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;gettimeofday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nullptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;costtime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_sec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_sec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_usec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_timeval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tv_usec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;timeval : %f s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;costtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-time&quot;&gt;2. time&lt;/h2&gt;

&lt;p&gt;获取当前时间，精确到秒。&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// time&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;time_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// 执行耗时代码&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;time : %d s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;3-clock&quot;&gt;3. clock&lt;/h2&gt;

&lt;p&gt;获取cpu执行时间。精确到毫秒。&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;kt&quot;&gt;clock_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redis_write_10w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;clock : %f s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e_clock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_clock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CLOCKS_PER_SEC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Mon, 28 Mar 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/03/C++%E7%BB%9F%E8%AE%A1%E4%BB%A3%E7%A0%81%E6%AE%B5%E8%80%97%E6%97%B6/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/03/C++%E7%BB%9F%E8%AE%A1%E4%BB%A3%E7%A0%81%E6%AE%B5%E8%80%97%E6%97%B6/</guid>
        
        
      </item>
    
      <item>
        <title>Linux磁盘分区</title>
        <description>&lt;h1 id=&quot;文件系统&quot;&gt;文件系统&lt;/h1&gt;

&lt;p&gt;文件系统作用：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;数据存储：&lt;/strong&gt;任何文件系统的主要功能都应该是存储和检索数据的结构化场所。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;命名空间：&lt;/strong&gt;一种命名和组织方法，提供命名和结构化数据的规则。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;安全模型：&lt;/strong&gt;一种用于定义访问权限的方案。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;API：&lt;/strong&gt;系统函数调用，用于操作文件系统对象，例如目录和文件。&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;实现：&lt;/strong&gt;该软件可以实现上述功能。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;文件系统类型：&lt;/p&gt;

&lt;p&gt;mkfs          mkfs.bfs      mkfs.cramfs   mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  mkfs.fat      mkfs.minix    mkfs.msdos    mkfs.ntfs     mkfs.vfat&lt;/p&gt;

&lt;p&gt;分区创建后需要格式化来设置文件系统类型&lt;/p&gt;

&lt;h1 id=&quot;mbr主引导扇区&quot;&gt;MBR主引导扇区&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;主引导记录&lt;/strong&gt;（Master Boot Record，缩写：MBR），又叫做&lt;strong&gt;主引导扇区&lt;/strong&gt;，是&lt;a href=&quot;https://zh.wikipedia.org/wiki/计算机&quot;&gt;计算机&lt;/a&gt;开机后访问&lt;a href=&quot;https://zh.wikipedia.org/wiki/硬盘&quot;&gt;硬盘&lt;/a&gt;时所必须要读取的首个&lt;a href=&quot;https://zh.wikipedia.org/wiki/磁盘扇区&quot;&gt;扇区&lt;/a&gt;，它在硬盘上的三维地址为（柱面，磁头，扇区）＝（0，0，1）。&lt;/p&gt;

&lt;p&gt;MBR分为三个部分：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;主引导程序：446字节&lt;/li&gt;
  &lt;li&gt;磁盘分区表（DPT）：64字节，每一个分区用16个字节表示，最多只有4个主分区&lt;/li&gt;
  &lt;li&gt;结束标志：2个字节（55AA）。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;所以磁盘管理方式为MBR的操作系统，一个磁盘最多只能有4个主分区，或者3个主分区+1个扩展分区，扩展分区本身不能存数据，必须在扩展分区上划分出多个逻辑分区之后，才能把数据存储到逻辑分区上。&lt;/p&gt;

&lt;p&gt;hd : ide磁盘接口类型&lt;/p&gt;

&lt;p&gt;sd : scsi磁盘接口类型&lt;/p&gt;

&lt;p&gt;磁盘命名：&lt;/p&gt;

&lt;p&gt;hda~hdz&lt;/p&gt;

&lt;p&gt;sda~sdz&lt;/p&gt;

&lt;p&gt;第一个磁盘sda可以有多个分区&lt;/p&gt;

&lt;p&gt;sda1&lt;/p&gt;

&lt;p&gt;sda2&lt;/p&gt;

&lt;p&gt;….&lt;/p&gt;

&lt;p&gt;sdax&lt;/p&gt;

&lt;p&gt;一般一个或两个主分区就够了，用来放操作系统相关数据&lt;/p&gt;

&lt;p&gt;sda1、sda2&lt;/p&gt;

&lt;p&gt;然后就是逻辑分区，一般从5开始（因为1，2，3，4为主分区或者扩展分区）&lt;/p&gt;

&lt;p&gt;sda5&lt;/p&gt;

&lt;h1 id=&quot;fdisk-分区&quot;&gt;fdisk 分区&lt;/h1&gt;

&lt;p&gt;添加硬盘设备、创建分区、挂载&lt;/p&gt;

&lt;h2 id=&quot;fdisk--l-查看磁盘和分区&quot;&gt;fdisk -l 查看磁盘和分区&lt;/h2&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# fdisk &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Disk /dev/sdb: 1 GiB, 1073741824 bytes, 2097152 sectors
Units: sectors of 1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 512 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 512 bytes
Sector size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;logical/physical&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes
I/O size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;minimum/optimal&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes


Disk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors
Units: sectors of 1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 512 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 512 bytes
Sector size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;logical/physical&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes
I/O size &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;minimum/optimal&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 512 bytes / 512 bytes
Disklabel &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: dos
Disk identifier: 0xc3e76474

Device     Boot    Start      End  Sectors  Size Id Type
/dev/sda1  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;        2048 39942143 39940096   19G 83 Linux
/dev/sda2       39944190 41940991  1996802  975M  5 Extended
/dev/sda5       39944192 41940991  1996800  975M 82 Linux swap / Solaris
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;两块硬盘sda和sdb&lt;/p&gt;

&lt;p&gt;sda有3个分区:sda1、sda2、sda5&lt;/p&gt;

&lt;h2 id=&quot;fdisk-devsdb-创建分区&quot;&gt;fdisk /dev/sdb 创建分区&lt;/h2&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# fdisk /dev/sdb

Welcome to fdisk &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;util-linux 2.27.1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Changes will remain &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;memory only, &lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table.
Created a new DOS disklabel with disk identifier 0x4c2b7edc.

Command &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;m &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: m

Help:

  DOS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;MBR&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   a   toggle a bootable flag
   b   edit nested BSD disklabel
   c   toggle the dos compatibility flag

  Generic
   d   delete a partition
   F   list free unpartitioned space
   l   list known partition types
   n   add a new partition
   p   print the partition table
   t   change a partition &lt;span class=&quot;nb&quot;&gt;type
   &lt;/span&gt;v   verify the partition table
   i   print information about a partition

  Misc
   m   print this menu
   u   change display/entry units
   x   extra functionality &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;experts only&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  Script
   I   load disk layout from sfdisk script file
   O   dump disk layout to sfdisk script file

  Save &amp;amp; Exit
   w   write table to disk and &lt;span class=&quot;nb&quot;&gt;exit
   &lt;/span&gt;q   quit without saving changes

  Create a new label
   g   create a new empty GPT partition table
   G   create a new empty SGI &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;IRIX&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;a   toggle a bootable flag：设置启动分区，如果一个pc装了双系统，可以用于不同系统的启动分区&lt;/li&gt;
  &lt;li&gt;d   delete a partition：删除一个分区&lt;/li&gt;
  &lt;li&gt;n   add a new partition:创建一个分区&lt;/li&gt;
  &lt;li&gt;p   print the partition table:打印分区表&lt;/li&gt;
  &lt;li&gt;q   quit without saving changes:退出不保存（比如只是想简单演示一下分区的操作，演示完了后退出）&lt;/li&gt;
  &lt;li&gt;w   write table to disk and exit：保存退出&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;格式化分区&quot;&gt;格式化分区&lt;/h2&gt;

&lt;p&gt;不同Linux文件系统的格式化命令不同&lt;/p&gt;

&lt;p&gt;mkfs          mkfs.bfs      mkfs.cramfs   mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  mkfs.fat      mkfs.minix    mkfs.msdos    mkfs.ntfs     mkfs.vfat&lt;/p&gt;

&lt;p&gt;mkfs类似mkdir，mkfs是给一个分区构建文件系统，因为创建的分区如果不格式化（给分区构造文件系统），那么操作系统不知道分区的文件系统类型。没法存储数据。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# mkfs.ext4 /dev/sdb1
mke2fs 1.42.13 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17-May-2015&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Creating filesystem with 204800 1k blocks and 51200 inodes
Filesystem UUID: 0421a14b-ccab-4f7e-a2f0-2b5535af0db6
Superblock backups stored on blocks: 
        8193, 24577, 40961, 57345, 73729

Allocating group tables: &lt;span class=&quot;k&quot;&gt;done                            
&lt;/span&gt;Writing inode tables: &lt;span class=&quot;k&quot;&gt;done                            
&lt;/span&gt;Creating journal &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096 blocks&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: &lt;span class=&quot;k&quot;&gt;done
&lt;/span&gt;Writing superblocks and filesystem accounting information: &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;创建一个挂载点目录用于挂载&quot;&gt;创建一个挂载点（目录）用于挂载&lt;/h2&gt;

&lt;p&gt;创建一个目录&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# mkdir xxx
root@ubuntu:~# ls
xxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;将分区挂载到目录上&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# mount /dev/sdb1 xxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;开机自动挂载&quot;&gt;开机自动挂载&lt;/h2&gt;

&lt;p&gt;为什么需要开机自动挂载？&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;开机自动挂载主要用于服务器上，比如服务器上有四个硬盘插口，放入四个硬盘，如果有硬盘坏了，需要拆下来维修，维修之后，再把硬盘放回去，这时候服务器就需要开机自动挂载，不可能再手动挂载，影响效率。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;修改/etc/fstab文件。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# &amp;lt;file system&amp;gt; &amp;lt;mount point&amp;gt;   &amp;lt;type&amp;gt;  &amp;lt;options&amp;gt;       &amp;lt;dump&amp;gt;  &amp;lt;pass&amp;gt;
# / was on /dev/sda1 during installation
UUID=54e1f692-8968-4f12-bebd-58027d4f436a /               ext4    errors=remount-ro 0       1
# swap was on /dev/sda5 during installation
UUID=ddfc0e54-edd1-4474-9836-e6dd94b59ecc none            swap    sw              0       0
/dev/fd0        /media/floppy0  auto    rw,user,noauto,exec,utf8 0       0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;分区	挂载点(mount point)	文件系统类型(type)	选项(option)	备份(dump)  检测(pass)&lt;/p&gt;

&lt;p&gt;dump:0不备份，1备份&lt;/p&gt;

&lt;p&gt;pass:0不检查，1检查&lt;/p&gt;

&lt;p&gt;在/etc/fstab文件中新增配置信息即可。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/dev/sdb1 /root/xxx ext4	default	0	0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;uuid方式设置开机自动挂载&quot;&gt;uuid方式设置开机自动挂载&lt;/h2&gt;

&lt;p&gt;为什么需要通过uuid方式设置开机自动挂载？&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;服务器上有四个硬盘插口，放入四个硬盘，硬盘坏了，拆下来维修之后，再把硬盘放回去，这时候服务器就需要开机自动挂载，但是四个硬盘摆放的位置能和之前的位置一样吗？会不会放的位置不一致？原来/dev/sda对应的是第一块硬盘，现在/dev/sda对应的可能是第二块硬盘，这样，数据就会乱套，所以不能用设备名，而是要用设备uuid来配置。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;查看分区的uuid&quot;&gt;查看分区的uuid&lt;/h2&gt;

&lt;p&gt;blkid命令：print block devices attribute。打印块设备属性，包括uuid&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@ubuntu:~# blkid
/dev/sda1: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;54e1f692-8968-4f12-bebd-58027d4f436a&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c3e76474-01&quot;&lt;/span&gt;
/dev/sda5: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ddfc0e54-edd1-4474-9836-e6dd94b59ecc&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;swap&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c3e76474-05&quot;&lt;/span&gt;
/dev/sdb1: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0421a14b-ccab-4f7e-a2f0-2b5535af0db6&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;def93928-01&quot;&lt;/span&gt;
/dev/sdb2: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;a7897ecf-2436-4051-ac64-950a8868a42f&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;def93928-02&quot;&lt;/span&gt;
/dev/sdb5: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;747b538d-7e4d-4e31-9454-d3b1fb7610a5&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;def93928-05&quot;&lt;/span&gt;
/dev/sdb6: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;187d93cd-3231-4653-84d6-9fefdffb7d44&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;def93928-06&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;通过uuid配置开机自动挂载&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0421a14b-ccab-4f7e-a2f0-2b5535af0db6 /root/xxx ext4	default	0	0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;卸载&quot;&gt;卸载&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;umount /dev/sdb1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;重新挂载fstab配置中的所有文件系统&quot;&gt;重新挂载fstab配置中的所有文件系统&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mount -a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 26 Mar 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/03/linux%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/03/linux%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA/</guid>
        
        
      </item>
    
      <item>
        <title>Redis基本用法</title>
        <description>&lt;p&gt;[toc]&lt;/p&gt;

&lt;h1 id=&quot;redis介绍&quot;&gt;Redis介绍&lt;/h1&gt;

&lt;p&gt;redis属于nosql数据库，默认有16个数据库，编号从0~15；
数据使用key-value键值对方式存储在内存中，读写速度非常快，多用于高并发和高性能。数据还能持久化；
属于单线程数据库，内部采用IO多路复用机制。
Redis本质上只有一种数据结构，就是K-V键值对，但通过value衍生出5种数据结构。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;string
list
set
zset
hash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis安装&quot;&gt;Redis安装&lt;/h1&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://download.redis.io/releases/redis-5.0.7.tar.gz
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-zvxf&lt;/span&gt; redis-5.0.7.tar.gz
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;redis-5.0.7 redis
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;redis

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make &lt;span class=&quot;nt&quot;&gt;-j4&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make &lt;span class=&quot;nv&quot;&gt;PREFIX&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/redis &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;export PATH=/usr/local/redis:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; ~/.bashrc
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;redis其他版本可在官网下载，&lt;a href=&quot;https://redis.io/&quot;&gt;redis官网&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;redis服务端启动和关闭&quot;&gt;Redis服务端启动和关闭&lt;/h1&gt;

&lt;h2 id=&quot;1-redis服务启动&quot;&gt;1) Redis服务启动&lt;/h2&gt;

&lt;p&gt;Redis服务程序: &lt;strong&gt;redis-server&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;默认启动&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;默认方式使用的端口号是：&lt;strong&gt;6379&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nohup &lt;/span&gt;redis-server &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;配置文件启动&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nohup &lt;/span&gt;redis-server redis.conf &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;​	配置文件redis.conf中可以更改端口号&lt;/p&gt;

&lt;h2 id=&quot;2-redis服务关闭&quot;&gt;2) Redis服务关闭&lt;/h2&gt;

&lt;p&gt;有两种方式关闭redis服务&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;在服务器上关闭redis服务&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;redis
zhoukang  26681      1  0 Mar18 ?        00:01:42 redis-server &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:6379
zhoukang  41957  40666  0 18:42 pts/0    00:00:00 &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;auto redis
&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-9&lt;/span&gt; 26681
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;通过客户端来关闭redis服务&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli
127.0.0.1:6379&amp;gt; shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果服务器是默认启动的，那么服务器没有配置日志文件，在客户端是不允许shutdown，会报错&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli
127.0.0.1:6379&amp;gt; shutdown
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ERR Errors trying to SHUTDOWN. Check logs.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis客户端启动和关闭&quot;&gt;Redis客户端启动和关闭&lt;/h1&gt;

&lt;p&gt;Redis客户端程序: &lt;strong&gt;redis-cli&lt;/strong&gt;
还可以在自己的程序中连接redis数据库，此时自己的程序就是客户端&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;
redis-cli 5.0.7

Usage: redis-cli &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;OPTIONS] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;cmd &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;arg &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;arg ...]]]
  &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; &amp;lt;&lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;      Server &lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default: 127.0.0.1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &amp;lt;port&amp;gt;          Server port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default: 6379&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &amp;lt;password&amp;gt;      Password to use when connecting to the server.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;redis-cli有很多选项，常用的是上面3个选项&lt;/p&gt;

&lt;h2 id=&quot;1-本地连接redis服务&quot;&gt;1) 本地连接redis服务&lt;/h2&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli
127.0.0.1:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;默认连的是127.0.0.1:6379&lt;/p&gt;

&lt;h2 id=&quot;2-远程连接redis服务&quot;&gt;2) 远程连接redis服务&lt;/h2&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.221 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6379
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;远程连接redis服务，-h指定host ip，-p指定端口port，-a指定redis密码，author。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-cli &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.221 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6379
Could not connect to Redis at 10.10.10.221:6379: Connection refused
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这是因为：
	服务端设置了bind属性，只有bind指定的ip才能访问，可以注释bind，或者指定ip，一般服务端会设置指定ip；
	服务端设置了protected-mode属性为yes，需要设置为no，不采用保护模式。
	然后重启redis服务，即可远程连接。&lt;/p&gt;

&lt;h2 id=&quot;3-redis客户端关闭&quot;&gt;3) redis客户端关闭&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;通过exit命令退出&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;通过quit命令退出&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; quit
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis客户端帮助手册&quot;&gt;Redis客户端帮助手册&lt;/h1&gt;

&lt;h2 id=&quot;help&quot;&gt;help&lt;/h2&gt;

&lt;p&gt;帮助手册，查看redis常见命令及用法&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help
&lt;/span&gt;redis-cli 4.0.14
To get &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;about Redis commands &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:
      &lt;span class=&quot;s2&quot;&gt;&quot;help @&amp;lt;group&amp;gt;&quot;&lt;/span&gt; to get a list of commands &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &amp;lt;group&amp;gt;
      &lt;span class=&quot;s2&quot;&gt;&quot;help &amp;lt;command&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;on &amp;lt;&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&quot;help &amp;lt;tab&amp;gt;&quot;&lt;/span&gt; to get a list of possible &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;topics
      &lt;span class=&quot;s2&quot;&gt;&quot;quit&quot;&lt;/span&gt; to &lt;span class=&quot;nb&quot;&gt;exit

&lt;/span&gt;To &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;redis-cli preferences:
      &lt;span class=&quot;s2&quot;&gt;&quot;:set hints&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;online hints
      &lt;span class=&quot;s2&quot;&gt;&quot;:set nohints&quot;&lt;/span&gt; disable online hints
Set your preferences &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; ~/.redisclirc
10.10.10.221:6379&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;“help @&lt;group&gt;&quot;&lt;/group&gt;&lt;/p&gt;

    &lt;p&gt;​		 用于获取一个组里面的所有命令。一般是输入”help @”，然后按tab键，会自动提示组&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;“help &lt;tab&gt;&quot;&lt;/tab&gt;&lt;/p&gt;

    &lt;p&gt;​		用于获取相关主体的所有命令。一般是输入”help “，然后按tab键，会自动提示相关主体&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;“help &lt;command /&gt;”&lt;/p&gt;

    &lt;p&gt;​		用于获取指令命令的帮助&lt;/p&gt;

    &lt;p&gt;具体用法：”help @&lt;group&gt;&quot;&lt;/group&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @generic
  
  DEL key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Delete a key
  since: 1.0.0
  
  DUMP key
  summary: Return a serialized version of the value stored at the specified key.
  since: 2.6.0
  
  EXISTS key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Determine &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;a key exists
  since: 1.0.0
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;此时输出：
		generic组的所有命令
		命令的作用
		命令的版本&lt;/p&gt;

    &lt;p&gt;具体用法：”help &lt;command /&gt;”&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;：10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help set
  
  &lt;/span&gt;SET key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;EX seconds] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;PX milliseconds] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NX|XX]
  summary: Set the string value of a key
  since: 1.0.0
  group: string
  
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;此时输出：
	key的语法
	key的作用
	key的版本
	key所在组&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;技巧：&lt;/strong&gt;
		一个命令的关联命令有哪些？先查看命令在哪个组，然后查看组内有哪些命令。以ping命令为例。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;ping

  PING &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;message]
  summary: Ping the server
  since: 1.0.0
  group: connection

10.10.10.221:6379&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @connection

  AUTH password
  summary: Authenticate to the server
  since: 1.0.0

  ECHO message
  summary: Echo the given string
  since: 1.0.0

  PING &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;message]
  summary: Ping the server
  since: 1.0.0

  QUIT -
  summary: Close the connection
  since: 1.0.0

  SELECT index
  summary: Change the selected database &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the current connection
  since: 1.0.0

10.10.10.221:6379&amp;gt;		
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis客户端常用命令&quot;&gt;Redis客户端常用命令&lt;/h1&gt;

&lt;p&gt;鉴于redis的帮助手册可以查看所有命令，故这里只列出常用命令。&lt;/p&gt;

&lt;h2 id=&quot;1-server组常见命令&quot;&gt;1) server组常见命令&lt;/h2&gt;

&lt;p&gt;server组的全部命令，可以通过help @server来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;config-get&quot;&gt;config get&lt;/h3&gt;

&lt;p&gt;查看服务器启动时配置文件(redis.conf)中的参数&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;config get

  CONFIG GET parameter
  summary: Get the value of a configuration parameter
  since: 2.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;查看所有的配置参数&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; config get &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;查看单个配置参数&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; config get port
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;port&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;6379&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;dbsize&quot;&gt;dbsize&lt;/h3&gt;

&lt;p&gt;查看当前数据库的keys的数量&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;dbsize

  DBSIZE -
  summary: Return the number of keys &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the selected database
  since: 1.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; dbsize
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
OK
10.10.10.221:6379&amp;gt; dbsize
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在空的数据库中添加了一条数据，keys数量变为1&lt;/p&gt;

&lt;h3 id=&quot;flushdb&quot;&gt;flushdb&lt;/h3&gt;

&lt;p&gt;删除当前数据库的所有key&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;flushdb

  FLUSHDB -
  summary: Remove all keys from the current database
  since: 1.0.0
  group: server

10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; dbsize
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; flushdb
OK
10.10.10.221:6379&amp;gt; dbsize
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;数据库中有一条数据，删除当前数据看中所有key后，数据库为空&lt;/p&gt;

&lt;h3 id=&quot;flushall&quot;&gt;flushall&lt;/h3&gt;

&lt;p&gt;删除所有数据库中的所有key&lt;/p&gt;

&lt;h3 id=&quot;info&quot;&gt;info&lt;/h3&gt;

&lt;p&gt;查看redis服务的统计信息&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;info

  INFO &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;section]
  summary: Get information and statistics about the server
  since: 1.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;不加section，查看所有信息，加section之后，查看指定section的信息，这里查看section为clients的统计信息。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; info clients
&lt;span class=&quot;c&quot;&gt;# Clients&lt;/span&gt;
connected_clients:1
client_recent_max_input_buffer:2
client_recent_max_output_buffer:0
blocked_clients:0
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在redis集群中，查看主从复制&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:master
connected_slaves:2
slave0:ip&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10.10.221,port&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6380,state&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;online,offset&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1806,lag&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
slave1:ip&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10.10.221,port&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6381,state&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;online,offset&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1806,lag&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:1820
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:1820
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;可以看到当前redis服务(10.10.10.221:6379)是主机(role:master)，有两台从机(connected_slaves:2)&lt;/p&gt;

&lt;h3 id=&quot;shutdown&quot;&gt;shutdown&lt;/h3&gt;

&lt;p&gt;保存数据库数据到磁盘上，然后关闭redis服务。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;shutdown

  SHUTDOWN &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NOSAVE|SAVE]
  summary: Synchronously save the dataset to disk and &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;shut down the server
  since: 1.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-generic组常见命令&quot;&gt;2) generic组常见命令&lt;/h2&gt;

&lt;p&gt;generic组的全部命令，可以通过help @generic来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;del&quot;&gt;del&lt;/h3&gt;

&lt;p&gt;删除key，可以同时删除多个key，返回删除key的个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;del

  DEL key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Delete a key
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k2 v2
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k3 v3
OK
10.10.10.221:6379&amp;gt; del k1 k2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;exists&quot;&gt;exists&lt;/h3&gt;

&lt;p&gt;判断key是否存在，可以同时判断多个key是否存在，返回存在key的个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;exists

  EXISTS key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Determine &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;a key exists
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k2 v2
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k3 v3
OK
10.10.10.221:6379&amp;gt; exists k1 k2 k3 k4
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;keys&quot;&gt;keys&lt;/h3&gt;

&lt;p&gt;查看所有匹配上pattern的所有key. (通配符的方式匹配，而不是正则匹配)&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;keys

  KEYS pattern
  summary: Find all keys matching the given pattern
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;查看所有key&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;查看匹配的key&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; keys hel&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; keys ??llo&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;通配符和正则表达式的区别&quot;&gt;通配符和正则表达式的区别&lt;/h3&gt;

&lt;p&gt;应用场景的区分：
	&lt;strong&gt;通配符&lt;/strong&gt;多用于文件搜索
	&lt;strong&gt;正则表达式&lt;/strong&gt;多用于字符子串的查找
语法区分：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt; &lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;通配符&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;正则&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;*&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0个或多个任意字符&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;0个或多个&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;?&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1个任意字符&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;1个&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;正则中的任意字符，用”.”表示。
正则中的”.*“，相当于通配符中的”*“。
正则中的”.?”，相当于通配符中的”?”。&lt;/p&gt;

&lt;h3 id=&quot;move&quot;&gt;move&lt;/h3&gt;

&lt;p&gt;把当前数据库的key移动到其他数据库中&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;move

  MOVE key db
  summary: Move a key to another database
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;把当前数据库（0号数据库）中的key移动到1号数据库&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; move hello 1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; &lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;1
OK
10.10.10.221:6379[1]&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
10.10.10.221:6379[1]&amp;gt; &lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;0
OK
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ttl&quot;&gt;ttl&lt;/h3&gt;

&lt;p&gt;time to live。查看指定key的剩余生存时间。key的生存时间到期后，会自动销毁。
应用场景：
		redis是基于内存的数据库，数据是放在内存中的，如果某个数据在内存中只使用一次之后就不再使用了，那么这个数据会一直占用内存，消耗内存，所以不需要的时候，需要删除这个数据。
		如果通过del命令来删除，还需要连数据库；可以通过ttl的方式来自动删除这个数据。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;ttl

  TTL key
  summary: Get the &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;to live &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a key
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; ttl username
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-2&lt;/span&gt;
10.10.10.221:6379&amp;gt; ttl hello1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;返回值：&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(integer) -2	: 指定的key不存在
(integer) -1	: key永不过期
(integer) n		: 返回剩余的有效期为n秒
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;expire&quot;&gt;expire&lt;/h3&gt;

&lt;p&gt;设置key的存活时间，单位为秒。从设置之后开始计时。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;expire

  EXPIRE key seconds
  summary: Set a key&lt;span class=&quot;s1&quot;&gt;'s time to live in seconds
  since: 1.0.0
  group: generic
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：设置”hello1”的有效期为20s，在20s内，”hello1”一直有效，可以通过ttl查看”hello1”的剩余有效期，20s之后，删除”hello1”。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello1&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; ttl hello1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
10.10.10.221:6379&amp;gt; expire hello1 20
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; ttl hello1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 15
10.10.10.221:6379&amp;gt; ttl hello1
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-2&lt;/span&gt;
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;type&quot;&gt;type&lt;/h3&gt;

&lt;p&gt;查看指定key的数据类型。
应用场景：比如想在指定key上添加数据，需要先查看指定key是哪一种数据类型（redis的key有5种数据类型），然后按照查询到的数据类型添加数据。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help type

  &lt;/span&gt;TYPE key
  summary: Determine the &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;stored at key
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;myhello&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;myhello
string
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rename&quot;&gt;rename&lt;/h3&gt;

&lt;p&gt;重命名key&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;rename

  RENAME key newkey
  summary: Rename a key
  since: 1.0.0
  group: generic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;redis五种数据结构&quot;&gt;redis五种数据结构&lt;/h2&gt;

&lt;h2 id=&quot;3-string组常见命令&quot;&gt;3) string组常见命令&lt;/h2&gt;

&lt;p&gt;string: redis的数据结构
string能存储任何类型的数据，包括二进制数据、序列化后的数据、Json化的对象、甚至图片，最大512M。
特点：单key，单value&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;username&lt;/td&gt;
      &lt;td&gt;zhangsan&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;string组的全部命令，可以通过help @string来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;set&quot;&gt;set&lt;/h3&gt;

&lt;p&gt;设置字符串的key-value键值对。
key是程序员自己取的名字，&lt;strong&gt;value是业务数据。&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help set

  &lt;/span&gt;SET key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;EX seconds] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;PX milliseconds] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NX|XX]
  summary: Set the string value of a key
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;类似于c/c++中&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zsname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zsage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;redis&lt;/th&gt;
      &lt;th&gt;c/c++&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;key&lt;/td&gt;
      &lt;td&gt;变量名(类似zsname[20])&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;value&lt;/td&gt;
      &lt;td&gt;变量值(类似”zhangsan”)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;redis均采用字符串&lt;/td&gt;
      &lt;td&gt;变量的数据类型(类似char)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;get&quot;&gt;get&lt;/h3&gt;

&lt;p&gt;获取key对应的value&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;get

  GET key
  summary: Get the value of a key
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;append&quot;&gt;append&lt;/h3&gt;

&lt;p&gt;向指定的key对应的value追加字符串，返回追加之后，总的字符长度。如果key不存在，相当于创建key&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;append

  APPEND key value
  summary: Append a value to a key
  since: 2.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;phone 1338888
OK
10.10.10.221:6379&amp;gt; get phone 
&lt;span class=&quot;s2&quot;&gt;&quot;1338888&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; append phone 9999
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 11
10.10.10.221:6379&amp;gt; get phone
&lt;span class=&quot;s2&quot;&gt;&quot;13388889999&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;strlen&quot;&gt;strlen&lt;/h3&gt;

&lt;p&gt;获取字符串的长度&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;strlen

  STRLEN key
  summary: Get the length of the value stored &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a key
  since: 2.2.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; get phone
&lt;span class=&quot;s2&quot;&gt;&quot;13388889999&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; strlen phone
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 11
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;incr&quot;&gt;incr&lt;/h3&gt;

&lt;p&gt;key对应的value的值加1，返回+1之后的值。如果key不存在，则设置key的值为0，然后+1，得到1。
只能操作整形的value，非整形的value会操作失败；&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;incr

  INCR key
  summary: Increment the integer value of a key by one
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;age 20
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;name zhangsan
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;score 85.7
OK
10.10.10.221:6379&amp;gt; INCR age
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 21
10.10.10.221:6379&amp;gt; get age
&lt;span class=&quot;s2&quot;&gt;&quot;21&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; INCR name
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ERR value is not an integer or out of range
10.10.10.221:6379&amp;gt; INCR score
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ERR value is not an integer or out of range
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;decr&quot;&gt;decr&lt;/h3&gt;

&lt;p&gt;key对应的value的值减1，返回-1之后的值。如果key不存在，则设置key的值为0，然后-1，得到-1。
只能操作整形的value，非整形的value会操作失败；&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;decr

  DECR key
  summary: Decrement the integer value of a key by one
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;incrby&quot;&gt;incrby&lt;/h3&gt;

&lt;p&gt;key对应的value增加一个偏移量&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;incrby

  INCRBY key increment
  summary: Increment the integer value of a key by the given amount
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; get age
&lt;span class=&quot;s2&quot;&gt;&quot;20&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; INCRBY age 10
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 30
10.10.10.221:6379&amp;gt; INCRBY age &lt;span class=&quot;nt&quot;&gt;-10&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 20
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;decrby&quot;&gt;decrby&lt;/h3&gt;

&lt;p&gt;key对应的value减少一个偏移量&lt;/p&gt;

&lt;h3 id=&quot;getrange&quot;&gt;getrange&lt;/h3&gt;

&lt;p&gt;获取key对应字符串value的子串。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;getrange

  GETRANGE key start end
  summary: Get a substring of the string stored at a key
  since: 2.4.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  start：指定起始索引
  end：指定结束索引
  区间: [start, end]
  索引可以是负数
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; get name
&lt;span class=&quot;s2&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; getrange name 2 5
&lt;span class=&quot;s2&quot;&gt;&quot;angs&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;setrange&quot;&gt;setrange&lt;/h3&gt;

&lt;p&gt;把下标offset之后n个字符替换为新的子串，n为新子串的长度&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;setrange

  SETRANGE key offset value
  summary: Overwrite part of a string at key starting at the specified offset
  since: 2.2.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; get name
&lt;span class=&quot;s2&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; setrange name 4 liu
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 8
10.10.10.221:6379&amp;gt; get name
&lt;span class=&quot;s2&quot;&gt;&quot;zhanliun&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;setex&quot;&gt;setex&lt;/h3&gt;

&lt;p&gt;设置值的同时，设置有效期&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;setex

  SETEX key seconds value
  summary: Set the value and expiration of a key
  since: 2.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; setex k2 10 v2
OK
10.10.10.221:6379&amp;gt; ttl k2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 8
10.10.10.221:6379&amp;gt; ttl k2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;和expire的区别&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setex是原子操作，设置值的同时，设置有效期。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;setnx&quot;&gt;setnx&lt;/h3&gt;

&lt;p&gt;set not exist。当key不存在的时候，才设置&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;setnx

  SETNX key value
  summary: Set the value of a key, only &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the key does not exist
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;和set的区别&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set比较暴力，会直接覆盖原来的值
setnx会判断key是否存在，如果不存在，才设置，否则，放弃设置
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mset&quot;&gt;mset&lt;/h3&gt;

&lt;p&gt;批量设置键值对&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;mset

  MSET key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key value ...]
  summary: Set multiple keys to multiple values
  since: 1.0.1
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; mset k1 v1 k2 v2 k3 v3
OK
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k2&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mget&quot;&gt;mget&lt;/h3&gt;

&lt;p&gt;批量获取给定一组key的一组value&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;mget

  MGET key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Get the values of all the given keys
  since: 1.0.0
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k2&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; mget k1 k2 k3 k4
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nil&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;msetnx&quot;&gt;msetnx&lt;/h3&gt;

&lt;p&gt;批量设置键值对。当所有key都不存在时，才能设置成功，否则，只要有一个key存在，则放弃设置。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;msetnx

  MSETNX key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key value ...]
  summary: Set multiple keys to multiple values, only &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;none of the keys exist
  since: 1.0.1
  group: string
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;4-list组常见命令&quot;&gt;4) list组常见命令&lt;/h2&gt;

&lt;p&gt;list: redis的基本数据结构。
list是最简单的字符串列表，默认按照&lt;strong&gt;插入先后顺序排序&lt;/strong&gt;，还可以添加一个元素到列表的头部、尾部、中间，底层是个链表结构。列表是有序的，可以通过下标索引来操作list中的数据。
特点：单key，多value
&lt;strong&gt;顺序：按插入位置排序&lt;/strong&gt;
&lt;strong&gt;表头：在列表的左侧left&lt;/strong&gt;
&lt;strong&gt;表尾：在列表的右侧right&lt;/strong&gt;、&lt;/p&gt;

&lt;p&gt;实例，尾部依次插入beijing、shanghai、tianjin、chongqing，此时按照插入顺序排序。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;city&lt;/td&gt;
      &lt;td&gt;beijing  shanghai   tianjin   chongqing&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;list组的全部命令，可以通过help @list来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;lpush&quot;&gt;lpush&lt;/h3&gt;

&lt;p&gt;lpush -&amp;gt; left push。将一个或多个值依次插入到list的表头或左侧。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;lpush

  LPUSH key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;value ...]
  summary: Prepend one or multiple values to a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
10.10.10.221:6379&amp;gt; lpush listk v1 v2 v3 v4
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在listk列表的表头(左侧)依次插入v1、v2、v3、v4，现在表头的第一个数据就是v4&lt;/p&gt;

&lt;h3 id=&quot;lrange&quot;&gt;lrange&lt;/h3&gt;

&lt;p&gt;lrange -&amp;gt; list range。获取指定列表中的元素。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;lrange

  LRANGE key start stop
  summary: Get a range of elements from a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; lpush listk v1 v2 v3 v4
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4
10.10.10.221:6379&amp;gt; lrange listk 0 2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v4&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; lpush listk v5 v6 v7
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 7
10.10.10.221:6379&amp;gt; lrange listk 0 2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v7&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v6&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v5&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; LRANGE listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v7&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v6&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v4&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;第一次在列表listk中lpush依次插入v1 v2 v3 v4时，v4是表头，是第一个数据；
第二次在列表listk中lpush依次插入v5 v6 v7时，v7是表头，是第一个数据；&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lrange key start stop
start:列表的开始下标索引
stop:列表的结束下标索引
区间: [start, stop]
支持下标索引为负
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rpush&quot;&gt;rpush&lt;/h3&gt;

&lt;p&gt;rpush -&amp;gt; right push。将一个或多个值依次插入到list的表尾或右侧。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;rpush

  RPUSH key value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;value ...]
  summary: Append one or multiple values to a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; rpush listk v8 v9
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 9
10.10.10.221:6379&amp;gt; lrange listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v7&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v6&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v4&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v8&quot;&lt;/span&gt;
9&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v9&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;lpop&quot;&gt;lpop&lt;/h3&gt;

&lt;p&gt;从list表头删除一个元素，并返回删除的元素&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;lpop

  LPOP key
  summary: Remove and get the first element &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rpop&quot;&gt;rpop&lt;/h3&gt;

&lt;p&gt;从list表尾删除一个元素，并返回删除的元素&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;rpop

  RPOP key
  summary: Remove and get the last element &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;lindex&quot;&gt;lindex&lt;/h3&gt;

&lt;p&gt;获取list列表指定下标的元素&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;lindex

  LINDEX key index
  summary: Get an element from a list by its index
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; lrange listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v7&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v6&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v4&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v8&quot;&lt;/span&gt;
9&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v9&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; lindex listk 4
&lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;llen&quot;&gt;llen&lt;/h3&gt;

&lt;p&gt;llen -&amp;gt; list length。获取list列表的长度&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;llen

  LLEN key
  summary: Get the length of a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; llen listk
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 9
10.10.10.221:6379&amp;gt; lrange listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v7&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v6&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v4&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v8&quot;&lt;/span&gt;
9&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v9&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;lrem&quot;&gt;lrem&lt;/h3&gt;

&lt;p&gt;从list列表中删除元素&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;lrem

  LREM key count value
  summary: Remove elements from a list
  since: 1.0.0
  group: list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lrem key count value
count &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 0: 从表头向表尾开始，删除count个值与value相等的元素
count &amp;lt; 0: 从表尾向表头开始，删除|count|个值与value相等的元素
count &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0: 删除所有值与value相等的元素
count的正负号，决定了删除的方向，count的绝对值，决定了删除的个数
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; lrange listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
 4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
 6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
 7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
 9&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
11&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
12&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; lrem listk &lt;span class=&quot;nt&quot;&gt;-2&lt;/span&gt; v2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2
10.10.10.221:6379&amp;gt; lrange listk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
 4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
 6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
 7&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
 8&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
 9&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;5-set组常见命令&quot;&gt;5) set组常见命令&lt;/h2&gt;

&lt;p&gt;set: redis的基本数据结构。
set是字符串集合，是无序的、无重复的集合，与插入先后顺序无关。
&lt;strong&gt;顺序：无序&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;set组的全部命令，可以通过help @set来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sadd&quot;&gt;sadd&lt;/h3&gt;

&lt;p&gt;添加一个或多个元素到指定set集合中&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;sadd

  SADD key member &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;member ...]
  summary: Add one or more members to a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; sadd setk s1 s2 s3 s4
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4
10.10.10.221:6379&amp;gt; scard setk
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4
10.10.10.221:6379&amp;gt; smembers setk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;scard&quot;&gt;scard&lt;/h3&gt;

&lt;p&gt;获取set集合的元素个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;scard

  SCARD key
  summary: Get the number of members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;smembers&quot;&gt;smembers&lt;/h3&gt;

&lt;p&gt;查看set集合中的所有元素&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;smembers

  SMEMBERS key
  summary: Get all the members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;srem&quot;&gt;srem&lt;/h3&gt;

&lt;p&gt;删除set集合中的多个元素，返回成功删除的个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;srem

  SREM key member &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;member ...]
  summary: Remove one or more members from a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;srandmember&quot;&gt;srandmember&lt;/h3&gt;

&lt;p&gt;随机返回set集合中的count个元素。
count &amp;gt; 0:返回count个不相同的元素，类似不放回抽样
count &amp;lt;0: 返回count个元素，类似放回抽样，所以，可能存在重复的元素。
应用：比如抽奖活动。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;srandmember

  SRANDMEMBER key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;count]
  summary: Get one or multiple random members from a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;spop&quot;&gt;spop&lt;/h3&gt;

&lt;p&gt;从set集合中随机删除一个或多个元素，并返回删除的元素。
应用：抽奖活动，每人最多抽一次。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;spop

  SPOP key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;count]
  summary: Remove and &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;one or multiple random members from a &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;spop和srem区别
srem是按照value来删除member
spop是随机删除member
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; smembers setk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; spop setk 2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sinter&quot;&gt;sinter&lt;/h3&gt;

&lt;p&gt;获取多个set集合的交集。$set1 \cap set2 \cap set3 \cap …$&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;sinter

  SINTER key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Intersect multiple sets
  since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; smembers setk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set1
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; sinter setk set1 set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sunion&quot;&gt;sunion&lt;/h3&gt;

&lt;p&gt;获取多个set集合的并集。$ set1 \cup set2 \cup set3 \cup …$&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;sunion

  SUNION key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Add multiple sets
  since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; smembers setk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set1
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; sunion setk set1 set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;sdiff&quot;&gt;sdiff&lt;/h3&gt;

&lt;p&gt;第一个set集合减去其他集合的结果，差集。$set1 - set2 -set3 - … = set1 - (set2 \cup set3 \cup …)$&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;sdiff

  SDIFF key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Subtract multiple sets
  since: 1.0.0
  group: &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; smembers setk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set1
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s2&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; smembers set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s5&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s4&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s3&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; sdiff setk set1 set2
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s6&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;hash组常见命令&quot;&gt;hash组常见命令&lt;/h2&gt;

&lt;p&gt;hash: redis的基本数据结构
hash是一个字符串类型的filed和value的映射表，特别适合存储struct结构体对象。
key field1 value1 field2 value2 ….&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;field:value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;person&lt;/td&gt;
      &lt;td&gt;name:zhangsan age:20 sex:girl  height:170&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;类似于c/c++结构体&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;20&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;girl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;height&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;hash组的全部命令，可以通过help @hash来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @hash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hset&quot;&gt;hset&lt;/h3&gt;

&lt;p&gt;设置hash表的field和value&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hset

  HSET key field value
  summary: Set the string value of a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; hset hashk f1 v1 f2 v2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hget&quot;&gt;hget&lt;/h3&gt;

&lt;p&gt;获取hash表中指定field的value&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hget

  HGET key field
  summary: Get the value of a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hmset&quot;&gt;hmset&lt;/h3&gt;

&lt;p&gt;批量设置hash表的多组filed和value。实际上hset也可以批量设置，两者没有区别。&lt;strong&gt;官方给出：hmset被弃用。&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hmset

  HMSET key field value &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;field value ...]
  summary: Set multiple &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;fields to multiple values
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hmget&quot;&gt;hmget&lt;/h3&gt;

&lt;p&gt;批量获取hash表中多个field的多个value。hget一次只能获取一个value。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hmget

  HMGET key field &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;field ...]
  summary: Get the values of all the given &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;fields
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hgetall&quot;&gt;hgetall&lt;/h3&gt;

&lt;p&gt;获取hash表中所有的fields和values&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hgetall

  HGETALL key
  summary: Get all the fields and values &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;hash
  &lt;/span&gt;since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; hgetall hashk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;f1&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;f2&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v2&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;f3&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;v3&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hdel&quot;&gt;hdel&lt;/h3&gt;

&lt;p&gt;删除hash表的多个成对的filed和value&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hdel

  HDEL key field &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;field ...]
  summary: Delete one or more &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;fields
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hlen&quot;&gt;hlen&lt;/h3&gt;

&lt;p&gt;获取hash表中filed的个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hlen

  HLEN key
  summary: Get the number of fields &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;hash
  &lt;/span&gt;since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hexists&quot;&gt;hexists&lt;/h3&gt;

&lt;p&gt;判断hash表中指定的field是否存在&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hexists

  HEXISTS key field
  summary: Determine &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field exists
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hkeys&quot;&gt;hkeys&lt;/h3&gt;

&lt;p&gt;获取hash表中所有的fields&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hkeys

  HKEYS key
  summary: Get all the fields &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;hash
  &lt;/span&gt;since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hvals&quot;&gt;hvals&lt;/h3&gt;

&lt;p&gt;获取hash表中所有的values&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hvals

  HVALS key
  summary: Get all the values &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a &lt;span class=&quot;nb&quot;&gt;hash
  &lt;/span&gt;since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hincrby&quot;&gt;hincrby&lt;/h3&gt;

&lt;p&gt;给hash表中指定field的整数value增加一个整数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hincrby

  HINCRBY key field increment
  summary: Increment the integer value of a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field by the given number
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; hset hashk age 20
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; hincrby hashk age 5
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 25
10.10.10.221:6379&amp;gt; hget hashk age
&lt;span class=&quot;s2&quot;&gt;&quot;25&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hincrbyfloat&quot;&gt;hincrbyfloat&lt;/h3&gt;

&lt;p&gt;给hash表中指定field的浮点数value增加一个浮点数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hincrbyfloat

  HINCRBYFLOAT key field increment
  summary: Increment the float value of a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field by the given amount
  since: 2.6.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; hset hashk height 1.72
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; hincrbyfloat hashk height 0.21
&lt;span class=&quot;s2&quot;&gt;&quot;1.93&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; hgetall hashk
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;age&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;25&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;height&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1.93&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;hsetnx&quot;&gt;hsetnx&lt;/h3&gt;

&lt;p&gt;给hash表添加field-value对，如果field已经存在，则添加失败。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;hsetnx

  HSETNX key field value
  summary: Set the value of a &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;field, only &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the field does not exist
  since: 2.0.0
  group: &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;sorted_set组常见命令&quot;&gt;sorted_set组常见命令&lt;/h2&gt;

&lt;p&gt;sorted_set首字母为s，(相应的操作按理说应该是s开头)，与set的s冲突，所以有了zset的名字。
zset是有序无重复的集合，介于set和list之间，zset相关的命令结合了set和list的命令。
zset的每个元素都会关联一个分数（分数可以重复），redis通过分数来为集合中的成员进行从小到大的顺序来排序。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;顺序：按照分数排序，元素可以有下标索引&lt;/strong&gt;
&lt;strong&gt;本质：是set集合，元素不能重复&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;实例：key是分数score，先后插入zhangsan 80分，lisi 75分，wangwu 90分。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;score&lt;/td&gt;
      &lt;td&gt;zhangsan 80&lt;br /&gt;lisi              75&lt;br /&gt;wangwu   90&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;插入后实际排序，按照分数从小到大来排序。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;score&lt;/td&gt;
      &lt;td&gt;lisi              75&lt;br /&gt;zhangsan 80&lt;br /&gt;wangwu   90&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;sorted_set组的全部命令，可以通过help @sorted_set来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zadd&quot;&gt;zadd&lt;/h3&gt;

&lt;p&gt;向zset集合中添加多组元素及对应的分数，如果元素存在，则更新元素的分数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zadd

  ZADD key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NX|XX] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;CH] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INCR] score member &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;score member ...]
  summary: Add one or more members to a sorted &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;, or update its score &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;it already exists
  since: 1.2.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zadd zsetk 50 zhangsan 40 wangwu 60 zhangliu
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 3
10.10.10.221:6379&amp;gt; zrange zsetk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;wangwu&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangliu&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zcard&quot;&gt;zcard&lt;/h3&gt;

&lt;p&gt;获取zset集合的元素个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zcard

  ZCARD key
  summary: Get the number of members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.2.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zcount&quot;&gt;zcount&lt;/h3&gt;

&lt;p&gt;统计zset集合中指定分数区间的元素个数，闭区间[min, max]&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zcount

  ZCOUNT key min max
  summary: Count the members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;with scores within the given values
  since: 2.0.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zcount zsetk 45 55
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zincrby&quot;&gt;zincrby&lt;/h3&gt;

&lt;p&gt;增加zset集合中指定元素的分数。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zincrby

  ZINCRBY key increment member
  summary: Increment the score of a member &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.2.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zrange&quot;&gt;zrange&lt;/h3&gt;

&lt;p&gt;返回zset集合中指定索引区间的元素，闭区间[start, stop]&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zrange

  ZRANGE key start stop &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WITHSCORES]
  summary: Return a range of members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;, by index
  since: 1.2.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zrange zsetk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;wangwu&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangliu&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; zrange zsetk 0 &lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt; withscores
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;wangwu&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;40&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangliu&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;60&quot;&lt;/span&gt;
5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;
6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;80&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;zrange和zcount区别：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt;zrange&lt;/th&gt;
      &lt;th&gt;zcount&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;区间&lt;/td&gt;
      &lt;td&gt;下标索引区间&lt;/td&gt;
      &lt;td&gt;分数区间&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;返回值&lt;/td&gt;
      &lt;td&gt;返回元素(及分数)&lt;/td&gt;
      &lt;td&gt;返回元素的个数&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;zrangebyscore&quot;&gt;zrangebyscore&lt;/h3&gt;

&lt;p&gt;返回zset集合中指定分数区间的元素，闭区间[min, max]&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zrangebyscore

  ZRANGEBYSCORE key min max &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WITHSCORES] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;LIMIT offset count]
  summary: Return a range of members &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;, by score
  since: 1.0.5
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zrangebyscore zsetk 40 60 
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;wangwu&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangliu&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; zrangebyscore zsetk 40 60 withscores
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;wangwu&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;40&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;zhangliu&quot;&lt;/span&gt;
4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;60&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zrem&quot;&gt;zrem&lt;/h3&gt;

&lt;p&gt;删除zset集合中的多个元素，返回成功删除的个数&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zrem

  ZREM key member &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;member ...]
  summary: Remove one or more members from a sorted &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.2.0
  group: sorted_set

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zrank&quot;&gt;zrank&lt;/h3&gt;

&lt;p&gt;获取zset集合中指定元素的排名(排名从0开始)，排名是按照分数从小到大排序的。所以分数越低，排名越靠前。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zrank

  ZRANK key member
  summary: Determine the index of a member &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 2.0.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zscore&quot;&gt;zscore&lt;/h3&gt;

&lt;p&gt;获取zset集合中指定元素的分数。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zscore

  ZSCORE key member
  summary: Get the score associated with the given member &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set
  &lt;/span&gt;since: 1.2.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zscore zsetk zhangsan
&lt;span class=&quot;s2&quot;&gt;&quot;80&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;zrevrank&quot;&gt;zrevrank&lt;/h3&gt;

&lt;p&gt;获取zset集合中指定元素的排名(排名从0开始)，反向排名，也就是分数从大到小排名。所以分数越高，排名越靠前。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;zrevrank

  ZREVRANK key member
  summary: Determine the index of a member &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a sorted &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;, with scores ordered from high to low
  since: 2.0.0
  group: sorted_set
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;实例：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; zrank zsetk zhangsan
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4
10.10.10.221:6379&amp;gt; zrevrank zsetk zhangsan
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis配置文件&quot;&gt;Redis配置文件&lt;/h1&gt;

&lt;h2 id=&quot;0-配置的更改&quot;&gt;0) 配置的更改&lt;/h2&gt;

&lt;p&gt;方式1：通过命令来更改配置：config set。更改后从下条指令生效。
&lt;strong&gt;不是所有的参数都能通过config set来配置。&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;config &lt;span class=&quot;nb&quot;&gt;set

  &lt;/span&gt;CONFIG SET parameter value
  summary: Set a configuration parameter to the given value
  since: 2.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; config &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;port 6969
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;方式2：通过修改配置文件并重启redis服务来更改。&lt;/p&gt;

&lt;h2 id=&quot;1-redis-连接相关配置&quot;&gt;1) redis 连接相关配置&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;配置参数&lt;/th&gt;
      &lt;th&gt;作用&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;bind&lt;/td&gt;
      &lt;td&gt;设置服务端绑定的ip，本质是socket通信中的bind()函数。如果redis不指定bind参数，就是绑定服务端任意网卡&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;port&lt;/td&gt;
      &lt;td&gt;redis服务绑定的端口&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;tcp-keepalive&lt;/td&gt;
      &lt;td&gt;保活策略，单位是秒。redis服务支持的连接数是有限的，不用的连接需要及时释放，否则是浪费。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;requirepass&lt;/td&gt;
      &lt;td&gt;设置redis的登录密码，客户端连接时使用&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;2-redis日志相关配置&quot;&gt;2) redis日志相关配置&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;配置参数&lt;/th&gt;
      &lt;th&gt;作用&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;loglevel&lt;/td&gt;
      &lt;td&gt;日志级别&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;logfile&lt;/td&gt;
      &lt;td&gt;日志文件&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;日志级别，默认为notice，开发阶段debug，上线阶段notice或warning。
如果logfile没有指定，会输出到控制台终端，如果以守护进程运行，会输出到/dev/null。logfile可以是相对路径，也可以是绝对路径。&lt;/p&gt;

&lt;h2 id=&quot;3redis持久化相关配置&quot;&gt;3redis持久化相关配置&lt;/h2&gt;

&lt;p&gt;redis是内存数据库，大部分时间，数据都是存储在内存中，所以高效，但是redis服务关闭后，内存中的数据会消失。&lt;/p&gt;

&lt;h3 id=&quot;redis持久化&quot;&gt;redis持久化&lt;/h3&gt;

&lt;p&gt;redis支持持久化，在适当的时机采用适当的策略，把内存中的数据保存到磁盘中，redis服务重启时可以再次加载到内存中使用。
两种持久化策略，RDB策略和&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;RDB策略&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;通过快照的方式持久化，每隔一段时间，或者每执行若干次写操作之后，就触发一次持久化（快照）。所以最后一次快照之后操作的数据会丢失。
&lt;strong&gt;redis默认采用的是RDB的持久化策略&lt;/strong&gt;。如果要关闭RDB策略，需要注释掉配置文件redis.conf中的所有save参数。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# save seconds changes
# 多少秒完成多少次改变（写操作），就触发一次写操作

# redis默认RDB策略
save 900 1
219 save 300 10
220 save 60 10000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;配置参数&lt;/th&gt;
      &lt;th&gt;作用&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;save&lt;/td&gt;
      &lt;td&gt;设置rdb持久化策略&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;dbfilename&lt;/td&gt;
      &lt;td&gt;redis持久化数据生成的文件名，默认是dump.rdb&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;dir&lt;/td&gt;
      &lt;td&gt;redis持久化数据生成文件保存的目录，默认是./，即启动目录&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rdbcompression&lt;/td&gt;
      &lt;td&gt;设置对存储到磁盘的快照进行压缩&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;日志级别，默认为notice，开发阶段debug，上线阶段notice或warning。
如果logfile没有指定，会输出到控制台终端，如果以守护进程运行，会输出到/dev/null。logfile可以是相对路径，也可以是绝对路径。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;AOF策略&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;append only file。采用操作日志来记录每一次写操作。每次redis服务启动时，都会重新执行一遍操作日志中的指令。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;配置参数&lt;/th&gt;
      &lt;th&gt;作用&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;appendonly&lt;/td&gt;
      &lt;td&gt;是否开启aof策略&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;appendfilename&lt;/td&gt;
      &lt;td&gt;aof持久化的保存的文件名&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;appendfsync&lt;/td&gt;
      &lt;td&gt;aof异步持久化策略。&lt;br /&gt;always:同步持久化，每次发生数据变化都会立刻写入磁盘，性能较差，但数据完整性好;&lt;br /&gt;everysec:出厂默认推荐，每秒异步记录一次;&lt;br /&gt;no:不及时同步，由操作系统决定何时同步;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;4-其它配置&quot;&gt;4) 其它配置&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;配置参数&lt;/th&gt;
      &lt;th&gt;作用&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;databases&lt;/td&gt;
      &lt;td&gt;数据库数量&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;requirepass&lt;/td&gt;
      &lt;td&gt;设置redis服务登录密码，配合安全模式(protected-mode=yes)使用，不建议设置密码，因为redis追求的是高效，设置密码后，每次redis请求都会验证权限和密码，影响效率。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;masterauth&lt;/td&gt;
      &lt;td&gt;redis集群密码，主要是针对master对应的slave节点设置的，在slave节点数据同步的时候用到。集群的masterauth必须一致。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;requirepass和masterauth区别：
requirepass：主要用于redis客户端登录redis服务端的登录密码，每个redis服务都可以设置自己的登录密码，一般不设置
masterauth：主要用于redis集群密码，集群中的主机和从机的集群密码必须相同，在集群中必须设置，不设置，从机连不上主机。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis事务&quot;&gt;Redis事务&lt;/h1&gt;

&lt;p&gt;transaction。
事务：把一组数据库操作（尤其是写操作）放在一起执行，保证操作原子性，要么同时成功，要么同时失败。
redis事务：允许把一组redis命令放在一起执行，把命令进行序列化，然后一起执行。&lt;strong&gt;redis只能保证部分原子性&lt;/strong&gt;。&lt;/p&gt;

&lt;h2 id=&quot;transactions组常见命令&quot;&gt;transactions组常见命令&lt;/h2&gt;

&lt;p&gt;transactions组的全部命令，可以通过help @transactions来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;multi&quot;&gt;multi&lt;/h3&gt;

&lt;p&gt;标记一个事务的开始。标记一个事务开始之后，输入的所有操作命令，都不会立即执行，而是放入到一个事务队列中，直到给出事务执行命令，然后顺序执行事务队列中的命令。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;multi

  MULTI -
  summary: Mark the start of a transaction block
  since: 1.2.0
  group: transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
10.10.10.221:6379&amp;gt; multi
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k2 v2
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;exec
&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; OK
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; OK
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k2&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;exec&quot;&gt;exec&lt;/h3&gt;

&lt;p&gt;开始执行事务队列中的所有命令&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help exec

  &lt;/span&gt;EXEC -
  summary: Execute all commands issued after MULTI
  since: 1.2.0
  group: transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;原子性案例&quot;&gt;原子性案例&lt;/h3&gt;

&lt;p&gt;案例-事务原子性1：&lt;strong&gt;错误的命令&lt;/strong&gt;压入事务队列中，会压入失败，则本事务中所有的命令都不执行，能够保证原子性。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;multi
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
setwww k2 v2
&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
10.10.10.221:6379&amp;gt; multi
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
QUEUED
10.10.10.221:6379&amp;gt; setwww k2 v2
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ERR unknown &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;setwww&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;, with args beginning with: &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;k2&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;, &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;v2&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;, 
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; EXECABORT Transaction discarded because of previous errors.
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;案例-事务部分原子性：命令压入事务队列正常，但是在执行事务队列命令时，&lt;strong&gt;命令执行错误&lt;/strong&gt;，则只影响发生错误的命令，不会影响其他命令的执行。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;multi
set k1 v1
incr k1
set k2 v2
exec

# k1对应的值是v1，是字符串，不是整形数值，incr k1执行会出错
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
10.10.10.221:6379&amp;gt; multi
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
QUEUED
10.10.10.221:6379&amp;gt; incr k1
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k2 v2
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;exec
&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; OK
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ERR value is not an integer or out of range
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; OK
10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k2&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;k1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;discard&quot;&gt;discard&lt;/h3&gt;

&lt;p&gt;丢弃已经压入事务队列中的命令，并结束整个事务。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;discard

  DISCARD -
  summary: Discard all commands issued after MULTI
  since: 2.0.0
  group: transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;watch&quot;&gt;watch&lt;/h3&gt;

&lt;p&gt;watch 监视一个或多个 key , 跟踪 key 的 value 修改情况，如果有key 的 value 值在事务 exec 执行之前被修改了，整个事务被取消。exec 返回提示信息，表示事务已经失败。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;watch配合multi、exec一起使用
Redis禁止在multi和exec之间执行watch指令，而必须在 multi之前做好盯住关键变量，否则会出错
watch使的事务exec变的有条件，事务只有在被watch的key没有修改的前提下才能执行。不满足条件，事务被取消。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;watch

  WATCH key &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;key ...]
  summary: Watch the given keys to determine execution of the MULTI/EXEC block
  since: 2.2.0
  group: transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;客户端1：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty list or &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;refcount 0
OK
10.10.10.221:6379&amp;gt; watch refcount
OK
10.10.10.221:6379&amp;gt; multi
OK
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k1 v1
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k2 v2
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;k3 v3
QUEUED
10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nil&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;客户端2：&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;refcount&quot;&lt;/span&gt;
10.10.10.221:6379&amp;gt; incr refcount
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
10.10.10.221:6379&amp;gt; get refcount
&lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;在watch之后，到exec之前，如果watch监视的key被修改（比如被其他客户端修改），则exec失败。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;unwatch&quot;&gt;unwatch&lt;/h3&gt;

&lt;p&gt;取消所有的监视。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;unwatch

  UNWATCH -
  summary: Forget about all watched keys
  since: 2.2.0
  group: transactions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-s highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;监视取消的时机&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;：&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;①&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;watch命令可以被调用多次&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;对键的监视从watch执行之后开始生效&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;直到调用exec为止&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;不管事务是否成功执行&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;对所有键的监视都会被取消&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;②&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;当客户端断开连接时&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;该客户端对键的监视也会被取消&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;③&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unwatch命令可以手动取消对所有键的监视&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unwatch命令应该在watch之后&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi之前执行&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;如果unwatch放入multi之后&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exec之前&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;不会起到unwatch的作用&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis消息发布与订阅&quot;&gt;Redis消息发布与订阅&lt;/h1&gt;

&lt;p&gt;redis消息和发布，主要用于多个redis客户端之间。&lt;/p&gt;

&lt;p&gt;场景：redis客户端和客户端之间不能直接通信，都是连接的redis服务器。redis客户端client1更改了某个数据，redis客户端client2不知道被修改，redis客户端和客户端之间可以通过rediis服务器来通信。
redis client2订阅某个频道channel，redis client1往频道channel发送消息，此时redis client2就会接收到redis client1发过来的消息。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;redis消息的发布与订阅类似于设计模式中的观察者模式。&lt;/strong&gt;
&lt;strong&gt;相同点：&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;redis&lt;/th&gt;
      &lt;th&gt;观察者模式&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;订阅subscribe&lt;/td&gt;
      &lt;td&gt;注册register&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;发布publish&lt;/td&gt;
      &lt;td&gt;通知notify&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;区别：&lt;/strong&gt;
redis：
	假定有一个发布者client-publish，2个订阅者client-subscribe1和client-subscribe2。
	订阅的动作是client-subscribe发起的，订阅者client-subscribe会处于&lt;strong&gt;阻塞&lt;/strong&gt;状态
观察者：
	假定有一个被观察者（姑且称为中心）center，2个观察者observer1和observer2。
	注册的动作是中心发起的，center-&amp;gt;register(observer1)，center-&amp;gt;register(observer2)，所以观察者&lt;strong&gt;非阻塞&lt;/strong&gt;。&lt;/p&gt;

&lt;h2 id=&quot;pubsub组常见命令&quot;&gt;pubsub组常见命令&lt;/h2&gt;

&lt;p&gt;sub -&amp;gt; subscribe，订阅
pub -&amp;gt; publish，发布&lt;/p&gt;

&lt;p&gt;pubsub组的全部命令，可以通过help @pubsub来查看&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt; @pubsub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;subscribe&quot;&gt;subscribe&lt;/h3&gt;

&lt;p&gt;redis客户端可以订阅(或监听)多个给定的频道。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;subscribe

  SUBSCRIBE channel &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;channel ...]
  summary: Listen &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;messages published to the given channels
  since: 2.0.0
  group: pubsub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;redis client1:订阅频道&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; subscribe channel1 channel2
Reading messages... &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;press Ctrl-C to quit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;channel1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;channel2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;redis client2：给频道发布消息&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; publish channel1 hello
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;此时redis client1收到频道消息&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; subscribe channel1 channel2
Reading messages... &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;press Ctrl-C to quit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;channel1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 1
1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;subscribe&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;channel2&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;integer&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2


1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;message&quot;&lt;/span&gt;
2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;channel1&quot;&lt;/span&gt;
3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;publish&quot;&gt;publish&lt;/h3&gt;

&lt;p&gt;redis客户端发送消息到指定频道。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;publish

  PUBLISH channel message
  summary: Post a message to a channel
  since: 2.0.0
  group: pubsub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;psubscribe&quot;&gt;psubscribe&lt;/h3&gt;

&lt;p&gt;redis客户端可以订阅(或监听)多个给定的频道。订阅的频道支持通配符&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;psubscribe

  PSUBSCRIBE pattern &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;pattern ...]
  summary: Listen &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;messages published to channels matching the given patterns
  since: 2.0.0
  group: pubsub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;redis主从复制&quot;&gt;redis主从复制&lt;/h1&gt;

&lt;p&gt;master/slave机制：
&lt;strong&gt;主少从多&lt;/strong&gt;
&lt;strong&gt;主写从读&lt;/strong&gt;
&lt;strong&gt;读写分离&lt;/strong&gt;
一旦主从关系确定，&lt;strong&gt;主机上已有数据自动同步复制到从机&lt;/strong&gt;。&lt;/p&gt;

&lt;h2 id=&quot;搭建一主二从集群&quot;&gt;搭建一主二从集群&lt;/h2&gt;

&lt;p&gt;搭建3台redis服务。实际生产中使用3台服务器。
&lt;strong&gt;redis集群中的机器，需要安装相同的redis版本。&lt;/strong&gt;
这里为了简化，在同一台服务器上模拟3台redis服务，3个服务的端口分别为6379、6380、6381。把端口6379所在服务作为主机，6380、6381作为从机。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1. 提供3份配置文件，分别为6379.conf、6380.conf、6381.conf。修改每个配置文件如下信息，以6380.conf为例：
		port		6380								
		pidfile /var/run/redis_6380.pid
		logfile &quot;/tmp/redis/redis_6380.log&quot;
		dbfilename dump_6380.rdb
		masterauth masterpassword
		
		主机和从机的masterauth密码需要设置，并且设置相同密码
2. 用3个配置文件启动三次redis-server服务(此时的三个服务各自独立)
3. 开启三个server-cli，分别连三个服务
4. 查看每个redis服务的角色。info replication
		此时每个redis服务都是主机master
5. 连接6380、6381的两个客户端，分别执行slaveof 10.10.10.221 6379
6. 再次查看redis服务角色。info replication
		此时6379是主机master，6380、6381是slave				
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果主机能显示从机，从机显示主机down，不能从主机复制到从机，可能需要先删除dump.rdb数据文件，重新启动redis服务，如果dump.rdb中已有数据，慎重删除。&lt;/p&gt;

&lt;h3 id=&quot;server组常见命令&quot;&gt;server组常见命令&lt;/h3&gt;

&lt;h3 id=&quot;slaveof&quot;&gt;slaveof&lt;/h3&gt;

&lt;p&gt;设置主从关系，&lt;strong&gt;设从不设主&lt;/strong&gt;。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6379&amp;gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;slaveof

  SLAVEOF host port
  summary: Make the server a slave of another instance, or promote it as master
  since: 1.0.0
  group: server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 两种用法&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 用法1：设置主从关系，从属于某个master主机&lt;/span&gt;
slaveof host port
&lt;span class=&quot;c&quot;&gt;# 用法2: 放弃主从关系，自己提升为master。&lt;/span&gt;
slaveof no one

&lt;span class=&quot;c&quot;&gt;# 用法1用来搭建主从集群，让从机隶属于某个主机&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 用法2用来提升从机的角色，成为master&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6380&amp;gt; slaveof 10.10.10.221 6379
OK
10.10.10.221:6380&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:up
master_last_io_seconds_ago:5
master_sync_in_progress:0
slave_repl_offset:14
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:14
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:14
10.10.10.221:6380&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;a) 如果主机宕机，端口为6379的redis服务关闭。&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;查看从机在集群中状态
从机角色不变&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;role:slave&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
显示主机宕机&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;master_link_status:down&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
从机仍然只读不写
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;主机重新启动。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;主机重新启动后，不需要做任何设置，即可恢复主机master身份，从机仍然附属于主机。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10.10.10.221:6380&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:down
master_last_io_seconds_ago:-1
master_sync_in_progress:0
slave_repl_offset:10805
master_link_down_since_seconds:6
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:10805
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:10470
repl_backlog_histlen:336
10.10.10.221:6380&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;b) 如果从机宕机，端口为6380的redis服务关闭。&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;查看其他从机在集群中状态：没有任何变化
查看主机在集群中的状态：从机数量少了一个
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;从机6380重新启动&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;客户端连接6380，并查看6380服务在集群中的状态:成为一个独立的master，和之前的集群没有任何关系。
连接6380的客户端重新执行slaveof 10.10.10.221 6379
此时6380再次成为6379的从机
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;关键点：从机宕机后重启，需要重新设置。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;a) 如果主机宕机，让从机6380上位。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;场景：如果主机宕机，并且无法修复，或者修复时间过长，让一个从机升级为主机。&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 1. 让6379宕机&lt;/span&gt;
10.10.10.221:6379&amp;gt; shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 2. 让6380提升为主机&lt;/span&gt;
10.10.10.221:6380&amp;gt; slaveof no one
OK
10.10.10.221:6380&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:master
connected_slaves:0
master_replid:05c69556aca23fd551fc0730332605e75648387a
master_replid2:979dc92d8aeb605ea22a2b568d2121dae3d2f321
master_repl_offset:17528
second_repl_offset:17529
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:17528
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 3. 让6381成为6380的从机&lt;/span&gt;
10.10.10.221:6381&amp;gt; slaveof 10.10.10.221 6380
OK
10.10.10.221:6381&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:slave
master_host:10.10.10.221
master_port:6380
master_link_status:up
master_last_io_seconds_ago:8
master_sync_in_progress:0
slave_repl_offset:17542
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:05c69556aca23fd551fc0730332605e75648387a
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:17542
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:17529
repl_backlog_histlen:14
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;redis哨兵服务&quot;&gt;redis哨兵服务&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;redis集群中，如果主机宕机，从机原地待命；此时从机上位，需要手动设置。
缺陷：不能立刻知道谁宕机，而且需要手动设置从机上位。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;提出了哨兵模式：主机宕机，从机自动上位。
专门的哨兵服务：redis-sentinel
哨兵配置文件:		sentinel.conf&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# sentinel monitor &amp;lt;master-name&amp;gt; &amp;lt;ip&amp;gt; &amp;lt;redis-port&amp;gt; &amp;lt;quorum&amp;gt;&lt;/span&gt;
sentinel monitor xxx1 10.10.10.221 6379 1
&lt;span class=&quot;c&quot;&gt;# sentinel		：	表示哨兵&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# monitor			：	表示监控&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# master-name	：	表示哨兵的名字，任意起一个名字&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ip					：	监控的主机ip，redis主机中bind的ip&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# port				：	监控的端口&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# quorum			： 得到哨兵的投票数&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 比如有1主5从，主机宕机，内部有一个投票机制，哪一个从机率先到达指定的投票数quorum，就将该从机提升为主机，其余从机从属于新主机。&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 默认投票机制：&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#		quorum越大，会挑选一个性能最好的从机，quorum越小，比如为1，只要有一个从机率先得到1票，该从机就提升为主机。&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#		quorum一般等于或小于从机数，quorum值越小，挑选从机的速度就越快，一般选择一个居中的值。&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sentinel monitor sm1 10.10.10.221 6379 1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; my_sentinel.conf
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# 启动哨兵服务&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;redis-sentinel sentinel.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 1. 主机6379宕机&lt;/span&gt;
10.10.10.221:6379&amp;gt; shutdown

&lt;span class=&quot;c&quot;&gt;# 2. 根据哨兵内部投票规则，此时从机6380上位，查看6380集群状态&lt;/span&gt;
10.10.10.221:6380&amp;gt; info replication
&lt;span class=&quot;c&quot;&gt;# Replication&lt;/span&gt;
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:down
master_last_io_seconds_ago:-1
master_sync_in_progress:0
slave_repl_offset:22098
master_link_down_since_seconds:4
slave_priority:100
slave_read_only:1
connected_slaves:1
slave0:ip&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;10.10.10.221,port&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6381,state&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;online,offset&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;22098,lag&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
master_replid:979dc92d8aeb605ea22a2b568d2121dae3d2f321
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:22098
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:18407
repl_backlog_histlen:3692
10.10.10.221:6380&amp;gt; 

&lt;span class=&quot;c&quot;&gt;# 3.重启6379，在哨兵模式下，6379会从属于新的主机6380&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 26 Mar 2022 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2022/03/Redis%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</link>
        <guid isPermaLink="true">http://localhost:4000/2022/03/Redis%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</guid>
        
        
      </item>
    
  </channel>
</rss>
