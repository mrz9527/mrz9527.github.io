I"Ù<h1 id="simpleperf">simpleperf</h1>

<p>simpleperfæ˜¯ndkåŒ…ä¸‹çš„ä¸€ä¸ªæ€§èƒ½åˆ†æå·¥å…·ï¼Œä¸“é—¨ç”¨äºåˆ†ændkã€‚</p>

<p>simpleperfæœ‰ä¸¤ç§å·¥ä½œæ–¹å¼ï¼Œä¸€ç§æ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯è„šæœ¬çš„æ–¹å¼ã€‚</p>

<p>ä¸‹è½½ndkåŒ…ï¼Œé‡Œé¢è‡ªå¸¦simpleperfã€‚</p>

<p>/Users/xm210408/Library/Android/sdk/ndk/21.1.6352462/simpleperf</p>

<p>å‡†å¤‡å·¥ä½œ</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>simpleperfè¾“å‡ºæ€§èƒ½æ•°æ®å’ŒæŠ¥å‘Šçš„å‘½ä»¤ï¼Œä¸»è¦æ˜¯åœ¨pcç«¯è¿è¡Œã€‚
simpleperfç”¨åˆ°äº†adbï¼Œéœ€è¦æœ‰adbç¯å¢ƒã€‚
æ‰‹æœºè¿æ¥pcæœºã€‚
æ‰§è¡Œapp_profiler.pyè„šæœ¬ï¼ŒæŒ‰ç…§æç¤ºï¼Œæ‰‹åŠ¨å¯åŠ¨æ‰‹æœºä¸Šç›¸åº”appï¼Œè‡ªåŠ¨è¾“å‡ºæ€§èƒ½æ•°æ®
æ‰§è¡Œreport_html.pyè„šæœ¬ï¼Œè¾“å‡ºæŠ¥å‘Šã€‚

</code></pre></div></div>

<h2 id="è¾“å‡ºæ€§èƒ½æ•°æ®">è¾“å‡ºæ€§èƒ½æ•°æ®</h2>

<p>è®°å½•è®¾å¤‡ä¸Šappè¿è¡Œè¿‡ç¨‹ï¼Œåœ¨æœ¬æœºpcä¸Šç”Ÿæˆæ€§èƒ½æ•°æ®perf.dataã€‚ç”¨åˆ°çš„è„šæœ¬æ˜¯app_profiler.pyã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python app_profiler.py -p simpleperf.example.cpp -lib /Users/xm210408/programs/extras/simpleperf/demo/SimpleperfExampleCpp/app/build/intermediates/cmake/debug/obj/arm64-v8a/

python app_profiler.py -p com.tencent.olhct2soLibrary -lib /Users/xm210408/program2/olhct_sdk/app/build/intermediates/cmake/debug/obj/arm64-v8a/
</code></pre></div></div>

<p>-p simpleperf.example.cppæ˜¯æ‰‹æœºä¸­androidé¡¹ç›®çš„è¿›ç¨‹ï¼Œ-lib libdiræ˜¯ndkç¼–è¯‘çš„soæ‰€åœ¨çš„ç›®å½•ï¼Œè¿è¡Œpythonè„šæœ¬éœ€è¦python3çš„ç¯å¢ƒã€‚</p>

<h2 id="ç”ŸæˆæŠ¥å‘Š">ç”ŸæˆæŠ¥å‘Š</h2>

<p>è§£ææ€§èƒ½æ•°æ®æ–‡ä»¶perf.dataï¼Œç”Ÿæˆåˆ†ææŠ¥å‘Šã€‚</p>

<p>report_html.pyåœ¨simpleperfç›®å½•ä¸‹ã€‚â€“source_dirs ../demoæ˜¯æºç cppæ‰€åœ¨ç›®å½•ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python report_html.py --add_source_code --source_dirs ../demo --add_disassembly

python report_html.py --add_source_code --source_dirs /Users/xm210408/program2/olhct_sdk/app/src/main/cpp --add_disassembly -o xxx.html
</code></pre></div></div>

<h2 id="å…¶ä»–åŠŸèƒ½">å…¶ä»–åŠŸèƒ½</h2>

<p>åœ¨simpleperfç›®å½•ä¸‹ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„è„šæœ¬å¯ä¾›ä½¿ç”¨ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> | <span class="nb">grep</span> <span class="s2">"</span><span class="se">\.</span><span class="s2">py"</span>
__init__.py
annotate.py
api_profiler.py
app_profiler.py
binary_cache_builder.py
debug_unwind_reporter.py
pprof_proto_generator.py
profile_pb2.py
report.py
report_html.py
report_sample.py
run_simpleperf_on_device.py
run_simpleperf_without_usb_connection.py
simpleperf_report_lib.py
utils.py
</code></pre></div></div>

<h2 id="å®˜æ–¹èµ„æ–™">å®˜æ–¹èµ„æ–™</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://developer.android.com/ndk/guides/simpleperf
</code></pre></div></div>

:ET