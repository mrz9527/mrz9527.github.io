I"™©<h1 id="redisä»‹ç»">Redisä»‹ç»</h1>

<p>rediså±äºnosqlæ•°æ®åº“ï¼Œé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œç¼–å·ä»0~15ï¼›
æ•°æ®ä½¿ç”¨key-valueé”®å€¼å¯¹æ–¹å¼å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè¯»å†™é€Ÿåº¦éå¸¸å¿«ï¼Œå¤šç”¨äºé«˜å¹¶å‘å’Œé«˜æ€§èƒ½ã€‚æ•°æ®è¿˜èƒ½æŒä¹…åŒ–ï¼›
å±äºå•çº¿ç¨‹æ•°æ®åº“ï¼Œå†…éƒ¨é‡‡ç”¨IOå¤šè·¯å¤ç”¨æœºåˆ¶ã€‚
Redisæœ¬è´¨ä¸Šåªæœ‰ä¸€ç§æ•°æ®ç»“æ„ï¼Œå°±æ˜¯K-Vé”®å€¼å¯¹ï¼Œä½†é€šè¿‡valueè¡ç”Ÿå‡º5ç§æ•°æ®ç»“æ„ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>string
list
set
zset
hash
</code></pre></div></div>

<h1 id="rediså®‰è£…">Rediså®‰è£…</h1>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>wget http://download.redis.io/releases/redis-5.0.7.tar.gz
<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-zvxf</span> redis-5.0.7.tar.gz
<span class="nv">$ </span><span class="nb">mv </span>redis-5.0.7 redis
<span class="nv">$ </span><span class="nb">cd </span>redis

<span class="nv">$ </span>make <span class="nt">-j4</span>
<span class="nv">$ </span>make <span class="nv">PREFIX</span><span class="o">=</span>/usr/local/redis <span class="nb">install</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"export PATH=/usr/local/redis:</span><span class="nv">$PATH</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ~/.bashrc
<span class="nv">$ </span><span class="nb">source</span> ~/.bashrc
</code></pre></div></div>

<p>rediså…¶ä»–ç‰ˆæœ¬å¯åœ¨å®˜ç½‘ä¸‹è½½ï¼Œ<a href="https://redis.io/">rediså®˜ç½‘</a></p>

<h1 id="redisæœåŠ¡ç«¯å¯åŠ¨å’Œå…³é—­">RedisæœåŠ¡ç«¯å¯åŠ¨å’Œå…³é—­</h1>

<h2 id="1-redisæœåŠ¡å¯åŠ¨">1) RedisæœåŠ¡å¯åŠ¨</h2>

<p>RedisæœåŠ¡ç¨‹åº: <strong>redis-server</strong></p>

<ul>
  <li><strong>é»˜è®¤å¯åŠ¨</strong></li>
</ul>

<p>é»˜è®¤æ–¹å¼ä½¿ç”¨çš„ç«¯å£å·æ˜¯ï¼š<strong>6379</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">nohup </span>redis-server &amp;
</code></pre></div></div>

<ul>
  <li><strong>é…ç½®æ–‡ä»¶å¯åŠ¨</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">nohup </span>redis-server redis.conf &amp;
</code></pre></div></div>

<p>â€‹	é…ç½®æ–‡ä»¶redis.confä¸­å¯ä»¥æ›´æ”¹ç«¯å£å·</p>

<h2 id="2-redisæœåŠ¡å…³é—­">2) RedisæœåŠ¡å…³é—­</h2>

<p>æœ‰ä¸¤ç§æ–¹å¼å…³é—­redisæœåŠ¡</p>

<ul>
  <li>åœ¨æœåŠ¡å™¨ä¸Šå…³é—­redisæœåŠ¡</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps <span class="nt">-ef</span> | <span class="nb">grep </span>redis
zhoukang  26681      1  0 Mar18 ?        00:01:42 redis-server <span class="k">*</span>:6379
zhoukang  41957  40666  0 18:42 pts/0    00:00:00 <span class="nb">grep</span> <span class="nt">--color</span><span class="o">=</span>auto redis
<span class="nb">kill</span> <span class="nt">-9</span> 26681
</code></pre></div></div>

<ul>
  <li>é€šè¿‡å®¢æˆ·ç«¯æ¥å…³é—­redisæœåŠ¡</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli
127.0.0.1:6379&gt; shutdown
</code></pre></div></div>

<p>å¦‚æœæœåŠ¡å™¨æ˜¯é»˜è®¤å¯åŠ¨çš„ï¼Œé‚£ä¹ˆæœåŠ¡å™¨æ²¡æœ‰é…ç½®æ—¥å¿—æ–‡ä»¶ï¼Œåœ¨å®¢æˆ·ç«¯æ˜¯ä¸å…è®¸shutdownï¼Œä¼šæŠ¥é”™</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli
127.0.0.1:6379&gt; shutdown
<span class="o">(</span>error<span class="o">)</span> ERR Errors trying to SHUTDOWN. Check logs.
</code></pre></div></div>

<h1 id="rediså®¢æˆ·ç«¯å¯åŠ¨å’Œå…³é—­">Rediså®¢æˆ·ç«¯å¯åŠ¨å’Œå…³é—­</h1>

<p>Rediså®¢æˆ·ç«¯ç¨‹åº: <strong>redis-cli</strong>
è¿˜å¯ä»¥åœ¨è‡ªå·±çš„ç¨‹åºä¸­è¿æ¥redisæ•°æ®åº“ï¼Œæ­¤æ—¶è‡ªå·±çš„ç¨‹åºå°±æ˜¯å®¢æˆ·ç«¯</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli <span class="nt">--help</span>
redis-cli 5.0.7

Usage: redis-cli <span class="o">[</span>OPTIONS] <span class="o">[</span>cmd <span class="o">[</span>arg <span class="o">[</span>arg ...]]]
  <span class="nt">-h</span> &lt;<span class="nb">hostname</span><span class="o">&gt;</span>      Server <span class="nb">hostname</span> <span class="o">(</span>default: 127.0.0.1<span class="o">)</span><span class="nb">.</span>
  <span class="nt">-p</span> &lt;port&gt;          Server port <span class="o">(</span>default: 6379<span class="o">)</span><span class="nb">.</span>
  <span class="nt">-a</span> &lt;password&gt;      Password to use when connecting to the server.
</code></pre></div></div>

<p>redis-cliæœ‰å¾ˆå¤šé€‰é¡¹ï¼Œå¸¸ç”¨çš„æ˜¯ä¸Šé¢3ä¸ªé€‰é¡¹</p>

<h2 id="1-æœ¬åœ°è¿æ¥redisæœåŠ¡">1) æœ¬åœ°è¿æ¥redisæœåŠ¡</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli
127.0.0.1:6379&gt; 
</code></pre></div></div>

<p>é»˜è®¤è¿çš„æ˜¯127.0.0.1:6379</p>

<h2 id="2-è¿œç¨‹è¿æ¥redisæœåŠ¡">2) è¿œç¨‹è¿æ¥redisæœåŠ¡</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli <span class="nt">-h</span> 10.10.10.221 <span class="nt">-p</span> 6379
10.10.10.221:6379&gt; 
</code></pre></div></div>

<p>è¿œç¨‹è¿æ¥redisæœåŠ¡ï¼Œ-hæŒ‡å®šhost ipï¼Œ-pæŒ‡å®šç«¯å£portï¼Œ-aæŒ‡å®šrediså¯†ç ï¼Œauthorã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-cli <span class="nt">-h</span> 10.10.10.221 <span class="nt">-p</span> 6379
Could not connect to Redis at 10.10.10.221:6379: Connection refused
</code></pre></div></div>

<p>è¿™æ˜¯å› ä¸ºï¼š
	æœåŠ¡ç«¯è®¾ç½®äº†bindå±æ€§ï¼Œåªæœ‰bindæŒ‡å®šçš„ipæ‰èƒ½è®¿é—®ï¼Œå¯ä»¥æ³¨é‡Šbindï¼Œæˆ–è€…æŒ‡å®šipï¼Œä¸€èˆ¬æœåŠ¡ç«¯ä¼šè®¾ç½®æŒ‡å®šipï¼›
	æœåŠ¡ç«¯è®¾ç½®äº†protected-modeå±æ€§ä¸ºyesï¼Œéœ€è¦è®¾ç½®ä¸ºnoï¼Œä¸é‡‡ç”¨ä¿æŠ¤æ¨¡å¼ã€‚
	ç„¶åé‡å¯redisæœåŠ¡ï¼Œå³å¯è¿œç¨‹è¿æ¥ã€‚</p>

<h2 id="3-rediså®¢æˆ·ç«¯å…³é—­">3) rediså®¢æˆ·ç«¯å…³é—­</h2>

<ul>
  <li>é€šè¿‡exitå‘½ä»¤é€€å‡º</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">exit</span>
<span class="nv">$ </span>
</code></pre></div></div>

<ul>
  <li>é€šè¿‡quitå‘½ä»¤é€€å‡º</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; quit
<span class="nv">$ </span>
</code></pre></div></div>

<h1 id="rediså®¢æˆ·ç«¯å¸®åŠ©æ‰‹å†Œ">Rediså®¢æˆ·ç«¯å¸®åŠ©æ‰‹å†Œ</h1>

<h2 id="help">help</h2>

<p>å¸®åŠ©æ‰‹å†Œï¼ŒæŸ¥çœ‹rediså¸¸è§å‘½ä»¤åŠç”¨æ³•</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help
</span>redis-cli 4.0.14
To get <span class="nb">help </span>about Redis commands <span class="nb">type</span>:
      <span class="s2">"help @&lt;group&gt;"</span> to get a list of commands <span class="k">in</span> &lt;group&gt;
      <span class="s2">"help &lt;command&gt;"</span> <span class="k">for </span><span class="nb">help </span>on &lt;<span class="nb">command</span><span class="o">&gt;</span>
      <span class="s2">"help &lt;tab&gt;"</span> to get a list of possible <span class="nb">help </span>topics
      <span class="s2">"quit"</span> to <span class="nb">exit

</span>To <span class="nb">set </span>redis-cli preferences:
      <span class="s2">":set hints"</span> <span class="nb">enable </span>online hints
      <span class="s2">":set nohints"</span> disable online hints
Set your preferences <span class="k">in</span> ~/.redisclirc
10.10.10.221:6379&gt;
</code></pre></div></div>

<ul>
  <li>
    <p>â€œhelp @<group>"</group></p>

    <p>â€‹		 ç”¨äºè·å–ä¸€ä¸ªç»„é‡Œé¢çš„æ‰€æœ‰å‘½ä»¤ã€‚ä¸€èˆ¬æ˜¯è¾“å…¥â€help @â€ï¼Œç„¶åæŒ‰tabé”®ï¼Œä¼šè‡ªåŠ¨æç¤ºç»„</p>
  </li>
  <li>
    <p>â€œhelp <tab>"</tab></p>

    <p>â€‹		ç”¨äºè·å–ç›¸å…³ä¸»ä½“çš„æ‰€æœ‰å‘½ä»¤ã€‚ä¸€èˆ¬æ˜¯è¾“å…¥â€help â€œï¼Œç„¶åæŒ‰tabé”®ï¼Œä¼šè‡ªåŠ¨æç¤ºç›¸å…³ä¸»ä½“</p>
  </li>
  <li>
    <p>â€œhelp <command />â€</p>

    <p>â€‹		ç”¨äºè·å–æŒ‡ä»¤å‘½ä»¤çš„å¸®åŠ©</p>

    <p>å…·ä½“ç”¨æ³•ï¼šâ€help @<group>"</group></p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @generic
  
  DEL key <span class="o">[</span>key ...]
  summary: Delete a key
  since: 1.0.0
  
  DUMP key
  summary: Return a serialized version of the value stored at the specified key.
  since: 2.6.0
  
  EXISTS key <span class="o">[</span>key ...]
  summary: Determine <span class="k">if </span>a key exists
  since: 1.0.0
...
</code></pre></div>    </div>

    <p>æ­¤æ—¶è¾“å‡ºï¼š
		genericç»„çš„æ‰€æœ‰å‘½ä»¤
		å‘½ä»¤çš„ä½œç”¨
		å‘½ä»¤çš„ç‰ˆæœ¬</p>

    <p>å…·ä½“ç”¨æ³•ï¼šâ€help <command />â€</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ï¼š10.10.10.221:6379&gt; <span class="nb">help set
  
  </span>SET key value <span class="o">[</span>EX seconds] <span class="o">[</span>PX milliseconds] <span class="o">[</span>NX|XX]
  summary: Set the string value of a key
  since: 1.0.0
  group: string
  
10.10.10.221:6379&gt; 
</code></pre></div>    </div>

    <p>æ­¤æ—¶è¾“å‡ºï¼š
	keyçš„è¯­æ³•
	keyçš„ä½œç”¨
	keyçš„ç‰ˆæœ¬
	keyæ‰€åœ¨ç»„</p>
  </li>
</ul>

<p><strong>æŠ€å·§ï¼š</strong>
		ä¸€ä¸ªå‘½ä»¤çš„å…³è”å‘½ä»¤æœ‰å“ªäº›ï¼Ÿå…ˆæŸ¥çœ‹å‘½ä»¤åœ¨å“ªä¸ªç»„ï¼Œç„¶åæŸ¥çœ‹ç»„å†…æœ‰å“ªäº›å‘½ä»¤ã€‚ä»¥pingå‘½ä»¤ä¸ºä¾‹ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>ping

  PING <span class="o">[</span>message]
  summary: Ping the server
  since: 1.0.0
  group: connection

10.10.10.221:6379&gt;
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @connection

  AUTH password
  summary: Authenticate to the server
  since: 1.0.0

  ECHO message
  summary: Echo the given string
  since: 1.0.0

  PING <span class="o">[</span>message]
  summary: Ping the server
  since: 1.0.0

  QUIT -
  summary: Close the connection
  since: 1.0.0

  SELECT index
  summary: Change the selected database <span class="k">for </span>the current connection
  since: 1.0.0

10.10.10.221:6379&gt;		
</code></pre></div></div>

<h1 id="rediså®¢æˆ·ç«¯å¸¸ç”¨å‘½ä»¤">Rediså®¢æˆ·ç«¯å¸¸ç”¨å‘½ä»¤</h1>

<p>é‰´äºredisçš„å¸®åŠ©æ‰‹å†Œå¯ä»¥æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤ï¼Œæ•…è¿™é‡Œåªåˆ—å‡ºå¸¸ç”¨å‘½ä»¤ã€‚</p>

<h2 id="1-serverç»„å¸¸è§å‘½ä»¤">1) serverç»„å¸¸è§å‘½ä»¤</h2>

<p>serverç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @serveræ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @server
</code></pre></div></div>

<h3 id="config-get">config get</h3>

<p>æŸ¥çœ‹æœåŠ¡å™¨å¯åŠ¨æ—¶é…ç½®æ–‡ä»¶(redis.conf)ä¸­çš„å‚æ•°</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>config get

  CONFIG GET parameter
  summary: Get the value of a configuration parameter
  since: 2.0.0
  group: server
</code></pre></div></div>

<ul>
  <li>
    <p>æŸ¥çœ‹æ‰€æœ‰çš„é…ç½®å‚æ•°</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; config get <span class="k">*</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>æŸ¥çœ‹å•ä¸ªé…ç½®å‚æ•°</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; config get port
1<span class="o">)</span> <span class="s2">"port"</span>
2<span class="o">)</span> <span class="s2">"6379"</span>
10.10.10.221:6379&gt;
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="dbsize">dbsize</h3>

<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„keysçš„æ•°é‡</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>dbsize

  DBSIZE -
  summary: Return the number of keys <span class="k">in </span>the selected database
  since: 1.0.0
  group: server
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; dbsize
<span class="o">(</span>integer<span class="o">)</span> 0
10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
OK
10.10.10.221:6379&gt; dbsize
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; 
</code></pre></div></div>

<p>åœ¨ç©ºçš„æ•°æ®åº“ä¸­æ·»åŠ äº†ä¸€æ¡æ•°æ®ï¼Œkeysæ•°é‡å˜ä¸º1</p>

<h3 id="flushdb">flushdb</h3>

<p>åˆ é™¤å½“å‰æ•°æ®åº“çš„æ‰€æœ‰key</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>flushdb

  FLUSHDB -
  summary: Remove all keys from the current database
  since: 1.0.0
  group: server

10.10.10.221:6379&gt; 
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; dbsize
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; flushdb
OK
10.10.10.221:6379&gt; dbsize
<span class="o">(</span>integer<span class="o">)</span> 0
</code></pre></div></div>

<p>æ•°æ®åº“ä¸­æœ‰ä¸€æ¡æ•°æ®ï¼Œåˆ é™¤å½“å‰æ•°æ®çœ‹ä¸­æ‰€æœ‰keyåï¼Œæ•°æ®åº“ä¸ºç©º</p>

<h3 id="flushall">flushall</h3>

<p>åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key</p>

<h3 id="info">info</h3>

<p>æŸ¥çœ‹redisæœåŠ¡çš„ç»Ÿè®¡ä¿¡æ¯</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>info

  INFO <span class="o">[</span>section]
  summary: Get information and statistics about the server
  since: 1.0.0
  group: server
</code></pre></div></div>

<p>ä¸åŠ sectionï¼ŒæŸ¥çœ‹æ‰€æœ‰ä¿¡æ¯ï¼ŒåŠ sectionä¹‹åï¼ŒæŸ¥çœ‹æŒ‡å®šsectionçš„ä¿¡æ¯ï¼Œè¿™é‡ŒæŸ¥çœ‹sectionä¸ºclientsçš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; info clients
<span class="c"># Clients</span>
connected_clients:1
client_recent_max_input_buffer:2
client_recent_max_output_buffer:0
blocked_clients:0
10.10.10.221:6379&gt; 
</code></pre></div></div>

<p>åœ¨redisé›†ç¾¤ä¸­ï¼ŒæŸ¥çœ‹ä¸»ä»å¤åˆ¶</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; info replication
<span class="c"># Replication</span>
role:master
connected_slaves:2
slave0:ip<span class="o">=</span>10.10.10.221,port<span class="o">=</span>6380,state<span class="o">=</span>online,offset<span class="o">=</span>1806,lag<span class="o">=</span>1
slave1:ip<span class="o">=</span>10.10.10.221,port<span class="o">=</span>6381,state<span class="o">=</span>online,offset<span class="o">=</span>1806,lag<span class="o">=</span>1
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:1820
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:1820
10.10.10.221:6379&gt; 
</code></pre></div></div>

<p>å¯ä»¥çœ‹åˆ°å½“å‰redisæœåŠ¡(10.10.10.221:6379)æ˜¯ä¸»æœº(role:master)ï¼Œæœ‰ä¸¤å°ä»æœº(connected_slaves:2)</p>

<h3 id="shutdown">shutdown</h3>

<p>ä¿å­˜æ•°æ®åº“æ•°æ®åˆ°ç£ç›˜ä¸Šï¼Œç„¶åå…³é—­redisæœåŠ¡ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>shutdown

  SHUTDOWN <span class="o">[</span>NOSAVE|SAVE]
  summary: Synchronously save the dataset to disk and <span class="k">then </span>shut down the server
  since: 1.0.0
  group: server
</code></pre></div></div>

<h2 id="2-genericç»„å¸¸è§å‘½ä»¤">2) genericç»„å¸¸è§å‘½ä»¤</h2>

<p>genericç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @genericæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @generic
</code></pre></div></div>

<h3 id="del">del</h3>

<p>åˆ é™¤keyï¼Œå¯ä»¥åŒæ—¶åˆ é™¤å¤šä¸ªkeyï¼Œè¿”å›åˆ é™¤keyçš„ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>del

  DEL key <span class="o">[</span>key ...]
  summary: Delete a key
  since: 1.0.0
  group: generic
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k2 v2
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k3 v3
OK
10.10.10.221:6379&gt; del k1 k2
<span class="o">(</span>integer<span class="o">)</span> 2
</code></pre></div></div>

<h3 id="exists">exists</h3>

<p>åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥åŒæ—¶åˆ¤æ–­å¤šä¸ªkeyæ˜¯å¦å­˜åœ¨ï¼Œè¿”å›å­˜åœ¨keyçš„ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>exists

  EXISTS key <span class="o">[</span>key ...]
  summary: Determine <span class="k">if </span>a key exists
  since: 1.0.0
  group: generic
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k2 v2
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k3 v3
OK
10.10.10.221:6379&gt; exists k1 k2 k3 k4
<span class="o">(</span>integer<span class="o">)</span> 3
</code></pre></div></div>

<h3 id="keys">keys</h3>

<p>æŸ¥çœ‹æ‰€æœ‰åŒ¹é…ä¸Špatternçš„æ‰€æœ‰key. (é€šé…ç¬¦çš„æ–¹å¼åŒ¹é…ï¼Œè€Œä¸æ˜¯æ­£åˆ™åŒ¹é…)</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>keys

  KEYS pattern
  summary: Find all keys matching the given pattern
  since: 1.0.0
  group: generic
</code></pre></div></div>

<p>æŸ¥çœ‹æ‰€æœ‰key</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
</code></pre></div></div>

<p>æŸ¥çœ‹åŒ¹é…çš„key</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
2<span class="o">)</span> <span class="s2">"hello1"</span>
3<span class="o">)</span> <span class="s2">"hello"</span>
10.10.10.221:6379&gt; keys hel<span class="k">*</span>
1<span class="o">)</span> <span class="s2">"hello1"</span>
2<span class="o">)</span> <span class="s2">"hello"</span>
10.10.10.221:6379&gt; keys ??llo<span class="k">*</span>
1<span class="o">)</span> <span class="s2">"hello1"</span>
2<span class="o">)</span> <span class="s2">"hello"</span>
</code></pre></div></div>

<h3 id="é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„åŒºåˆ«">é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼çš„åŒºåˆ«</h3>

<p>åº”ç”¨åœºæ™¯çš„åŒºåˆ†ï¼š
	<strong>é€šé…ç¬¦</strong>å¤šç”¨äºæ–‡ä»¶æœç´¢
	<strong>æ­£åˆ™è¡¨è¾¾å¼</strong>å¤šç”¨äºå­—ç¬¦å­ä¸²çš„æŸ¥æ‰¾
è¯­æ³•åŒºåˆ†ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Â </th>
      <th style="text-align: left">é€šé…ç¬¦</th>
      <th style="text-align: left">æ­£åˆ™</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">*</td>
      <td style="text-align: left">0ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦</td>
      <td style="text-align: left">0ä¸ªæˆ–å¤šä¸ª</td>
    </tr>
    <tr>
      <td style="text-align: left">?</td>
      <td style="text-align: left">1ä¸ªä»»æ„å­—ç¬¦</td>
      <td style="text-align: left">1ä¸ª</td>
    </tr>
  </tbody>
</table>

<p>æ­£åˆ™ä¸­çš„ä»»æ„å­—ç¬¦ï¼Œç”¨â€.â€è¡¨ç¤ºã€‚
æ­£åˆ™ä¸­çš„â€.*â€œï¼Œç›¸å½“äºé€šé…ç¬¦ä¸­çš„â€*â€œã€‚
æ­£åˆ™ä¸­çš„â€.?â€ï¼Œç›¸å½“äºé€šé…ç¬¦ä¸­çš„â€?â€ã€‚</p>

<h3 id="move">move</h3>

<p>æŠŠå½“å‰æ•°æ®åº“çš„keyç§»åŠ¨åˆ°å…¶ä»–æ•°æ®åº“ä¸­</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>move

  MOVE key db
  summary: Move a key to another database
  since: 1.0.0
  group: generic
</code></pre></div></div>

<p>æŠŠå½“å‰æ•°æ®åº“ï¼ˆ0å·æ•°æ®åº“ï¼‰ä¸­çš„keyç§»åŠ¨åˆ°1å·æ•°æ®åº“</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
2<span class="o">)</span> <span class="s2">"hello1"</span>
3<span class="o">)</span> <span class="s2">"hello"</span>
10.10.10.221:6379&gt; move hello 1
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; <span class="k">select </span>1
OK
10.10.10.221:6379[1]&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"hello"</span>
10.10.10.221:6379[1]&gt; <span class="k">select </span>0
OK
10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
2<span class="o">)</span> <span class="s2">"hello1"</span>
</code></pre></div></div>

<h3 id="ttl">ttl</h3>

<p>time to liveã€‚æŸ¥çœ‹æŒ‡å®škeyçš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚keyçš„ç”Ÿå­˜æ—¶é—´åˆ°æœŸåï¼Œä¼šè‡ªåŠ¨é”€æ¯ã€‚
åº”ç”¨åœºæ™¯ï¼š
		redisæ˜¯åŸºäºå†…å­˜çš„æ•°æ®åº“ï¼Œæ•°æ®æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œå¦‚æœæŸä¸ªæ•°æ®åœ¨å†…å­˜ä¸­åªä½¿ç”¨ä¸€æ¬¡ä¹‹åå°±ä¸å†ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®ä¼šä¸€ç›´å ç”¨å†…å­˜ï¼Œæ¶ˆè€—å†…å­˜ï¼Œæ‰€ä»¥ä¸éœ€è¦çš„æ—¶å€™ï¼Œéœ€è¦åˆ é™¤è¿™ä¸ªæ•°æ®ã€‚
		å¦‚æœé€šè¿‡delå‘½ä»¤æ¥åˆ é™¤ï¼Œè¿˜éœ€è¦è¿æ•°æ®åº“ï¼›å¯ä»¥é€šè¿‡ttlçš„æ–¹å¼æ¥è‡ªåŠ¨åˆ é™¤è¿™ä¸ªæ•°æ®ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>ttl

  TTL key
  summary: Get the <span class="nb">time </span>to live <span class="k">for </span>a key
  since: 1.0.0
  group: generic
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
2<span class="o">)</span> <span class="s2">"hello1"</span>
10.10.10.221:6379&gt; ttl username
<span class="o">(</span>integer<span class="o">)</span> <span class="nt">-2</span>
10.10.10.221:6379&gt; ttl hello1
<span class="o">(</span>integer<span class="o">)</span> <span class="nt">-1</span>
</code></pre></div></div>

<p>è¿”å›å€¼ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(integer) -2	: æŒ‡å®šçš„keyä¸å­˜åœ¨
(integer) -1	: keyæ°¸ä¸è¿‡æœŸ
(integer) n		: è¿”å›å‰©ä½™çš„æœ‰æ•ˆæœŸä¸ºnç§’
</code></pre></div></div>

<h3 id="expire">expire</h3>

<p>è®¾ç½®keyçš„å­˜æ´»æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚ä»è®¾ç½®ä¹‹åå¼€å§‹è®¡æ—¶ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>expire

  EXPIRE key seconds
  summary: Set a key<span class="s1">'s time to live in seconds
  since: 1.0.0
  group: generic
</span></code></pre></div></div>

<p>å®ä¾‹ï¼šè®¾ç½®â€hello1â€çš„æœ‰æ•ˆæœŸä¸º20sï¼Œåœ¨20så†…ï¼Œâ€hello1â€ä¸€ç›´æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡ttlæŸ¥çœ‹â€hello1â€çš„å‰©ä½™æœ‰æ•ˆæœŸï¼Œ20sä¹‹åï¼Œåˆ é™¤â€hello1â€ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
2<span class="o">)</span> <span class="s2">"hello1"</span>
10.10.10.221:6379&gt; ttl hello1
<span class="o">(</span>integer<span class="o">)</span> <span class="nt">-1</span>
10.10.10.221:6379&gt; expire hello1 20
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; ttl hello1
<span class="o">(</span>integer<span class="o">)</span> 15
10.10.10.221:6379&gt; ttl hello1
<span class="o">(</span>integer<span class="o">)</span> <span class="nt">-2</span>
10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
</code></pre></div></div>

<h3 id="type">type</h3>

<p>æŸ¥çœ‹æŒ‡å®škeyçš„æ•°æ®ç±»å‹ã€‚
åº”ç”¨åœºæ™¯ï¼šæ¯”å¦‚æƒ³åœ¨æŒ‡å®škeyä¸Šæ·»åŠ æ•°æ®ï¼Œéœ€è¦å…ˆæŸ¥çœ‹æŒ‡å®škeyæ˜¯å“ªä¸€ç§æ•°æ®ç±»å‹ï¼ˆredisçš„keyæœ‰5ç§æ•°æ®ç±»å‹ï¼‰ï¼Œç„¶åæŒ‰ç…§æŸ¥è¯¢åˆ°çš„æ•°æ®ç±»å‹æ·»åŠ æ•°æ®ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help type

  </span>TYPE key
  summary: Determine the <span class="nb">type </span>stored at key
  since: 1.0.0
  group: generic
</code></pre></div></div>

<p>å®ä¾‹</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"myhello"</span>
10.10.10.221:6379&gt; <span class="nb">type </span>myhello
string
10.10.10.221:6379&gt; 
</code></pre></div></div>

<h3 id="rename">rename</h3>

<p>é‡å‘½åkey</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>rename

  RENAME key newkey
  summary: Rename a key
  since: 1.0.0
  group: generic
</code></pre></div></div>

<h2 id="redisäº”ç§æ•°æ®ç»“æ„">redisäº”ç§æ•°æ®ç»“æ„</h2>

<h2 id="3-stringç»„å¸¸è§å‘½ä»¤">3) stringç»„å¸¸è§å‘½ä»¤</h2>

<p>string: redisçš„æ•°æ®ç»“æ„
stringèƒ½å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ã€åºåˆ—åŒ–åçš„æ•°æ®ã€JsonåŒ–çš„å¯¹è±¡ã€ç”šè‡³å›¾ç‰‡ï¼Œæœ€å¤§512Mã€‚
ç‰¹ç‚¹ï¼šå•keyï¼Œå•value</p>

<table>
  <thead>
    <tr>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>username</td>
      <td>zhangsan</td>
    </tr>
  </tbody>
</table>

<p>stringç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @stringæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @string
</code></pre></div></div>

<h3 id="set">set</h3>

<p>è®¾ç½®å­—ç¬¦ä¸²çš„key-valueé”®å€¼å¯¹ã€‚
keyæ˜¯ç¨‹åºå‘˜è‡ªå·±å–çš„åå­—ï¼Œ<strong>valueæ˜¯ä¸šåŠ¡æ•°æ®ã€‚</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help set

  </span>SET key value <span class="o">[</span>EX seconds] <span class="o">[</span>PX milliseconds] <span class="o">[</span>NX|XX]
  summary: Set the string value of a key
  since: 1.0.0
  group: string
</code></pre></div></div>

<p>ç±»ä¼¼äºc/c++ä¸­</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span> <span class="n">zsname</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">=</span><span class="s">"zhangsan"</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">zsage</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>redis</th>
      <th>c/c++</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>key</td>
      <td>å˜é‡å(ç±»ä¼¼zsname[20])</td>
    </tr>
    <tr>
      <td>value</td>
      <td>å˜é‡å€¼(ç±»ä¼¼â€zhangsanâ€)</td>
    </tr>
    <tr>
      <td>rediså‡é‡‡ç”¨å­—ç¬¦ä¸²</td>
      <td>å˜é‡çš„æ•°æ®ç±»å‹(ç±»ä¼¼char)</td>
    </tr>
  </tbody>
</table>

<h3 id="get">get</h3>

<p>è·å–keyå¯¹åº”çš„value</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>get

  GET key
  summary: Get the value of a key
  since: 1.0.0
  group: string
</code></pre></div></div>

<h3 id="append">append</h3>

<p>å‘æŒ‡å®šçš„keyå¯¹åº”çš„valueè¿½åŠ å­—ç¬¦ä¸²ï¼Œè¿”å›è¿½åŠ ä¹‹åï¼Œæ€»çš„å­—ç¬¦é•¿åº¦ã€‚å¦‚æœkeyä¸å­˜åœ¨ï¼Œç›¸å½“äºåˆ›å»ºkey</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>append

  APPEND key value
  summary: Append a value to a key
  since: 2.0.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">set </span>phone 1338888
OK
10.10.10.221:6379&gt; get phone 
<span class="s2">"1338888"</span>
10.10.10.221:6379&gt; append phone 9999
<span class="o">(</span>integer<span class="o">)</span> 11
10.10.10.221:6379&gt; get phone
<span class="s2">"13388889999"</span>
</code></pre></div></div>

<h3 id="strlen">strlen</h3>

<p>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>strlen

  STRLEN key
  summary: Get the length of the value stored <span class="k">in </span>a key
  since: 2.2.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; get phone
<span class="s2">"13388889999"</span>
10.10.10.221:6379&gt; strlen phone
<span class="o">(</span>integer<span class="o">)</span> 11
</code></pre></div></div>

<h3 id="incr">incr</h3>

<p>keyå¯¹åº”çš„valueçš„å€¼åŠ 1ï¼Œè¿”å›+1ä¹‹åçš„å€¼ã€‚å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®keyçš„å€¼ä¸º0ï¼Œç„¶å+1ï¼Œå¾—åˆ°1ã€‚
åªèƒ½æ“ä½œæ•´å½¢çš„valueï¼Œéæ•´å½¢çš„valueä¼šæ“ä½œå¤±è´¥ï¼›</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>incr

  INCR key
  summary: Increment the integer value of a key by one
  since: 1.0.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">set </span>age 20
OK
10.10.10.221:6379&gt; <span class="nb">set </span>name zhangsan
OK
10.10.10.221:6379&gt; <span class="nb">set </span>score 85.7
OK
10.10.10.221:6379&gt; INCR age
<span class="o">(</span>integer<span class="o">)</span> 21
10.10.10.221:6379&gt; get age
<span class="s2">"21"</span>
10.10.10.221:6379&gt; INCR name
<span class="o">(</span>error<span class="o">)</span> ERR value is not an integer or out of range
10.10.10.221:6379&gt; INCR score
<span class="o">(</span>error<span class="o">)</span> ERR value is not an integer or out of range
</code></pre></div></div>

<h3 id="decr">decr</h3>

<p>keyå¯¹åº”çš„valueçš„å€¼å‡1ï¼Œè¿”å›-1ä¹‹åçš„å€¼ã€‚å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®keyçš„å€¼ä¸º0ï¼Œç„¶å-1ï¼Œå¾—åˆ°-1ã€‚
åªèƒ½æ“ä½œæ•´å½¢çš„valueï¼Œéæ•´å½¢çš„valueä¼šæ“ä½œå¤±è´¥ï¼›</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>decr

  DECR key
  summary: Decrement the integer value of a key by one
  since: 1.0.0
  group: string
</code></pre></div></div>

<h3 id="incrby">incrby</h3>

<p>keyå¯¹åº”çš„valueå¢åŠ ä¸€ä¸ªåç§»é‡</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>incrby

  INCRBY key increment
  summary: Increment the integer value of a key by the given amount
  since: 1.0.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; get age
<span class="s2">"20"</span>
10.10.10.221:6379&gt; INCRBY age 10
<span class="o">(</span>integer<span class="o">)</span> 30
10.10.10.221:6379&gt; INCRBY age <span class="nt">-10</span>
<span class="o">(</span>integer<span class="o">)</span> 20
</code></pre></div></div>

<h3 id="decrby">decrby</h3>

<p>keyå¯¹åº”çš„valueå‡å°‘ä¸€ä¸ªåç§»é‡</p>

<h3 id="getrange">getrange</h3>

<p>è·å–keyå¯¹åº”å­—ç¬¦ä¸²valueçš„å­ä¸²ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>getrange

  GETRANGE key start end
  summary: Get a substring of the string stored at a key
  since: 2.4.0
  group: string
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  startï¼šæŒ‡å®šèµ·å§‹ç´¢å¼•
  endï¼šæŒ‡å®šç»“æŸç´¢å¼•
  åŒºé—´: [start, end]
  ç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; get name
<span class="s2">"zhangsan"</span>
10.10.10.221:6379&gt; getrange name 2 5
<span class="s2">"angs"</span>
</code></pre></div></div>

<h3 id="setrange">setrange</h3>

<p>æŠŠä¸‹æ ‡offsetä¹‹ånä¸ªå­—ç¬¦æ›¿æ¢ä¸ºæ–°çš„å­ä¸²ï¼Œnä¸ºæ–°å­ä¸²çš„é•¿åº¦</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>setrange

  SETRANGE key offset value
  summary: Overwrite part of a string at key starting at the specified offset
  since: 2.2.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; get name
<span class="s2">"zhangsan"</span>
10.10.10.221:6379&gt; setrange name 4 liu
<span class="o">(</span>integer<span class="o">)</span> 8
10.10.10.221:6379&gt; get name
<span class="s2">"zhanliun"</span>
</code></pre></div></div>

<h3 id="setex">setex</h3>

<p>è®¾ç½®å€¼çš„åŒæ—¶ï¼Œè®¾ç½®æœ‰æ•ˆæœŸ</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>setex

  SETEX key seconds value
  summary: Set the value and expiration of a key
  since: 2.0.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; setex k2 10 v2
OK
10.10.10.221:6379&gt; ttl k2
<span class="o">(</span>integer<span class="o">)</span> 8
10.10.10.221:6379&gt; ttl k2
<span class="o">(</span>integer<span class="o">)</span> <span class="nt">-2</span>
</code></pre></div></div>

<p>å’Œexpireçš„åŒºåˆ«</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setexæ˜¯åŸå­æ“ä½œï¼Œè®¾ç½®å€¼çš„åŒæ—¶ï¼Œè®¾ç½®æœ‰æ•ˆæœŸã€‚
</code></pre></div></div>

<h3 id="setnx">setnx</h3>

<p>set not existã€‚å½“keyä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰è®¾ç½®</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>setnx

  SETNX key value
  summary: Set the value of a key, only <span class="k">if </span>the key does not exist
  since: 1.0.0
  group: string
</code></pre></div></div>

<p>å’Œsetçš„åŒºåˆ«</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setæ¯”è¾ƒæš´åŠ›ï¼Œä¼šç›´æ¥è¦†ç›–åŸæ¥çš„å€¼
setnxä¼šåˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ‰è®¾ç½®ï¼Œå¦åˆ™ï¼Œæ”¾å¼ƒè®¾ç½®
</code></pre></div></div>

<h3 id="mset">mset</h3>

<p>æ‰¹é‡è®¾ç½®é”®å€¼å¯¹</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>mset

  MSET key value <span class="o">[</span>key value ...]
  summary: Set multiple keys to multiple values
  since: 1.0.1
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; mset k1 v1 k2 v2 k3 v3
OK
10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"k2"</span>
2<span class="o">)</span> <span class="s2">"k1"</span>
3<span class="o">)</span> <span class="s2">"k3"</span>
</code></pre></div></div>

<h3 id="mget">mget</h3>

<p>æ‰¹é‡è·å–ç»™å®šä¸€ç»„keyçš„ä¸€ç»„value</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>mget

  MGET key <span class="o">[</span>key ...]
  summary: Get the values of all the given keys
  since: 1.0.0
  group: string
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"k2"</span>
2<span class="o">)</span> <span class="s2">"k1"</span>
3<span class="o">)</span> <span class="s2">"k3"</span>
10.10.10.221:6379&gt; mget k1 k2 k3 k4
1<span class="o">)</span> <span class="s2">"v1"</span>
2<span class="o">)</span> <span class="s2">"v2"</span>
3<span class="o">)</span> <span class="s2">"v3"</span>
4<span class="o">)</span> <span class="o">(</span>nil<span class="o">)</span>
</code></pre></div></div>

<h3 id="msetnx">msetnx</h3>

<p>æ‰¹é‡è®¾ç½®é”®å€¼å¯¹ã€‚å½“æ‰€æœ‰keyéƒ½ä¸å­˜åœ¨æ—¶ï¼Œæ‰èƒ½è®¾ç½®æˆåŠŸï¼Œå¦åˆ™ï¼Œåªè¦æœ‰ä¸€ä¸ªkeyå­˜åœ¨ï¼Œåˆ™æ”¾å¼ƒè®¾ç½®ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>msetnx

  MSETNX key value <span class="o">[</span>key value ...]
  summary: Set multiple keys to multiple values, only <span class="k">if </span>none of the keys exist
  since: 1.0.1
  group: string
</code></pre></div></div>

<h2 id="4-listç»„å¸¸è§å‘½ä»¤">4) listç»„å¸¸è§å‘½ä»¤</h2>

<p>list: redisçš„åŸºæœ¬æ•°æ®ç»“æ„ã€‚
listæ˜¯æœ€ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œé»˜è®¤æŒ‰ç…§<strong>æ’å…¥å…ˆåé¡ºåºæ’åº</strong>ï¼Œè¿˜å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ã€å°¾éƒ¨ã€ä¸­é—´ï¼Œåº•å±‚æ˜¯ä¸ªé“¾è¡¨ç»“æ„ã€‚åˆ—è¡¨æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡ç´¢å¼•æ¥æ“ä½œlistä¸­çš„æ•°æ®ã€‚
ç‰¹ç‚¹ï¼šå•keyï¼Œå¤švalue
<strong>é¡ºåºï¼šæŒ‰æ’å…¥ä½ç½®æ’åº</strong>
<strong>è¡¨å¤´ï¼šåœ¨åˆ—è¡¨çš„å·¦ä¾§left</strong>
<strong>è¡¨å°¾ï¼šåœ¨åˆ—è¡¨çš„å³ä¾§right</strong>ã€</p>

<p>å®ä¾‹ï¼Œå°¾éƒ¨ä¾æ¬¡æ’å…¥beijingã€shanghaiã€tianjinã€chongqingï¼Œæ­¤æ—¶æŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚</p>

<table>
  <thead>
    <tr>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>city</td>
      <td>beijing  shanghai   tianjin   chongqing</td>
    </tr>
  </tbody>
</table>

<p>listç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @listæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @list
</code></pre></div></div>

<h3 id="lpush">lpush</h3>

<p>lpush -&gt; left pushã€‚å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ä¾æ¬¡æ’å…¥åˆ°listçš„è¡¨å¤´æˆ–å·¦ä¾§ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>lpush

  LPUSH key value <span class="o">[</span>value ...]
  summary: Prepend one or multiple values to a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
10.10.10.221:6379&gt; lpush listk v1 v2 v3 v4
<span class="o">(</span>integer<span class="o">)</span> 4
</code></pre></div></div>

<p>åœ¨listkåˆ—è¡¨çš„è¡¨å¤´(å·¦ä¾§)ä¾æ¬¡æ’å…¥v1ã€v2ã€v3ã€v4ï¼Œç°åœ¨è¡¨å¤´çš„ç¬¬ä¸€ä¸ªæ•°æ®å°±æ˜¯v4</p>

<h3 id="lrange">lrange</h3>

<p>lrange -&gt; list rangeã€‚è·å–æŒ‡å®šåˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>lrange

  LRANGE key start stop
  summary: Get a range of elements from a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; lpush listk v1 v2 v3 v4
<span class="o">(</span>integer<span class="o">)</span> 4
10.10.10.221:6379&gt; lrange listk 0 2
1<span class="o">)</span> <span class="s2">"v4"</span>
2<span class="o">)</span> <span class="s2">"v3"</span>
3<span class="o">)</span> <span class="s2">"v2"</span>
10.10.10.221:6379&gt; lpush listk v5 v6 v7
<span class="o">(</span>integer<span class="o">)</span> 7
10.10.10.221:6379&gt; lrange listk 0 2
1<span class="o">)</span> <span class="s2">"v7"</span>
2<span class="o">)</span> <span class="s2">"v6"</span>
3<span class="o">)</span> <span class="s2">"v5"</span>
10.10.10.221:6379&gt; LRANGE listk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"v7"</span>
2<span class="o">)</span> <span class="s2">"v6"</span>
3<span class="o">)</span> <span class="s2">"v5"</span>
4<span class="o">)</span> <span class="s2">"v4"</span>
5<span class="o">)</span> <span class="s2">"v3"</span>
6<span class="o">)</span> <span class="s2">"v2"</span>
7<span class="o">)</span> <span class="s2">"v1"</span>
</code></pre></div></div>

<p>ç¬¬ä¸€æ¬¡åœ¨åˆ—è¡¨listkä¸­lpushä¾æ¬¡æ’å…¥v1 v2 v3 v4æ—¶ï¼Œv4æ˜¯è¡¨å¤´ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ•°æ®ï¼›
ç¬¬äºŒæ¬¡åœ¨åˆ—è¡¨listkä¸­lpushä¾æ¬¡æ’å…¥v5 v6 v7æ—¶ï¼Œv7æ˜¯è¡¨å¤´ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ•°æ®ï¼›</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lrange key start stop
start:åˆ—è¡¨çš„å¼€å§‹ä¸‹æ ‡ç´¢å¼•
stop:åˆ—è¡¨çš„ç»“æŸä¸‹æ ‡ç´¢å¼•
åŒºé—´: [start, stop]
æ”¯æŒä¸‹æ ‡ç´¢å¼•ä¸ºè´Ÿ
</code></pre></div></div>

<h3 id="rpush">rpush</h3>

<p>rpush -&gt; right pushã€‚å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ä¾æ¬¡æ’å…¥åˆ°listçš„è¡¨å°¾æˆ–å³ä¾§ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>rpush

  RPUSH key value <span class="o">[</span>value ...]
  summary: Append one or multiple values to a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; rpush listk v8 v9
<span class="o">(</span>integer<span class="o">)</span> 9
10.10.10.221:6379&gt; lrange listk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"v7"</span>
2<span class="o">)</span> <span class="s2">"v6"</span>
3<span class="o">)</span> <span class="s2">"v5"</span>
4<span class="o">)</span> <span class="s2">"v4"</span>
5<span class="o">)</span> <span class="s2">"v3"</span>
6<span class="o">)</span> <span class="s2">"v2"</span>
7<span class="o">)</span> <span class="s2">"v1"</span>
8<span class="o">)</span> <span class="s2">"v8"</span>
9<span class="o">)</span> <span class="s2">"v9"</span>
</code></pre></div></div>

<h3 id="lpop">lpop</h3>

<p>ä»listè¡¨å¤´åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤çš„å…ƒç´ </p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>lpop

  LPOP key
  summary: Remove and get the first element <span class="k">in </span>a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<h3 id="rpop">rpop</h3>

<p>ä»listè¡¨å°¾åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤çš„å…ƒç´ </p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>rpop

  RPOP key
  summary: Remove and get the last element <span class="k">in </span>a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<h3 id="lindex">lindex</h3>

<p>è·å–liståˆ—è¡¨æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ </p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>lindex

  LINDEX key index
  summary: Get an element from a list by its index
  since: 1.0.0
  group: list
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; lrange listk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"v7"</span>
2<span class="o">)</span> <span class="s2">"v6"</span>
3<span class="o">)</span> <span class="s2">"v5"</span>
4<span class="o">)</span> <span class="s2">"v4"</span>
5<span class="o">)</span> <span class="s2">"v3"</span>
6<span class="o">)</span> <span class="s2">"v2"</span>
7<span class="o">)</span> <span class="s2">"v1"</span>
8<span class="o">)</span> <span class="s2">"v8"</span>
9<span class="o">)</span> <span class="s2">"v9"</span>
10.10.10.221:6379&gt; lindex listk 4
<span class="s2">"v3"</span>
</code></pre></div></div>

<h3 id="llen">llen</h3>

<p>llen -&gt; list lengthã€‚è·å–liståˆ—è¡¨çš„é•¿åº¦</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>llen

  LLEN key
  summary: Get the length of a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; llen listk
<span class="o">(</span>integer<span class="o">)</span> 9
10.10.10.221:6379&gt; lrange listk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"v7"</span>
2<span class="o">)</span> <span class="s2">"v6"</span>
3<span class="o">)</span> <span class="s2">"v5"</span>
4<span class="o">)</span> <span class="s2">"v4"</span>
5<span class="o">)</span> <span class="s2">"v3"</span>
6<span class="o">)</span> <span class="s2">"v2"</span>
7<span class="o">)</span> <span class="s2">"v1"</span>
8<span class="o">)</span> <span class="s2">"v8"</span>
9<span class="o">)</span> <span class="s2">"v9"</span>
</code></pre></div></div>

<h3 id="lrem">lrem</h3>

<p>ä»liståˆ—è¡¨ä¸­åˆ é™¤å…ƒç´ </p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>lrem

  LREM key count value
  summary: Remove elements from a list
  since: 1.0.0
  group: list
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lrem key count value
count <span class="o">&gt;</span> 0: ä»è¡¨å¤´å‘è¡¨å°¾å¼€å§‹ï¼Œåˆ é™¤countä¸ªå€¼ä¸valueç›¸ç­‰çš„å…ƒç´ 
count &lt; 0: ä»è¡¨å°¾å‘è¡¨å¤´å¼€å§‹ï¼Œåˆ é™¤|count|ä¸ªå€¼ä¸valueç›¸ç­‰çš„å…ƒç´ 
count <span class="o">=</span> 0: åˆ é™¤æ‰€æœ‰å€¼ä¸valueç›¸ç­‰çš„å…ƒç´ 
countçš„æ­£è´Ÿå·ï¼Œå†³å®šäº†åˆ é™¤çš„æ–¹å‘ï¼Œcountçš„ç»å¯¹å€¼ï¼Œå†³å®šäº†åˆ é™¤çš„ä¸ªæ•°
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; lrange listk 0 <span class="nt">-1</span>
 1<span class="o">)</span> <span class="s2">"v1"</span>
 2<span class="o">)</span> <span class="s2">"v2"</span>
 3<span class="o">)</span> <span class="s2">"v3"</span>
 4<span class="o">)</span> <span class="s2">"v1"</span>
 5<span class="o">)</span> <span class="s2">"v2"</span>
 6<span class="o">)</span> <span class="s2">"v3"</span>
 7<span class="o">)</span> <span class="s2">"v1"</span>
 8<span class="o">)</span> <span class="s2">"v2"</span>
 9<span class="o">)</span> <span class="s2">"v3"</span>
10<span class="o">)</span> <span class="s2">"v1"</span>
11<span class="o">)</span> <span class="s2">"v2"</span>
12<span class="o">)</span> <span class="s2">"v3"</span>
10.10.10.221:6379&gt; lrem listk <span class="nt">-2</span> v2
<span class="o">(</span>integer<span class="o">)</span> 2
10.10.10.221:6379&gt; lrange listk 0 <span class="nt">-1</span>
 1<span class="o">)</span> <span class="s2">"v1"</span>
 2<span class="o">)</span> <span class="s2">"v2"</span>
 3<span class="o">)</span> <span class="s2">"v3"</span>
 4<span class="o">)</span> <span class="s2">"v1"</span>
 5<span class="o">)</span> <span class="s2">"v2"</span>
 6<span class="o">)</span> <span class="s2">"v3"</span>
 7<span class="o">)</span> <span class="s2">"v1"</span>
 8<span class="o">)</span> <span class="s2">"v3"</span>
 9<span class="o">)</span> <span class="s2">"v1"</span>
10<span class="o">)</span> <span class="s2">"v3"</span>
</code></pre></div></div>

<h2 id="5-setç»„å¸¸è§å‘½ä»¤">5) setç»„å¸¸è§å‘½ä»¤</h2>

<p>set: redisçš„åŸºæœ¬æ•°æ®ç»“æ„ã€‚
setæ˜¯å­—ç¬¦ä¸²é›†åˆï¼Œæ˜¯æ— åºçš„ã€æ— é‡å¤çš„é›†åˆï¼Œä¸æ’å…¥å…ˆåé¡ºåºæ— å…³ã€‚
<strong>é¡ºåºï¼šæ— åº</strong></p>

<p>setç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @setæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @set
</code></pre></div></div>

<h3 id="sadd">sadd</h3>

<p>æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ°æŒ‡å®šseté›†åˆä¸­</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>sadd

  SADD key member <span class="o">[</span>member ...]
  summary: Add one or more members to a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; sadd setk s1 s2 s3 s4
<span class="o">(</span>integer<span class="o">)</span> 4
10.10.10.221:6379&gt; scard setk
<span class="o">(</span>integer<span class="o">)</span> 4
10.10.10.221:6379&gt; smembers setk
1<span class="o">)</span> <span class="s2">"s1"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s2"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
</code></pre></div></div>

<h3 id="scard">scard</h3>

<p>è·å–seté›†åˆçš„å…ƒç´ ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>scard

  SCARD key
  summary: Get the number of members <span class="k">in </span>a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<h3 id="smembers">smembers</h3>

<p>æŸ¥çœ‹seté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>smembers

  SMEMBERS key
  summary: Get all the members <span class="k">in </span>a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<h3 id="srem">srem</h3>

<p>åˆ é™¤seté›†åˆä¸­çš„å¤šä¸ªå…ƒç´ ï¼Œè¿”å›æˆåŠŸåˆ é™¤çš„ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>srem

  SREM key member <span class="o">[</span>member ...]
  summary: Remove one or more members from a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<h3 id="srandmember">srandmember</h3>

<p>éšæœºè¿”å›seté›†åˆä¸­çš„countä¸ªå…ƒç´ ã€‚
count &gt; 0:è¿”å›countä¸ªä¸ç›¸åŒçš„å…ƒç´ ï¼Œç±»ä¼¼ä¸æ”¾å›æŠ½æ ·
count &lt;0: è¿”å›countä¸ªå…ƒç´ ï¼Œç±»ä¼¼æ”¾å›æŠ½æ ·ï¼Œæ‰€ä»¥ï¼Œå¯èƒ½å­˜åœ¨é‡å¤çš„å…ƒç´ ã€‚
åº”ç”¨ï¼šæ¯”å¦‚æŠ½å¥–æ´»åŠ¨ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>srandmember

  SRANDMEMBER key <span class="o">[</span>count]
  summary: Get one or multiple random members from a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<h3 id="spop">spop</h3>

<p>ä»seté›†åˆä¸­éšæœºåˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤çš„å…ƒç´ ã€‚
åº”ç”¨ï¼šæŠ½å¥–æ´»åŠ¨ï¼Œæ¯äººæœ€å¤šæŠ½ä¸€æ¬¡ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>spop

  SPOP key <span class="o">[</span>count]
  summary: Remove and <span class="k">return </span>one or multiple random members from a <span class="nb">set
  </span>since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spopå’ŒsremåŒºåˆ«
sremæ˜¯æŒ‰ç…§valueæ¥åˆ é™¤member
spopæ˜¯éšæœºåˆ é™¤member
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; smembers setk
1<span class="o">)</span> <span class="s2">"s6"</span>
2<span class="o">)</span> <span class="s2">"s2"</span>
3<span class="o">)</span> <span class="s2">"s4"</span>
4<span class="o">)</span> <span class="s2">"s5"</span>
5<span class="o">)</span> <span class="s2">"s3"</span>
6<span class="o">)</span> <span class="s2">"s1"</span>
10.10.10.221:6379&gt; spop setk 2
1<span class="o">)</span> <span class="s2">"s1"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
</code></pre></div></div>

<h3 id="sinter">sinter</h3>

<p>è·å–å¤šä¸ªseté›†åˆçš„äº¤é›†ã€‚$set1 \cap set2 \cap set3 \cap â€¦$</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>sinter

  SINTER key <span class="o">[</span>key ...]
  summary: Intersect multiple sets
  since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; smembers setk
1<span class="o">)</span> <span class="s2">"s6"</span>
2<span class="o">)</span> <span class="s2">"s2"</span>
3<span class="o">)</span> <span class="s2">"s5"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set1
1<span class="o">)</span> <span class="s2">"s1"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s2"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set2
1<span class="o">)</span> <span class="s2">"s5"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; sinter setk set1 set2
1<span class="o">)</span> <span class="s2">"s3"</span>
</code></pre></div></div>

<h3 id="sunion">sunion</h3>

<p>è·å–å¤šä¸ªseté›†åˆçš„å¹¶é›†ã€‚$ set1 \cup set2 \cup set3 \cup â€¦$</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>sunion

  SUNION key <span class="o">[</span>key ...]
  summary: Add multiple sets
  since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; smembers setk
1<span class="o">)</span> <span class="s2">"s6"</span>
2<span class="o">)</span> <span class="s2">"s2"</span>
3<span class="o">)</span> <span class="s2">"s5"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set1
1<span class="o">)</span> <span class="s2">"s1"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s2"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set2
1<span class="o">)</span> <span class="s2">"s5"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; sunion setk set1 set2
1<span class="o">)</span> <span class="s2">"s6"</span>
2<span class="o">)</span> <span class="s2">"s2"</span>
3<span class="o">)</span> <span class="s2">"s5"</span>
4<span class="o">)</span> <span class="s2">"s4"</span>
5<span class="o">)</span> <span class="s2">"s3"</span>
6<span class="o">)</span> <span class="s2">"s1"</span>
</code></pre></div></div>

<h3 id="sdiff">sdiff</h3>

<p>ç¬¬ä¸€ä¸ªseté›†åˆå‡å»å…¶ä»–é›†åˆçš„ç»“æœï¼Œå·®é›†ã€‚$set1 - set2 -set3 - â€¦ = set1 - (set2 \cup set3 \cup â€¦)$</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>sdiff

  SDIFF key <span class="o">[</span>key ...]
  summary: Subtract multiple sets
  since: 1.0.0
  group: <span class="nb">set</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; smembers setk
1<span class="o">)</span> <span class="s2">"s6"</span>
2<span class="o">)</span> <span class="s2">"s2"</span>
3<span class="o">)</span> <span class="s2">"s5"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set1
1<span class="o">)</span> <span class="s2">"s1"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s2"</span>
4<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; smembers set2
1<span class="o">)</span> <span class="s2">"s5"</span>
2<span class="o">)</span> <span class="s2">"s4"</span>
3<span class="o">)</span> <span class="s2">"s3"</span>
10.10.10.221:6379&gt; sdiff setk set1 set2
1<span class="o">)</span> <span class="s2">"s6"</span>
</code></pre></div></div>

<h2 id="hashç»„å¸¸è§å‘½ä»¤">hashç»„å¸¸è§å‘½ä»¤</h2>

<p>hash: redisçš„åŸºæœ¬æ•°æ®ç»“æ„
hashæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„filedå’Œvalueçš„æ˜ å°„è¡¨ï¼Œç‰¹åˆ«é€‚åˆå­˜å‚¨structç»“æ„ä½“å¯¹è±¡ã€‚
key field1 value1 field2 value2 â€¦.</p>

<table>
  <thead>
    <tr>
      <th>key</th>
      <th>field:value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>person</td>
      <td>name:zhangsan age:20 sex:girl  height:170</td>
    </tr>
  </tbody>
</table>

<p>ç±»ä¼¼äºc/c++ç»“æ„ä½“</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Person</span> <span class="p">{</span>
  <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
  <span class="n">string</span> <span class="n">age</span><span class="p">;</span>
  <span class="n">string</span> <span class="n">sex</span><span class="p">;</span>
  <span class="n">string</span> <span class="n">height</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Person</span> <span class="n">person</span><span class="p">{</span><span class="s">"zhangsan"</span><span class="p">,</span> <span class="s">"20"</span><span class="p">,</span> <span class="s">"girl"</span><span class="p">,</span> <span class="s">"height"</span><span class="p">};</span>
</code></pre></div></div>

<p>hashç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @hashæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @hash
</code></pre></div></div>

<h3 id="hset">hset</h3>

<p>è®¾ç½®hashè¡¨çš„fieldå’Œvalue</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hset

  HSET key field value
  summary: Set the string value of a <span class="nb">hash </span>field
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; hset hashk f1 v1 f2 v2
<span class="o">(</span>integer<span class="o">)</span> 2
</code></pre></div></div>

<h3 id="hget">hget</h3>

<p>è·å–hashè¡¨ä¸­æŒ‡å®šfieldçš„value</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hget

  HGET key field
  summary: Get the value of a <span class="nb">hash </span>field
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hmset">hmset</h3>

<p>æ‰¹é‡è®¾ç½®hashè¡¨çš„å¤šç»„filedå’Œvalueã€‚å®é™…ä¸Šhsetä¹Ÿå¯ä»¥æ‰¹é‡è®¾ç½®ï¼Œä¸¤è€…æ²¡æœ‰åŒºåˆ«ã€‚<strong>å®˜æ–¹ç»™å‡ºï¼šhmsetè¢«å¼ƒç”¨ã€‚</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hmset

  HMSET key field value <span class="o">[</span>field value ...]
  summary: Set multiple <span class="nb">hash </span>fields to multiple values
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hmget">hmget</h3>

<p>æ‰¹é‡è·å–hashè¡¨ä¸­å¤šä¸ªfieldçš„å¤šä¸ªvalueã€‚hgetä¸€æ¬¡åªèƒ½è·å–ä¸€ä¸ªvalueã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hmget

  HMGET key field <span class="o">[</span>field ...]
  summary: Get the values of all the given <span class="nb">hash </span>fields
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hgetall">hgetall</h3>

<p>è·å–hashè¡¨ä¸­æ‰€æœ‰çš„fieldså’Œvalues</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hgetall

  HGETALL key
  summary: Get all the fields and values <span class="k">in </span>a <span class="nb">hash
  </span>since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; hgetall hashk
1<span class="o">)</span> <span class="s2">"f1"</span>
2<span class="o">)</span> <span class="s2">"v1"</span>
3<span class="o">)</span> <span class="s2">"f2"</span>
4<span class="o">)</span> <span class="s2">"v2"</span>
5<span class="o">)</span> <span class="s2">"f3"</span>
6<span class="o">)</span> <span class="s2">"v3"</span>
</code></pre></div></div>

<h3 id="hdel">hdel</h3>

<p>åˆ é™¤hashè¡¨çš„å¤šä¸ªæˆå¯¹çš„filedå’Œvalue</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hdel

  HDEL key field <span class="o">[</span>field ...]
  summary: Delete one or more <span class="nb">hash </span>fields
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hlen">hlen</h3>

<p>è·å–hashè¡¨ä¸­filedçš„ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hlen

  HLEN key
  summary: Get the number of fields <span class="k">in </span>a <span class="nb">hash
  </span>since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hexists">hexists</h3>

<p>åˆ¤æ–­hashè¡¨ä¸­æŒ‡å®šçš„fieldæ˜¯å¦å­˜åœ¨</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hexists

  HEXISTS key field
  summary: Determine <span class="k">if </span>a <span class="nb">hash </span>field exists
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hkeys">hkeys</h3>

<p>è·å–hashè¡¨ä¸­æ‰€æœ‰çš„fields</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hkeys

  HKEYS key
  summary: Get all the fields <span class="k">in </span>a <span class="nb">hash
  </span>since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hvals">hvals</h3>

<p>è·å–hashè¡¨ä¸­æ‰€æœ‰çš„values</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hvals

  HVALS key
  summary: Get all the values <span class="k">in </span>a <span class="nb">hash
  </span>since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h3 id="hincrby">hincrby</h3>

<p>ç»™hashè¡¨ä¸­æŒ‡å®šfieldçš„æ•´æ•°valueå¢åŠ ä¸€ä¸ªæ•´æ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hincrby

  HINCRBY key field increment
  summary: Increment the integer value of a <span class="nb">hash </span>field by the given number
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; hset hashk age 20
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; hincrby hashk age 5
<span class="o">(</span>integer<span class="o">)</span> 25
10.10.10.221:6379&gt; hget hashk age
<span class="s2">"25"</span>
10.10.10.221:6379&gt; 
</code></pre></div></div>

<h3 id="hincrbyfloat">hincrbyfloat</h3>

<p>ç»™hashè¡¨ä¸­æŒ‡å®šfieldçš„æµ®ç‚¹æ•°valueå¢åŠ ä¸€ä¸ªæµ®ç‚¹æ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hincrbyfloat

  HINCRBYFLOAT key field increment
  summary: Increment the float value of a <span class="nb">hash </span>field by the given amount
  since: 2.6.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; hset hashk height 1.72
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; hincrbyfloat hashk height 0.21
<span class="s2">"1.93"</span>
10.10.10.221:6379&gt; hgetall hashk
1<span class="o">)</span> <span class="s2">"age"</span>
2<span class="o">)</span> <span class="s2">"25"</span>
3<span class="o">)</span> <span class="s2">"height"</span>
4<span class="o">)</span> <span class="s2">"1.93"</span>
</code></pre></div></div>

<h3 id="hsetnx">hsetnx</h3>

<p>ç»™hashè¡¨æ·»åŠ field-valueå¯¹ï¼Œå¦‚æœfieldå·²ç»å­˜åœ¨ï¼Œåˆ™æ·»åŠ å¤±è´¥ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>hsetnx

  HSETNX key field value
  summary: Set the value of a <span class="nb">hash </span>field, only <span class="k">if </span>the field does not exist
  since: 2.0.0
  group: <span class="nb">hash</span>
</code></pre></div></div>

<h2 id="sorted_setç»„å¸¸è§å‘½ä»¤">sorted_setç»„å¸¸è§å‘½ä»¤</h2>

<p>sorted_seté¦–å­—æ¯ä¸ºsï¼Œ(ç›¸åº”çš„æ“ä½œæŒ‰ç†è¯´åº”è¯¥æ˜¯så¼€å¤´)ï¼Œä¸setçš„så†²çªï¼Œæ‰€ä»¥æœ‰äº†zsetçš„åå­—ã€‚
zsetæ˜¯æœ‰åºæ— é‡å¤çš„é›†åˆï¼Œä»‹äºsetå’Œlistä¹‹é—´ï¼Œzsetç›¸å…³çš„å‘½ä»¤ç»“åˆäº†setå’Œlistçš„å‘½ä»¤ã€‚
zsetçš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆåˆ†æ•°å¯ä»¥é‡å¤ï¼‰ï¼Œredisé€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„é¡ºåºæ¥æ’åºã€‚</p>

<p><strong>é¡ºåºï¼šæŒ‰ç…§åˆ†æ•°æ’åºï¼Œå…ƒç´ å¯ä»¥æœ‰ä¸‹æ ‡ç´¢å¼•</strong>
<strong>æœ¬è´¨ï¼šæ˜¯seté›†åˆï¼Œå…ƒç´ ä¸èƒ½é‡å¤</strong></p>

<p>å®ä¾‹ï¼škeyæ˜¯åˆ†æ•°scoreï¼Œå…ˆåæ’å…¥zhangsan 80åˆ†ï¼Œlisi 75åˆ†ï¼Œwangwu 90åˆ†ã€‚</p>

<table>
  <thead>
    <tr>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>score</td>
      <td>zhangsan 80<br />lisi              75<br />wangwu   90</td>
    </tr>
  </tbody>
</table>

<p>æ’å…¥åå®é™…æ’åºï¼ŒæŒ‰ç…§åˆ†æ•°ä»å°åˆ°å¤§æ¥æ’åºã€‚</p>

<table>
  <thead>
    <tr>
      <th>key</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>score</td>
      <td>lisi              75<br />zhangsan 80<br />wangwu   90</td>
    </tr>
  </tbody>
</table>

<p>sorted_setç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @sorted_setæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @sorted_set
</code></pre></div></div>

<h3 id="zadd">zadd</h3>

<p>å‘zseté›†åˆä¸­æ·»åŠ å¤šç»„å…ƒç´ åŠå¯¹åº”çš„åˆ†æ•°ï¼Œå¦‚æœå…ƒç´ å­˜åœ¨ï¼Œåˆ™æ›´æ–°å…ƒç´ çš„åˆ†æ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zadd

  ZADD key <span class="o">[</span>NX|XX] <span class="o">[</span>CH] <span class="o">[</span>INCR] score member <span class="o">[</span>score member ...]
  summary: Add one or more members to a sorted <span class="nb">set</span>, or update its score <span class="k">if </span>it already exists
  since: 1.2.0
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zadd zsetk 50 zhangsan 40 wangwu 60 zhangliu
<span class="o">(</span>integer<span class="o">)</span> 3
10.10.10.221:6379&gt; zrange zsetk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"wangwu"</span>
2<span class="o">)</span> <span class="s2">"zhangsan"</span>
3<span class="o">)</span> <span class="s2">"zhangliu"</span>
</code></pre></div></div>

<h3 id="zcard">zcard</h3>

<p>è·å–zseté›†åˆçš„å…ƒç´ ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zcard

  ZCARD key
  summary: Get the number of members <span class="k">in </span>a sorted <span class="nb">set
  </span>since: 1.2.0
  group: sorted_set
</code></pre></div></div>

<h3 id="zcount">zcount</h3>

<p>ç»Ÿè®¡zseté›†åˆä¸­æŒ‡å®šåˆ†æ•°åŒºé—´çš„å…ƒç´ ä¸ªæ•°ï¼Œé—­åŒºé—´[min, max]</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zcount

  ZCOUNT key min max
  summary: Count the members <span class="k">in </span>a sorted <span class="nb">set </span>with scores within the given values
  since: 2.0.0
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zcount zsetk 45 55
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt;
</code></pre></div></div>

<h3 id="zincrby">zincrby</h3>

<p>å¢åŠ zseté›†åˆä¸­æŒ‡å®šå…ƒç´ çš„åˆ†æ•°ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zincrby

  ZINCRBY key increment member
  summary: Increment the score of a member <span class="k">in </span>a sorted <span class="nb">set
  </span>since: 1.2.0
  group: sorted_set
</code></pre></div></div>

<h3 id="zrange">zrange</h3>

<p>è¿”å›zseté›†åˆä¸­æŒ‡å®šç´¢å¼•åŒºé—´çš„å…ƒç´ ï¼Œé—­åŒºé—´[start, stop]</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zrange

  ZRANGE key start stop <span class="o">[</span>WITHSCORES]
  summary: Return a range of members <span class="k">in </span>a sorted <span class="nb">set</span>, by index
  since: 1.2.0
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zrange zsetk 0 <span class="nt">-1</span>
1<span class="o">)</span> <span class="s2">"wangwu"</span>
2<span class="o">)</span> <span class="s2">"zhangliu"</span>
3<span class="o">)</span> <span class="s2">"zhangsan"</span>
10.10.10.221:6379&gt; zrange zsetk 0 <span class="nt">-1</span> withscores
1<span class="o">)</span> <span class="s2">"wangwu"</span>
2<span class="o">)</span> <span class="s2">"40"</span>
3<span class="o">)</span> <span class="s2">"zhangliu"</span>
4<span class="o">)</span> <span class="s2">"60"</span>
5<span class="o">)</span> <span class="s2">"zhangsan"</span>
6<span class="o">)</span> <span class="s2">"80"</span>
</code></pre></div></div>

<p>zrangeå’ŒzcountåŒºåˆ«ï¼š</p>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>zrange</th>
      <th>zcount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>åŒºé—´</td>
      <td>ä¸‹æ ‡ç´¢å¼•åŒºé—´</td>
      <td>åˆ†æ•°åŒºé—´</td>
    </tr>
    <tr>
      <td>è¿”å›å€¼</td>
      <td>è¿”å›å…ƒç´ (åŠåˆ†æ•°)</td>
      <td>è¿”å›å…ƒç´ çš„ä¸ªæ•°</td>
    </tr>
  </tbody>
</table>

<h3 id="zrangebyscore">zrangebyscore</h3>

<p>è¿”å›zseté›†åˆä¸­æŒ‡å®šåˆ†æ•°åŒºé—´çš„å…ƒç´ ï¼Œé—­åŒºé—´[min, max]</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zrangebyscore

  ZRANGEBYSCORE key min max <span class="o">[</span>WITHSCORES] <span class="o">[</span>LIMIT offset count]
  summary: Return a range of members <span class="k">in </span>a sorted <span class="nb">set</span>, by score
  since: 1.0.5
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zrangebyscore zsetk 40 60 
1<span class="o">)</span> <span class="s2">"wangwu"</span>
2<span class="o">)</span> <span class="s2">"zhangliu"</span>
10.10.10.221:6379&gt; zrangebyscore zsetk 40 60 withscores
1<span class="o">)</span> <span class="s2">"wangwu"</span>
2<span class="o">)</span> <span class="s2">"40"</span>
3<span class="o">)</span> <span class="s2">"zhangliu"</span>
4<span class="o">)</span> <span class="s2">"60"</span>
</code></pre></div></div>

<h3 id="zrem">zrem</h3>

<p>åˆ é™¤zseté›†åˆä¸­çš„å¤šä¸ªå…ƒç´ ï¼Œè¿”å›æˆåŠŸåˆ é™¤çš„ä¸ªæ•°</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zrem

  ZREM key member <span class="o">[</span>member ...]
  summary: Remove one or more members from a sorted <span class="nb">set
  </span>since: 1.2.0
  group: sorted_set

</code></pre></div></div>

<h3 id="zrank">zrank</h3>

<p>è·å–zseté›†åˆä¸­æŒ‡å®šå…ƒç´ çš„æ’å(æ’åä»0å¼€å§‹)ï¼Œæ’åæ˜¯æŒ‰ç…§åˆ†æ•°ä»å°åˆ°å¤§æ’åºçš„ã€‚æ‰€ä»¥åˆ†æ•°è¶Šä½ï¼Œæ’åè¶Šé å‰ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zrank

  ZRANK key member
  summary: Determine the index of a member <span class="k">in </span>a sorted <span class="nb">set
  </span>since: 2.0.0
  group: sorted_set
</code></pre></div></div>

<h3 id="zscore">zscore</h3>

<p>è·å–zseté›†åˆä¸­æŒ‡å®šå…ƒç´ çš„åˆ†æ•°ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zscore

  ZSCORE key member
  summary: Get the score associated with the given member <span class="k">in </span>a sorted <span class="nb">set
  </span>since: 1.2.0
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zscore zsetk zhangsan
<span class="s2">"80"</span>
</code></pre></div></div>

<h3 id="zrevrank">zrevrank</h3>

<p>è·å–zseté›†åˆä¸­æŒ‡å®šå…ƒç´ çš„æ’å(æ’åä»0å¼€å§‹)ï¼Œåå‘æ’åï¼Œä¹Ÿå°±æ˜¯åˆ†æ•°ä»å¤§åˆ°å°æ’åã€‚æ‰€ä»¥åˆ†æ•°è¶Šé«˜ï¼Œæ’åè¶Šé å‰ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>zrevrank

  ZREVRANK key member
  summary: Determine the index of a member <span class="k">in </span>a sorted <span class="nb">set</span>, with scores ordered from high to low
  since: 2.0.0
  group: sorted_set
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; zrank zsetk zhangsan
<span class="o">(</span>integer<span class="o">)</span> 4
10.10.10.221:6379&gt; zrevrank zsetk zhangsan
<span class="o">(</span>integer<span class="o">)</span> 0
</code></pre></div></div>

<h1 id="redisé…ç½®æ–‡ä»¶">Redisé…ç½®æ–‡ä»¶</h1>

<h2 id="0-é…ç½®çš„æ›´æ”¹">0) é…ç½®çš„æ›´æ”¹</h2>

<p>æ–¹å¼1ï¼šé€šè¿‡å‘½ä»¤æ¥æ›´æ”¹é…ç½®ï¼šconfig setã€‚æ›´æ”¹åä»ä¸‹æ¡æŒ‡ä»¤ç”Ÿæ•ˆã€‚
<strong>ä¸æ˜¯æ‰€æœ‰çš„å‚æ•°éƒ½èƒ½é€šè¿‡config setæ¥é…ç½®ã€‚</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>config <span class="nb">set

  </span>CONFIG SET parameter value
  summary: Set a configuration parameter to the given value
  since: 2.0.0
  group: server
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; config <span class="nb">set </span>port 6969
</code></pre></div></div>

<p>æ–¹å¼2ï¼šé€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶å¹¶é‡å¯redisæœåŠ¡æ¥æ›´æ”¹ã€‚</p>

<h2 id="1-redis-è¿æ¥ç›¸å…³é…ç½®">1) redis è¿æ¥ç›¸å…³é…ç½®</h2>

<table>
  <thead>
    <tr>
      <th>é…ç½®å‚æ•°</th>
      <th>ä½œç”¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>bind</td>
      <td>è®¾ç½®æœåŠ¡ç«¯ç»‘å®šçš„ipï¼Œæœ¬è´¨æ˜¯socketé€šä¿¡ä¸­çš„bind()å‡½æ•°ã€‚å¦‚æœredisä¸æŒ‡å®šbindå‚æ•°ï¼Œå°±æ˜¯ç»‘å®šæœåŠ¡ç«¯ä»»æ„ç½‘å¡</td>
    </tr>
    <tr>
      <td>port</td>
      <td>redisæœåŠ¡ç»‘å®šçš„ç«¯å£</td>
    </tr>
    <tr>
      <td>tcp-keepalive</td>
      <td>ä¿æ´»ç­–ç•¥ï¼Œå•ä½æ˜¯ç§’ã€‚redisæœåŠ¡æ”¯æŒçš„è¿æ¥æ•°æ˜¯æœ‰é™çš„ï¼Œä¸ç”¨çš„è¿æ¥éœ€è¦åŠæ—¶é‡Šæ”¾ï¼Œå¦åˆ™æ˜¯æµªè´¹ã€‚</td>
    </tr>
    <tr>
      <td>requirepass</td>
      <td>è®¾ç½®redisçš„ç™»å½•å¯†ç ï¼Œå®¢æˆ·ç«¯è¿æ¥æ—¶ä½¿ç”¨</td>
    </tr>
  </tbody>
</table>

<h2 id="2-redisæ—¥å¿—ç›¸å…³é…ç½®">2) redisæ—¥å¿—ç›¸å…³é…ç½®</h2>

<table>
  <thead>
    <tr>
      <th>é…ç½®å‚æ•°</th>
      <th>ä½œç”¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>loglevel</td>
      <td>æ—¥å¿—çº§åˆ«</td>
    </tr>
    <tr>
      <td>logfile</td>
      <td>æ—¥å¿—æ–‡ä»¶</td>
    </tr>
  </tbody>
</table>

<p>æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ä¸ºnoticeï¼Œå¼€å‘é˜¶æ®µdebugï¼Œä¸Šçº¿é˜¶æ®µnoticeæˆ–warningã€‚
å¦‚æœlogfileæ²¡æœ‰æŒ‡å®šï¼Œä¼šè¾“å‡ºåˆ°æ§åˆ¶å°ç»ˆç«¯ï¼Œå¦‚æœä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œï¼Œä¼šè¾“å‡ºåˆ°/dev/nullã€‚logfileå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚</p>

<h2 id="3redisæŒä¹…åŒ–ç›¸å…³é…ç½®">3redisæŒä¹…åŒ–ç›¸å…³é…ç½®</h2>

<p>redisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¤§éƒ¨åˆ†æ—¶é—´ï¼Œæ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥é«˜æ•ˆï¼Œä½†æ˜¯redisæœåŠ¡å…³é—­åï¼Œå†…å­˜ä¸­çš„æ•°æ®ä¼šæ¶ˆå¤±ã€‚</p>

<h3 id="redisæŒä¹…åŒ–">redisæŒä¹…åŒ–</h3>

<p>redisæ”¯æŒæŒä¹…åŒ–ï¼Œåœ¨é€‚å½“çš„æ—¶æœºé‡‡ç”¨é€‚å½“çš„ç­–ç•¥ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸­ï¼ŒredisæœåŠ¡é‡å¯æ—¶å¯ä»¥å†æ¬¡åŠ è½½åˆ°å†…å­˜ä¸­ä½¿ç”¨ã€‚
ä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼ŒRDBç­–ç•¥å’Œ</p>

<p><strong>RDBç­–ç•¥</strong></p>

<p>é€šè¿‡å¿«ç…§çš„æ–¹å¼æŒä¹…åŒ–ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…æ¯æ‰§è¡Œè‹¥å¹²æ¬¡å†™æ“ä½œä¹‹åï¼Œå°±è§¦å‘ä¸€æ¬¡æŒä¹…åŒ–ï¼ˆå¿«ç…§ï¼‰ã€‚æ‰€ä»¥æœ€åä¸€æ¬¡å¿«ç…§ä¹‹åæ“ä½œçš„æ•°æ®ä¼šä¸¢å¤±ã€‚
<strong>redisé»˜è®¤é‡‡ç”¨çš„æ˜¯RDBçš„æŒä¹…åŒ–ç­–ç•¥</strong>ã€‚å¦‚æœè¦å…³é—­RDBç­–ç•¥ï¼Œéœ€è¦æ³¨é‡Šæ‰é…ç½®æ–‡ä»¶redis.confä¸­çš„æ‰€æœ‰saveå‚æ•°ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># save seconds changes
# å¤šå°‘ç§’å®Œæˆå¤šå°‘æ¬¡æ”¹å˜ï¼ˆå†™æ“ä½œï¼‰ï¼Œå°±è§¦å‘ä¸€æ¬¡å†™æ“ä½œ

# redisé»˜è®¤RDBç­–ç•¥
save 900 1
219 save 300 10
220 save 60 10000
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>é…ç½®å‚æ•°</th>
      <th>ä½œç”¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>save</td>
      <td>è®¾ç½®rdbæŒä¹…åŒ–ç­–ç•¥</td>
    </tr>
    <tr>
      <td>dbfilename</td>
      <td>redisæŒä¹…åŒ–æ•°æ®ç”Ÿæˆçš„æ–‡ä»¶åï¼Œé»˜è®¤æ˜¯dump.rdb</td>
    </tr>
    <tr>
      <td>dir</td>
      <td>redisæŒä¹…åŒ–æ•°æ®ç”Ÿæˆæ–‡ä»¶ä¿å­˜çš„ç›®å½•ï¼Œé»˜è®¤æ˜¯./ï¼Œå³å¯åŠ¨ç›®å½•</td>
    </tr>
    <tr>
      <td>rdbcompression</td>
      <td>è®¾ç½®å¯¹å­˜å‚¨åˆ°ç£ç›˜çš„å¿«ç…§è¿›è¡Œå‹ç¼©</td>
    </tr>
  </tbody>
</table>

<p>æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ä¸ºnoticeï¼Œå¼€å‘é˜¶æ®µdebugï¼Œä¸Šçº¿é˜¶æ®µnoticeæˆ–warningã€‚
å¦‚æœlogfileæ²¡æœ‰æŒ‡å®šï¼Œä¼šè¾“å‡ºåˆ°æ§åˆ¶å°ç»ˆç«¯ï¼Œå¦‚æœä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œï¼Œä¼šè¾“å‡ºåˆ°/dev/nullã€‚logfileå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚</p>

<p><strong>AOFç­–ç•¥</strong></p>

<p>append only fileã€‚é‡‡ç”¨æ“ä½œæ—¥å¿—æ¥è®°å½•æ¯ä¸€æ¬¡å†™æ“ä½œã€‚æ¯æ¬¡redisæœåŠ¡å¯åŠ¨æ—¶ï¼Œéƒ½ä¼šé‡æ–°æ‰§è¡Œä¸€éæ“ä½œæ—¥å¿—ä¸­çš„æŒ‡ä»¤ã€‚</p>

<table>
  <thead>
    <tr>
      <th>é…ç½®å‚æ•°</th>
      <th>ä½œç”¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>appendonly</td>
      <td>æ˜¯å¦å¼€å¯aofç­–ç•¥</td>
    </tr>
    <tr>
      <td>appendfilename</td>
      <td>aofæŒä¹…åŒ–çš„ä¿å­˜çš„æ–‡ä»¶å</td>
    </tr>
    <tr>
      <td>appendfsync</td>
      <td>aofå¼‚æ­¥æŒä¹…åŒ–ç­–ç•¥ã€‚<br />always:åŒæ­¥æŒä¹…åŒ–ï¼Œæ¯æ¬¡å‘ç”Ÿæ•°æ®å˜åŒ–éƒ½ä¼šç«‹åˆ»å†™å…¥ç£ç›˜ï¼Œæ€§èƒ½è¾ƒå·®ï¼Œä½†æ•°æ®å®Œæ•´æ€§å¥½;<br />everysec:å‡ºå‚é»˜è®¤æ¨èï¼Œæ¯ç§’å¼‚æ­¥è®°å½•ä¸€æ¬¡;<br />no:ä¸åŠæ—¶åŒæ­¥ï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶åŒæ­¥;</td>
    </tr>
  </tbody>
</table>

<h2 id="4-å…¶å®ƒé…ç½®">4) å…¶å®ƒé…ç½®</h2>

<table>
  <thead>
    <tr>
      <th>é…ç½®å‚æ•°</th>
      <th>ä½œç”¨</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>databases</td>
      <td>æ•°æ®åº“æ•°é‡</td>
    </tr>
    <tr>
      <td>requirepass</td>
      <td>è®¾ç½®redisæœåŠ¡ç™»å½•å¯†ç ï¼Œé…åˆå®‰å…¨æ¨¡å¼(protected-mode=yes)ä½¿ç”¨ï¼Œä¸å»ºè®®è®¾ç½®å¯†ç ï¼Œå› ä¸ºredisè¿½æ±‚çš„æ˜¯é«˜æ•ˆï¼Œè®¾ç½®å¯†ç åï¼Œæ¯æ¬¡redisè¯·æ±‚éƒ½ä¼šéªŒè¯æƒé™å’Œå¯†ç ï¼Œå½±å“æ•ˆç‡ã€‚</td>
    </tr>
    <tr>
      <td>masterauth</td>
      <td>redisé›†ç¾¤å¯†ç ï¼Œä¸»è¦æ˜¯é’ˆå¯¹masterå¯¹åº”çš„slaveèŠ‚ç‚¹è®¾ç½®çš„ï¼Œåœ¨slaveèŠ‚ç‚¹æ•°æ®åŒæ­¥çš„æ—¶å€™ç”¨åˆ°ã€‚é›†ç¾¤çš„masterauthå¿…é¡»ä¸€è‡´ã€‚</td>
    </tr>
  </tbody>
</table>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>requirepasså’ŒmasterauthåŒºåˆ«ï¼š
requirepassï¼šä¸»è¦ç”¨äºrediså®¢æˆ·ç«¯ç™»å½•redisæœåŠ¡ç«¯çš„ç™»å½•å¯†ç ï¼Œæ¯ä¸ªredisæœåŠ¡éƒ½å¯ä»¥è®¾ç½®è‡ªå·±çš„ç™»å½•å¯†ç ï¼Œä¸€èˆ¬ä¸è®¾ç½®
masterauthï¼šä¸»è¦ç”¨äºredisé›†ç¾¤å¯†ç ï¼Œé›†ç¾¤ä¸­çš„ä¸»æœºå’Œä»æœºçš„é›†ç¾¤å¯†ç å¿…é¡»ç›¸åŒï¼Œåœ¨é›†ç¾¤ä¸­å¿…é¡»è®¾ç½®ï¼Œä¸è®¾ç½®ï¼Œä»æœºè¿ä¸ä¸Šä¸»æœºã€‚
</code></pre></div></div>

<h1 id="redisäº‹åŠ¡">Redisäº‹åŠ¡</h1>

<p>transactionã€‚
äº‹åŠ¡ï¼šæŠŠä¸€ç»„æ•°æ®åº“æ“ä½œï¼ˆå°¤å…¶æ˜¯å†™æ“ä½œï¼‰æ”¾åœ¨ä¸€èµ·æ‰§è¡Œï¼Œä¿è¯æ“ä½œåŸå­æ€§ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚
redisäº‹åŠ¡ï¼šå…è®¸æŠŠä¸€ç»„rediså‘½ä»¤æ”¾åœ¨ä¸€èµ·æ‰§è¡Œï¼ŒæŠŠå‘½ä»¤è¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åä¸€èµ·æ‰§è¡Œã€‚<strong>redisåªèƒ½ä¿è¯éƒ¨åˆ†åŸå­æ€§</strong>ã€‚</p>

<h2 id="transactionsç»„å¸¸è§å‘½ä»¤">transactionsç»„å¸¸è§å‘½ä»¤</h2>

<p>transactionsç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @transactionsæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @transactions
</code></pre></div></div>

<h3 id="multi">multi</h3>

<p>æ ‡è®°ä¸€ä¸ªäº‹åŠ¡çš„å¼€å§‹ã€‚æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å¼€å§‹ä¹‹åï¼Œè¾“å…¥çš„æ‰€æœ‰æ“ä½œå‘½ä»¤ï¼Œéƒ½ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯æ”¾å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°ç»™å‡ºäº‹åŠ¡æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åé¡ºåºæ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>multi

  MULTI -
  summary: Mark the start of a transaction block
  since: 1.2.0
  group: transactions
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
10.10.10.221:6379&gt; multi
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
QUEUED
10.10.10.221:6379&gt; <span class="nb">set </span>k2 v2
QUEUED
10.10.10.221:6379&gt; <span class="nb">exec
</span>1<span class="o">)</span> OK
2<span class="o">)</span> OK
10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"k2"</span>
2<span class="o">)</span> <span class="s2">"k1"</span>
</code></pre></div></div>

<h3 id="exec">exec</h3>

<p>å¼€å§‹æ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help exec

  </span>EXEC -
  summary: Execute all commands issued after MULTI
  since: 1.2.0
  group: transactions
</code></pre></div></div>

<h3 id="åŸå­æ€§æ¡ˆä¾‹">åŸå­æ€§æ¡ˆä¾‹</h3>

<p>æ¡ˆä¾‹-äº‹åŠ¡åŸå­æ€§1ï¼š<strong>é”™è¯¯çš„å‘½ä»¤</strong>å‹å…¥äº‹åŠ¡é˜Ÿåˆ—ä¸­ï¼Œä¼šå‹å…¥å¤±è´¥ï¼Œåˆ™æœ¬äº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸æ‰§è¡Œï¼Œèƒ½å¤Ÿä¿è¯åŸå­æ€§ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>multi
<span class="nb">set </span>k1 v1
setwww k2 v2
<span class="nb">exec</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
10.10.10.221:6379&gt; multi
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
QUEUED
10.10.10.221:6379&gt; setwww k2 v2
<span class="o">(</span>error<span class="o">)</span> ERR unknown <span class="nb">command</span> <span class="sb">`</span>setwww<span class="sb">`</span>, with args beginning with: <span class="sb">`</span>k2<span class="sb">`</span>, <span class="sb">`</span>v2<span class="sb">`</span>, 
10.10.10.221:6379&gt; <span class="nb">exec</span>
<span class="o">(</span>error<span class="o">)</span> EXECABORT Transaction discarded because of previous errors.
10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
</code></pre></div></div>

<p>æ¡ˆä¾‹-äº‹åŠ¡éƒ¨åˆ†åŸå­æ€§ï¼šå‘½ä»¤å‹å…¥äº‹åŠ¡é˜Ÿåˆ—æ­£å¸¸ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œäº‹åŠ¡é˜Ÿåˆ—å‘½ä»¤æ—¶ï¼Œ<strong>å‘½ä»¤æ‰§è¡Œé”™è¯¯</strong>ï¼Œåˆ™åªå½±å“å‘ç”Ÿé”™è¯¯çš„å‘½ä»¤ï¼Œä¸ä¼šå½±å“å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>multi
set k1 v1
incr k1
set k2 v2
exec

# k1å¯¹åº”çš„å€¼æ˜¯v1ï¼Œæ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯æ•´å½¢æ•°å€¼ï¼Œincr k1æ‰§è¡Œä¼šå‡ºé”™
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
10.10.10.221:6379&gt; multi
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
QUEUED
10.10.10.221:6379&gt; incr k1
QUEUED
10.10.10.221:6379&gt; <span class="nb">set </span>k2 v2
QUEUED
10.10.10.221:6379&gt; <span class="nb">exec
</span>1<span class="o">)</span> OK
2<span class="o">)</span> <span class="o">(</span>error<span class="o">)</span> ERR value is not an integer or out of range
3<span class="o">)</span> OK
10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"k2"</span>
2<span class="o">)</span> <span class="s2">"k1"</span>
</code></pre></div></div>

<h3 id="discard">discard</h3>

<p>ä¸¢å¼ƒå·²ç»å‹å…¥äº‹åŠ¡é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ï¼Œå¹¶ç»“æŸæ•´ä¸ªäº‹åŠ¡ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>discard

  DISCARD -
  summary: Discard all commands issued after MULTI
  since: 2.0.0
  group: transactions
</code></pre></div></div>

<h3 id="watch">watch</h3>

<p>watch ç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ª key , è·Ÿè¸ª key çš„ value ä¿®æ”¹æƒ…å†µï¼Œå¦‚æœæœ‰key çš„ value å€¼åœ¨äº‹åŠ¡ exec æ‰§è¡Œä¹‹å‰è¢«ä¿®æ”¹äº†ï¼Œæ•´ä¸ªäº‹åŠ¡è¢«å–æ¶ˆã€‚exec è¿”å›æç¤ºä¿¡æ¯ï¼Œè¡¨ç¤ºäº‹åŠ¡å·²ç»å¤±è´¥ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>watché…åˆmultiã€execä¸€èµ·ä½¿ç”¨
Redisç¦æ­¢åœ¨multiå’Œexecä¹‹é—´æ‰§è¡ŒwatchæŒ‡ä»¤ï¼Œè€Œå¿…é¡»åœ¨ multiä¹‹å‰åšå¥½ç›¯ä½å…³é”®å˜é‡ï¼Œå¦åˆ™ä¼šå‡ºé”™
watchä½¿çš„äº‹åŠ¡execå˜çš„æœ‰æ¡ä»¶ï¼Œäº‹åŠ¡åªæœ‰åœ¨è¢«watchçš„keyæ²¡æœ‰ä¿®æ”¹çš„å‰æä¸‹æ‰èƒ½æ‰§è¡Œã€‚ä¸æ»¡è¶³æ¡ä»¶ï¼Œäº‹åŠ¡è¢«å–æ¶ˆã€‚
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>watch

  WATCH key <span class="o">[</span>key ...]
  summary: Watch the given keys to determine execution of the MULTI/EXEC block
  since: 2.2.0
  group: transactions
</code></pre></div></div>

<p>å®¢æˆ·ç«¯1ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
<span class="o">(</span>empty list or <span class="nb">set</span><span class="o">)</span>
10.10.10.221:6379&gt; <span class="nb">set </span>refcount 0
OK
10.10.10.221:6379&gt; watch refcount
OK
10.10.10.221:6379&gt; multi
OK
10.10.10.221:6379&gt; <span class="nb">set </span>k1 v1
QUEUED
10.10.10.221:6379&gt; <span class="nb">set </span>k2 v2
QUEUED
10.10.10.221:6379&gt; <span class="nb">set </span>k3 v3
QUEUED
10.10.10.221:6379&gt; <span class="nb">exec</span>
<span class="o">(</span>nil<span class="o">)</span>
</code></pre></div></div>

<p>å®¢æˆ·ç«¯2ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; keys <span class="k">*</span>
1<span class="o">)</span> <span class="s2">"refcount"</span>
10.10.10.221:6379&gt; incr refcount
<span class="o">(</span>integer<span class="o">)</span> 1
10.10.10.221:6379&gt; get refcount
<span class="s2">"1"</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>åœ¨watchä¹‹åï¼Œåˆ°execä¹‹å‰ï¼Œå¦‚æœwatchç›‘è§†çš„keyè¢«ä¿®æ”¹ï¼ˆæ¯”å¦‚è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼‰ï¼Œåˆ™execå¤±è´¥ã€‚
</code></pre></div></div>

<h3 id="unwatch">unwatch</h3>

<p>å–æ¶ˆæ‰€æœ‰çš„ç›‘è§†ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>unwatch

  UNWATCH -
  summary: Forget about all watched keys
  since: 2.2.0
  group: transactions
</code></pre></div></div>

<div class="language-s highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ç›‘è§†å–æ¶ˆçš„æ—¶æœº</span><span class="err">ï¼š</span><span class="w">
</span><span class="err">â‘ </span><span class="n">watchå‘½ä»¤å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡</span><span class="err">ã€‚</span><span class="n">å¯¹é”®çš„ç›‘è§†ä»watchæ‰§è¡Œä¹‹åå¼€å§‹ç”Ÿæ•ˆ</span><span class="err">ï¼Œ</span><span class="n">ç›´åˆ°è°ƒç”¨execä¸ºæ­¢</span><span class="err">ã€‚</span><span class="n">ä¸ç®¡äº‹åŠ¡æ˜¯å¦æˆåŠŸæ‰§è¡Œ</span><span class="err">ï¼Œ</span><span class="n">å¯¹æ‰€æœ‰é”®çš„ç›‘è§†éƒ½ä¼šè¢«å–æ¶ˆ</span><span class="err">ã€‚</span><span class="w">
</span><span class="err">â‘¡</span><span class="n">å½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶</span><span class="err">ï¼Œ</span><span class="n">è¯¥å®¢æˆ·ç«¯å¯¹é”®çš„ç›‘è§†ä¹Ÿä¼šè¢«å–æ¶ˆ</span><span class="err">ã€‚</span><span class="w">
</span><span class="err">â‘¢</span><span class="n">unwatchå‘½ä»¤å¯ä»¥æ‰‹åŠ¨å–æ¶ˆå¯¹æ‰€æœ‰é”®çš„ç›‘è§†</span><span class="err">ã€‚</span><span class="n">unwatchå‘½ä»¤åº”è¯¥åœ¨watchä¹‹å</span><span class="err">ï¼Œ</span><span class="n">multiä¹‹å‰æ‰§è¡Œ</span><span class="err">ï¼Œ</span><span class="n">å¦‚æœunwatchæ”¾å…¥multiä¹‹å</span><span class="err">ï¼Œ</span><span class="n">execä¹‹å‰</span><span class="err">ï¼Œ</span><span class="n">ä¸ä¼šèµ·åˆ°unwatchçš„ä½œç”¨</span><span class="err">ã€‚</span><span class="w">
</span></code></pre></div></div>

<h1 id="redisæ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…">Redisæ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…</h1>

<p>redisæ¶ˆæ¯å’Œå‘å¸ƒï¼Œä¸»è¦ç”¨äºå¤šä¸ªrediså®¢æˆ·ç«¯ä¹‹é—´ã€‚</p>

<p>åœºæ™¯ï¼šrediså®¢æˆ·ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´ä¸èƒ½ç›´æ¥é€šä¿¡ï¼Œéƒ½æ˜¯è¿æ¥çš„redisæœåŠ¡å™¨ã€‚rediså®¢æˆ·ç«¯client1æ›´æ”¹äº†æŸä¸ªæ•°æ®ï¼Œrediså®¢æˆ·ç«¯client2ä¸çŸ¥é“è¢«ä¿®æ”¹ï¼Œrediså®¢æˆ·ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´å¯ä»¥é€šè¿‡rediisæœåŠ¡å™¨æ¥é€šä¿¡ã€‚
redis client2è®¢é˜…æŸä¸ªé¢‘é“channelï¼Œredis client1å¾€é¢‘é“channelå‘é€æ¶ˆæ¯ï¼Œæ­¤æ—¶redis client2å°±ä¼šæ¥æ”¶åˆ°redis client1å‘è¿‡æ¥çš„æ¶ˆæ¯ã€‚</p>

<p><strong>redisæ¶ˆæ¯çš„å‘å¸ƒä¸è®¢é˜…ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚</strong>
<strong>ç›¸åŒç‚¹ï¼š</strong></p>

<table>
  <thead>
    <tr>
      <th>redis</th>
      <th>è§‚å¯Ÿè€…æ¨¡å¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>è®¢é˜…subscribe</td>
      <td>æ³¨å†Œregister</td>
    </tr>
    <tr>
      <td>å‘å¸ƒpublish</td>
      <td>é€šçŸ¥notify</td>
    </tr>
  </tbody>
</table>

<p><strong>åŒºåˆ«ï¼š</strong>
redisï¼š
	å‡å®šæœ‰ä¸€ä¸ªå‘å¸ƒè€…client-publishï¼Œ2ä¸ªè®¢é˜…è€…client-subscribe1å’Œclient-subscribe2ã€‚
	è®¢é˜…çš„åŠ¨ä½œæ˜¯client-subscribeå‘èµ·çš„ï¼Œè®¢é˜…è€…client-subscribeä¼šå¤„äº<strong>é˜»å¡</strong>çŠ¶æ€
è§‚å¯Ÿè€…ï¼š
	å‡å®šæœ‰ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼ˆå§‘ä¸”ç§°ä¸ºä¸­å¿ƒï¼‰centerï¼Œ2ä¸ªè§‚å¯Ÿè€…observer1å’Œobserver2ã€‚
	æ³¨å†Œçš„åŠ¨ä½œæ˜¯ä¸­å¿ƒå‘èµ·çš„ï¼Œcenter-&gt;register(observer1)ï¼Œcenter-&gt;register(observer2)ï¼Œæ‰€ä»¥è§‚å¯Ÿè€…<strong>éé˜»å¡</strong>ã€‚</p>

<h2 id="pubsubç»„å¸¸è§å‘½ä»¤">pubsubç»„å¸¸è§å‘½ä»¤</h2>

<p>sub -&gt; subscribeï¼Œè®¢é˜…
pub -&gt; publishï¼Œå‘å¸ƒ</p>

<p>pubsubç»„çš„å…¨éƒ¨å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡help @pubsubæ¥æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help</span> @pubsub
</code></pre></div></div>

<h3 id="subscribe">subscribe</h3>

<p>rediså®¢æˆ·ç«¯å¯ä»¥è®¢é˜…(æˆ–ç›‘å¬)å¤šä¸ªç»™å®šçš„é¢‘é“ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>subscribe

  SUBSCRIBE channel <span class="o">[</span>channel ...]
  summary: Listen <span class="k">for </span>messages published to the given channels
  since: 2.0.0
  group: pubsub
</code></pre></div></div>

<p>redis client1:è®¢é˜…é¢‘é“</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; subscribe channel1 channel2
Reading messages... <span class="o">(</span>press Ctrl-C to quit<span class="o">)</span>
1<span class="o">)</span> <span class="s2">"subscribe"</span>
2<span class="o">)</span> <span class="s2">"channel1"</span>
3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
1<span class="o">)</span> <span class="s2">"subscribe"</span>
2<span class="o">)</span> <span class="s2">"channel2"</span>
3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
</code></pre></div></div>

<p>redis client2ï¼šç»™é¢‘é“å‘å¸ƒæ¶ˆæ¯</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; publish channel1 hello
<span class="o">(</span>integer<span class="o">)</span> 1
</code></pre></div></div>

<p>æ­¤æ—¶redis client1æ”¶åˆ°é¢‘é“æ¶ˆæ¯</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; subscribe channel1 channel2
Reading messages... <span class="o">(</span>press Ctrl-C to quit<span class="o">)</span>
1<span class="o">)</span> <span class="s2">"subscribe"</span>
2<span class="o">)</span> <span class="s2">"channel1"</span>
3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
1<span class="o">)</span> <span class="s2">"subscribe"</span>
2<span class="o">)</span> <span class="s2">"channel2"</span>
3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2


1<span class="o">)</span> <span class="s2">"message"</span>
2<span class="o">)</span> <span class="s2">"channel1"</span>
3<span class="o">)</span> <span class="s2">"hello"</span>
</code></pre></div></div>

<h3 id="publish">publish</h3>

<p>rediså®¢æˆ·ç«¯å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šé¢‘é“ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>publish

  PUBLISH channel message
  summary: Post a message to a channel
  since: 2.0.0
  group: pubsub
</code></pre></div></div>

<h3 id="psubscribe">psubscribe</h3>

<p>rediså®¢æˆ·ç«¯å¯ä»¥è®¢é˜…(æˆ–ç›‘å¬)å¤šä¸ªç»™å®šçš„é¢‘é“ã€‚è®¢é˜…çš„é¢‘é“æ”¯æŒé€šé…ç¬¦</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>psubscribe

  PSUBSCRIBE pattern <span class="o">[</span>pattern ...]
  summary: Listen <span class="k">for </span>messages published to channels matching the given patterns
  since: 2.0.0
  group: pubsub
</code></pre></div></div>

<h1 id="redisä¸»ä»å¤åˆ¶">redisä¸»ä»å¤åˆ¶</h1>

<p>master/slaveæœºåˆ¶ï¼š
<strong>ä¸»å°‘ä»å¤š</strong>
<strong>ä¸»å†™ä»è¯»</strong>
<strong>è¯»å†™åˆ†ç¦»</strong>
ä¸€æ—¦ä¸»ä»å…³ç³»ç¡®å®šï¼Œ<strong>ä¸»æœºä¸Šå·²æœ‰æ•°æ®è‡ªåŠ¨åŒæ­¥å¤åˆ¶åˆ°ä»æœº</strong>ã€‚</p>

<h2 id="æ­å»ºä¸€ä¸»äºŒä»é›†ç¾¤">æ­å»ºä¸€ä¸»äºŒä»é›†ç¾¤</h2>

<p>æ­å»º3å°redisæœåŠ¡ã€‚å®é™…ç”Ÿäº§ä¸­ä½¿ç”¨3å°æœåŠ¡å™¨ã€‚
<strong>redisé›†ç¾¤ä¸­çš„æœºå™¨ï¼Œéœ€è¦å®‰è£…ç›¸åŒçš„redisç‰ˆæœ¬ã€‚</strong>
è¿™é‡Œä¸ºäº†ç®€åŒ–ï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šæ¨¡æ‹Ÿ3å°redisæœåŠ¡ï¼Œ3ä¸ªæœåŠ¡çš„ç«¯å£åˆ†åˆ«ä¸º6379ã€6380ã€6381ã€‚æŠŠç«¯å£6379æ‰€åœ¨æœåŠ¡ä½œä¸ºä¸»æœºï¼Œ6380ã€6381ä½œä¸ºä»æœºã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. æä¾›3ä»½é…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«ä¸º6379.confã€6380.confã€6381.confã€‚ä¿®æ”¹æ¯ä¸ªé…ç½®æ–‡ä»¶å¦‚ä¸‹ä¿¡æ¯ï¼Œä»¥6380.confä¸ºä¾‹ï¼š
		port		6380								
		pidfile /var/run/redis_6380.pid
		logfile "/tmp/redis/redis_6380.log"
		dbfilename dump_6380.rdb
		masterauth masterpassword
		
		ä¸»æœºå’Œä»æœºçš„masterauthå¯†ç éœ€è¦è®¾ç½®ï¼Œå¹¶ä¸”è®¾ç½®ç›¸åŒå¯†ç 
2. ç”¨3ä¸ªé…ç½®æ–‡ä»¶å¯åŠ¨ä¸‰æ¬¡redis-serveræœåŠ¡(æ­¤æ—¶çš„ä¸‰ä¸ªæœåŠ¡å„è‡ªç‹¬ç«‹)
3. å¼€å¯ä¸‰ä¸ªserver-cliï¼Œåˆ†åˆ«è¿ä¸‰ä¸ªæœåŠ¡
4. æŸ¥çœ‹æ¯ä¸ªredisæœåŠ¡çš„è§’è‰²ã€‚info replication
		æ­¤æ—¶æ¯ä¸ªredisæœåŠ¡éƒ½æ˜¯ä¸»æœºmaster
5. è¿æ¥6380ã€6381çš„ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼Œåˆ†åˆ«æ‰§è¡Œslaveof 10.10.10.221 6379
6. å†æ¬¡æŸ¥çœ‹redisæœåŠ¡è§’è‰²ã€‚info replication
		æ­¤æ—¶6379æ˜¯ä¸»æœºmasterï¼Œ6380ã€6381æ˜¯slave				
</code></pre></div></div>

<p>å¦‚æœä¸»æœºèƒ½æ˜¾ç¤ºä»æœºï¼Œä»æœºæ˜¾ç¤ºä¸»æœºdownï¼Œä¸èƒ½ä»ä¸»æœºå¤åˆ¶åˆ°ä»æœºï¼Œå¯èƒ½éœ€è¦å…ˆåˆ é™¤dump.rdbæ•°æ®æ–‡ä»¶ï¼Œé‡æ–°å¯åŠ¨redisæœåŠ¡ï¼Œå¦‚æœdump.rdbä¸­å·²æœ‰æ•°æ®ï¼Œæ…é‡åˆ é™¤ã€‚</p>

<h3 id="serverç»„å¸¸è§å‘½ä»¤">serverç»„å¸¸è§å‘½ä»¤</h3>

<h3 id="slaveof">slaveof</h3>

<p>è®¾ç½®ä¸»ä»å…³ç³»ï¼Œ<strong>è®¾ä»ä¸è®¾ä¸»</strong>ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6379&gt; <span class="nb">help </span>slaveof

  SLAVEOF host port
  summary: Make the server a slave of another instance, or promote it as master
  since: 1.0.0
  group: server
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ä¸¤ç§ç”¨æ³•</span>
<span class="c"># ç”¨æ³•1ï¼šè®¾ç½®ä¸»ä»å…³ç³»ï¼Œä»å±äºæŸä¸ªmasterä¸»æœº</span>
slaveof host port
<span class="c"># ç”¨æ³•2: æ”¾å¼ƒä¸»ä»å…³ç³»ï¼Œè‡ªå·±æå‡ä¸ºmasterã€‚</span>
slaveof no one

<span class="c"># ç”¨æ³•1ç”¨æ¥æ­å»ºä¸»ä»é›†ç¾¤ï¼Œè®©ä»æœºéš¶å±äºæŸä¸ªä¸»æœº</span>
<span class="c"># ç”¨æ³•2ç”¨æ¥æå‡ä»æœºçš„è§’è‰²ï¼Œæˆä¸ºmaster</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6380&gt; slaveof 10.10.10.221 6379
OK
10.10.10.221:6380&gt; info replication
<span class="c"># Replication</span>
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:up
master_last_io_seconds_ago:5
master_sync_in_progress:0
slave_repl_offset:14
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:14
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:14
10.10.10.221:6380&gt; 
</code></pre></div></div>

<p><strong>a) å¦‚æœä¸»æœºå®•æœºï¼Œç«¯å£ä¸º6379çš„redisæœåŠ¡å…³é—­ã€‚</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æŸ¥çœ‹ä»æœºåœ¨é›†ç¾¤ä¸­çŠ¶æ€
ä»æœºè§’è‰²ä¸å˜<span class="o">(</span>role:slave<span class="o">)</span>
æ˜¾ç¤ºä¸»æœºå®•æœº<span class="o">(</span>master_link_status:down<span class="o">)</span>
ä»æœºä»ç„¶åªè¯»ä¸å†™
</code></pre></div></div>

<p>ä¸»æœºé‡æ–°å¯åŠ¨ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ä¸»æœºé‡æ–°å¯åŠ¨åï¼Œä¸éœ€è¦åšä»»ä½•è®¾ç½®ï¼Œå³å¯æ¢å¤ä¸»æœºmasterèº«ä»½ï¼Œä»æœºä»ç„¶é™„å±äºä¸»æœºã€‚
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.10.10.221:6380&gt; info replication
<span class="c"># Replication</span>
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:down
master_last_io_seconds_ago:-1
master_sync_in_progress:0
slave_repl_offset:10805
master_link_down_since_seconds:6
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:c788b7684bb1d2fe873d86ef4428849b8763abbd
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:10805
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:10470
repl_backlog_histlen:336
10.10.10.221:6380&gt; 
</code></pre></div></div>

<p><strong>b) å¦‚æœä»æœºå®•æœºï¼Œç«¯å£ä¸º6380çš„redisæœåŠ¡å…³é—­ã€‚</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æŸ¥çœ‹å…¶ä»–ä»æœºåœ¨é›†ç¾¤ä¸­çŠ¶æ€ï¼šæ²¡æœ‰ä»»ä½•å˜åŒ–
æŸ¥çœ‹ä¸»æœºåœ¨é›†ç¾¤ä¸­çš„çŠ¶æ€ï¼šä»æœºæ•°é‡å°‘äº†ä¸€ä¸ª
</code></pre></div></div>

<p>ä»æœº6380é‡æ–°å¯åŠ¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å®¢æˆ·ç«¯è¿æ¥6380ï¼Œå¹¶æŸ¥çœ‹6380æœåŠ¡åœ¨é›†ç¾¤ä¸­çš„çŠ¶æ€:æˆä¸ºä¸€ä¸ªç‹¬ç«‹çš„masterï¼Œå’Œä¹‹å‰çš„é›†ç¾¤æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚
è¿æ¥6380çš„å®¢æˆ·ç«¯é‡æ–°æ‰§è¡Œslaveof 10.10.10.221 6379
æ­¤æ—¶6380å†æ¬¡æˆä¸º6379çš„ä»æœº
</code></pre></div></div>

<p>å…³é”®ç‚¹ï¼šä»æœºå®•æœºåé‡å¯ï¼Œéœ€è¦é‡æ–°è®¾ç½®ã€‚</p>

<p><strong>a) å¦‚æœä¸»æœºå®•æœºï¼Œè®©ä»æœº6380ä¸Šä½ã€‚</strong></p>

<p>åœºæ™¯ï¼šå¦‚æœä¸»æœºå®•æœºï¼Œå¹¶ä¸”æ— æ³•ä¿®å¤ï¼Œæˆ–è€…ä¿®å¤æ—¶é—´è¿‡é•¿ï¼Œè®©ä¸€ä¸ªä»æœºå‡çº§ä¸ºä¸»æœºã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. è®©6379å®•æœº</span>
10.10.10.221:6379&gt; shutdown
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 2. è®©6380æå‡ä¸ºä¸»æœº</span>
10.10.10.221:6380&gt; slaveof no one
OK
10.10.10.221:6380&gt; info replication
<span class="c"># Replication</span>
role:master
connected_slaves:0
master_replid:05c69556aca23fd551fc0730332605e75648387a
master_replid2:979dc92d8aeb605ea22a2b568d2121dae3d2f321
master_repl_offset:17528
second_repl_offset:17529
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:17528
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 3. è®©6381æˆä¸º6380çš„ä»æœº</span>
10.10.10.221:6381&gt; slaveof 10.10.10.221 6380
OK
10.10.10.221:6381&gt; info replication
<span class="c"># Replication</span>
role:slave
master_host:10.10.10.221
master_port:6380
master_link_status:up
master_last_io_seconds_ago:8
master_sync_in_progress:0
slave_repl_offset:17542
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:05c69556aca23fd551fc0730332605e75648387a
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:17542
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:17529
repl_backlog_histlen:14
</code></pre></div></div>

<h2 id="rediså“¨å…µæœåŠ¡">rediså“¨å…µæœåŠ¡</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redisé›†ç¾¤ä¸­ï¼Œå¦‚æœä¸»æœºå®•æœºï¼Œä»æœºåŸåœ°å¾…å‘½ï¼›æ­¤æ—¶ä»æœºä¸Šä½ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®ã€‚
ç¼ºé™·ï¼šä¸èƒ½ç«‹åˆ»çŸ¥é“è°å®•æœºï¼Œè€Œä¸”éœ€è¦æ‰‹åŠ¨è®¾ç½®ä»æœºä¸Šä½ã€‚
</code></pre></div></div>

<p>æå‡ºäº†å“¨å…µæ¨¡å¼ï¼šä¸»æœºå®•æœºï¼Œä»æœºè‡ªåŠ¨ä¸Šä½ã€‚
ä¸“é—¨çš„å“¨å…µæœåŠ¡ï¼šredis-sentinel
å“¨å…µé…ç½®æ–‡ä»¶:		sentinel.conf</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span>
sentinel monitor xxx1 10.10.10.221 6379 1
<span class="c"># sentinel		ï¼š	è¡¨ç¤ºå“¨å…µ</span>
<span class="c"># monitor			ï¼š	è¡¨ç¤ºç›‘æ§</span>
<span class="c"># master-name	ï¼š	è¡¨ç¤ºå“¨å…µçš„åå­—ï¼Œä»»æ„èµ·ä¸€ä¸ªåå­—</span>
<span class="c"># ip					ï¼š	ç›‘æ§çš„ä¸»æœºipï¼Œredisä¸»æœºä¸­bindçš„ip</span>
<span class="c"># port				ï¼š	ç›‘æ§çš„ç«¯å£</span>
<span class="c"># quorum			ï¼š å¾—åˆ°å“¨å…µçš„æŠ•ç¥¨æ•°</span>

<span class="c"># æ¯”å¦‚æœ‰1ä¸»5ä»ï¼Œä¸»æœºå®•æœºï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªæŠ•ç¥¨æœºåˆ¶ï¼Œå“ªä¸€ä¸ªä»æœºç‡å…ˆåˆ°è¾¾æŒ‡å®šçš„æŠ•ç¥¨æ•°quorumï¼Œå°±å°†è¯¥ä»æœºæå‡ä¸ºä¸»æœºï¼Œå…¶ä½™ä»æœºä»å±äºæ–°ä¸»æœºã€‚</span>
<span class="c"># é»˜è®¤æŠ•ç¥¨æœºåˆ¶ï¼š</span>
<span class="c">#		quorumè¶Šå¤§ï¼Œä¼šæŒ‘é€‰ä¸€ä¸ªæ€§èƒ½æœ€å¥½çš„ä»æœºï¼Œquorumè¶Šå°ï¼Œæ¯”å¦‚ä¸º1ï¼Œåªè¦æœ‰ä¸€ä¸ªä»æœºç‡å…ˆå¾—åˆ°1ç¥¨ï¼Œè¯¥ä»æœºå°±æå‡ä¸ºä¸»æœºã€‚</span>
<span class="c">#		quorumä¸€èˆ¬ç­‰äºæˆ–å°äºä»æœºæ•°ï¼Œquorumå€¼è¶Šå°ï¼ŒæŒ‘é€‰ä»æœºçš„é€Ÿåº¦å°±è¶Šå¿«ï¼Œä¸€èˆ¬é€‰æ‹©ä¸€ä¸ªå±…ä¸­çš„å€¼ã€‚</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"sentinel monitor sm1 10.10.10.221 6379 1"</span> <span class="o">&gt;</span> my_sentinel.conf
<span class="nv">$ </span><span class="c"># å¯åŠ¨å“¨å…µæœåŠ¡</span>
<span class="nv">$ </span>redis-sentinel sentinel.conf
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. ä¸»æœº6379å®•æœº</span>
10.10.10.221:6379&gt; shutdown

<span class="c"># 2. æ ¹æ®å“¨å…µå†…éƒ¨æŠ•ç¥¨è§„åˆ™ï¼Œæ­¤æ—¶ä»æœº6380ä¸Šä½ï¼ŒæŸ¥çœ‹6380é›†ç¾¤çŠ¶æ€</span>
10.10.10.221:6380&gt; info replication
<span class="c"># Replication</span>
role:slave
master_host:10.10.10.221
master_port:6379
master_link_status:down
master_last_io_seconds_ago:-1
master_sync_in_progress:0
slave_repl_offset:22098
master_link_down_since_seconds:4
slave_priority:100
slave_read_only:1
connected_slaves:1
slave0:ip<span class="o">=</span>10.10.10.221,port<span class="o">=</span>6381,state<span class="o">=</span>online,offset<span class="o">=</span>22098,lag<span class="o">=</span>1
master_replid:979dc92d8aeb605ea22a2b568d2121dae3d2f321
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:22098
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:18407
repl_backlog_histlen:3692
10.10.10.221:6380&gt; 

<span class="c"># 3.é‡å¯6379ï¼Œåœ¨å“¨å…µæ¨¡å¼ä¸‹ï¼Œ6379ä¼šä»å±äºæ–°çš„ä¸»æœº6380</span>
</code></pre></div></div>
:ET