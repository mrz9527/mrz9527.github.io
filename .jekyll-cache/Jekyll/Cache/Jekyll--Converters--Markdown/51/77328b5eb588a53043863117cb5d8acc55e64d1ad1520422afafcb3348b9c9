I"¨\<h1 id="å·¥å…·åˆ†ç±»">å·¥å…·åˆ†ç±»</h1>

<ul>
  <li>ç½‘ç»œé…ç½®ç›¸å…³ï¼šifconfigã€ip</li>
  <li>è·¯ç”±ç›¸å…³ï¼šrouteã€netstatã€ip</li>
  <li>æŸ¥çœ‹ç«¯å£å·¥å…·ï¼šnetstatã€lsofã€ssã€ncã€telnet</li>
  <li>ä¸‹è½½å·¥å…·ï¼šcurlã€wgetã€axel</li>
  <li>é˜²ç«å¢™ï¼šiptablesã€ipset</li>
  <li>æµé‡ç›¸å…³ï¼šiftopã€nethogs</li>
  <li>è¿é€šæ€§åŠå“åº”é€Ÿåº¦ï¼špingã€tracerouteã€mtrã€tracepath</li>
  <li>åŸŸåç›¸å…³ï¼šnslookupã€digã€whois</li>
  <li>webæœåŠ¡å™¨ï¼špythonã€nginx</li>
  <li>æŠ“åŒ…ç›¸å…³ï¼štcpdump</li>
  <li>ç½‘æ¡¥ç›¸å…³ï¼šipã€brctlã€ifconfigã€ovs</li>
</ul>

<h1 id="éƒ¨åˆ†å·¥å…·ä»‹ç»">éƒ¨åˆ†å·¥å…·ä»‹ç»</h1>

<h2 id="ping">ping</h2>

<p>é‡‡ç”¨çš„åè®®æ˜¯ICMP</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¸¸è§å‘½ä»¤å‚æ•°
-q ä¸æ˜¾ç¤ºä»»ä½•ä¼ é€å°åŒ…çš„ä¿¡æ¯ï¼Œåªæ˜¾ç¤ºæœ€åçš„ç»“æœ
-n åªè¾“å‡ºæ•°å€¼
-R è®°å½•è·¯ç”±è¿‡ç¨‹
-c count æ€»æ¬¡æ•°
-i æ—¶é—´é—´éš”
-t å­˜æ´»æ•°å€¼ï¼šè®¾ç½®å­˜æ´»æ•°å€¼TTLçš„å¤§å°
-s è®¾ç½®å‘é€åŒ…çš„å¤§å°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œpingå‘½ä»¤æ˜¯ä»¥64å­—èŠ‚å¤§å°çš„æ•°æ®åŒ…æ¥æµ‹è¯•ç½‘ç»œè¿é€šæ€§
</code></pre></div></div>

<h3 id="æµ‹è¯•å¯¹æ–¹ipæ˜¯å¦å­˜åœ¨">æµ‹è¯•å¯¹æ–¹ipæ˜¯å¦å­˜åœ¨</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ping <span class="nt">-c</span> 2 10.10.10.221
PING 10.10.10.221 <span class="o">(</span>10.10.10.221<span class="o">)</span>: 56 data bytes
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.433 ms
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.441 ms
<span class="nt">---</span> 10.10.10.221 ping statistics <span class="nt">---</span>
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class="o">=</span> 0.433/0.437/0.441/0.000 ms
</code></pre></div></div>

<p>å¦‚æœå¯¹æ–¹ç¦æ­¢ICMPåè®®ï¼Œä¹Ÿä¼špingä¸é€š</p>

<h3 id="æµ‹è¯•ç½‘é€Ÿ">æµ‹è¯•ç½‘é€Ÿ</h3>

<p>å°±æ˜¯æŸ¥çœ‹ç½‘ç»œå»¶è¿Ÿ</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.433 ms
<span class="c"># time=0.433 msï¼Œè¡¨ç¤ºç½‘ç»œå»¶è¿Ÿä¸º0.433 ms</span>
</code></pre></div></div>

<h3 id="è§£æåŸŸå">è§£æåŸŸå</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># åŸŸåè½¬ip</span>
<span class="nv">$ </span>ping <span class="nt">-c</span> 2 www.baidu.com
PING www.a.shifen.com <span class="o">(</span>220.181.38.150<span class="o">)</span>: 56 data bytes
64 bytes from 220.181.38.150: <span class="nv">icmp_seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>44 <span class="nb">time</span><span class="o">=</span>5.874 ms
64 bytes from 220.181.38.150: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>44 <span class="nb">time</span><span class="o">=</span>9.107 ms
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># pingå¯¹æ–¹ä¸»æœºï¼Œå‘é€4ä¸ªåŒ…ï¼Œæ¯ä¸ªåŒ…é—´éš”1ç§’</span>
<span class="nv">$ </span>ping <span class="nt">-c</span> 4 <span class="nt">-i</span> 1 10.10.10.221
PING 10.10.10.221 <span class="o">(</span>10.10.10.221<span class="o">)</span>: 56 data bytes
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.447 ms
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.802 ms
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.681 ms
64 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>3 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.597 ms
<span class="nt">---</span> 10.10.10.221 ping statistics <span class="nt">---</span>
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class="o">=</span> 0.447/0.632/0.802/0.129 ms
</code></pre></div></div>

<h3 id="æµ‹è¯•mtu">æµ‹è¯•MTU</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -s é€‰é¡¹æ¥å‘ç°ç½‘ç»œç¯å¢ƒä¸­æœ‰å…³MTUï¼ˆç½‘ç»œä¸Šä¼ æœ€å¤§çš„æ•°æ®åŒ…ï¼‰çš„é—®é¢˜</span>
<span class="nv">$ </span>ping <span class="nt">-c</span> 4 <span class="nt">-i</span> 1 <span class="nt">-s</span> 40 10.10.10.221
PING 10.10.10.221 <span class="o">(</span>10.10.10.221<span class="o">)</span>: 40 data bytes
48 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.354 ms
48 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.587 ms
48 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.399 ms
48 bytes from 10.10.10.221: <span class="nv">icmp_seq</span><span class="o">=</span>3 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.422 ms
<span class="nt">---</span> 10.10.10.221 ping statistics <span class="nt">---</span>
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class="o">=</span> 0.354/0.440/0.587/0.088 ms
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -s å‘é€8192ä¸ªå­—èŠ‚æ•°æ®ï¼Œå‘é€å¤±è´¥ï¼ŒåŒ…è¿‡å¤§</span>
<span class="nv">$ </span>ping <span class="nt">-c</span> 4 <span class="nt">-i</span> 1 <span class="nt">-s</span> 8192 10.10.10.221
PING 10.10.10.221 <span class="o">(</span>10.10.10.221<span class="o">)</span>: 8192 data bytes
ping: sending packet: Message too long
</code></pre></div></div>

<h2 id="telnet">telnet</h2>

<h3 id="æµ‹è¯•å¯¹æ–¹å¼€æ”¾çš„ç«¯å£">æµ‹è¯•å¯¹æ–¹å¼€æ”¾çš„ç«¯å£</h3>

<p>netstatä¹Ÿå¯ä»¥æŸ¥çœ‹ç«¯å£ï¼Œä½†<strong>å±€é™äºæœ¬æœº</strong>ã€‚netstat -tnlpï¼Œå¯ä»¥æŸ¥çœ‹æœ¬åœ°å¤„äºç›‘å¬çš„ç«¯å£å·ã€‚</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telnet ip port
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 22ç«¯å£å­˜åœ¨</span>
<span class="nv">$ </span>telnet 10.10.10.221 22
Trying 10.10.10.221...
Connected to 10.10.10.221.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 5005ç«¯å£ä¸å­˜åœ¨</span>
<span class="nv">$ </span>telnet 10.10.10.221 5005
Trying 10.10.10.221...
telnet: Unable to connect to remote host: Connection refused
</code></pre></div></div>

<h2 id="lsof">lsof</h2>

<p>list open filesã€‚Linuxä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œsocketã€pipeç­‰ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œå› æ­¤èƒ½å¤ŸæŸ¥çœ‹ç½‘ç»œè¿æ¥ä»¥åŠç½‘ç»œè®¾å¤‡ï¼Œå…¶ä¸­å’Œç½‘ç»œç›¸å…³çš„æ˜¯<strong>-i</strong>é€‰é¡¹ã€‚</p>

<h3 id="æŸ¥çœ‹ç½‘ç»œé€šä¿¡çš„è¿›ç¨‹å·">æŸ¥çœ‹ç½‘ç»œé€šä¿¡çš„è¿›ç¨‹å·</h3>

<p>lsofæœ‰å¾ˆå¤šé€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹æœ‰ä¸åŒçš„ä½œç”¨ã€‚<strong>ä½¿ç”¨-ié€‰é¡¹ï¼Œç”¨äºæŸ¥çœ‹ç½‘ç»œé€šä¿¡çš„æœ¬åœ°è¿›ç¨‹</strong>ã€‚lsofå‘½ä»¤å¿…é¡»æœ‰sudoæƒé™</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ç”¨æ³•</span>
lsof <span class="nt">-i</span><span class="o">[</span>46] <span class="o">[</span>protocol][@hostname|hostaddr][:service|port]

lsof <span class="nt">-i</span> //æ˜¾ç¤ºæ‰€æœ‰æ‰“å¼€çš„ç«¯å£
lsof <span class="nt">-i</span>:80 //æ˜¾ç¤ºæ‰€æœ‰æ‰“å¼€80ç«¯å£çš„è¿›ç¨‹
lsof <span class="nt">-i</span> <span class="nt">-U</span> //æ˜¾ç¤ºæ‰€æœ‰æ‰“å¼€çš„ç«¯å£å’ŒUNIX domainæ–‡ä»¶
lsof <span class="nt">-i</span> UDP@[url]www.akadia.com:123 //æ˜¾ç¤ºé‚£äº›è¿›ç¨‹æ‰“å¼€äº†åˆ°www.akadia.comçš„UDPçš„123<span class="o">(</span>ntp<span class="o">)</span>ç«¯å£çš„é“¾æ¥
lsof <span class="nt">-i</span> tcp@ohaha.ks.edu.tw:ftp <span class="nt">-n</span> //lsof <span class="nt">-n</span> ä¸å°†IPè½¬æ¢ä¸ºhostnameï¼Œç¼ºçœæ˜¯ä¸åŠ ä¸Š-nå‚æ•°
</code></pre></div></div>

<p>å®ä¾‹ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># æŸ¥çœ‹æœ¬æœºä¸10.10.10.221:6380çš„tcpé€šä¿¡çš„æœ¬åœ°è¿›ç¨‹ï¼ŒæŸ¥åˆ°æœ¬æœºè¿›ç¨‹idä¸º18434ï¼Œç¨‹åºä¸ºredis-cli</span>
<span class="nb">sudo </span>lsof <span class="nt">-i</span> tcp@10.10.10.221:6380
Password:
COMMAND     PID     USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
redis-cli 18434 xm210408    3u  IPv4 0x9864983a46f27629      0t0  TCP 10.10.10.1:62403-&gt;10.10.10.221:6380 <span class="o">(</span>ESTABLISHED<span class="o">)</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># é€šè¿‡psï¼Œçš„ç¡®æŸ¥åˆ°18434è¿›ç¨‹ã€‚</span>
<span class="nv">$ </span>ps <span class="nt">-ef</span> | <span class="nb">grep </span>redis-cli
  501 18533 18000   0  2:13ä¸‹åˆ ttys001    0:00.00 <span class="nb">grep </span>redis-cli
  501 18434 18281   0 12:50ä¸‹åˆ ttys005    0:00.01 redis-cli <span class="nt">-p</span> 6380 <span class="nt">-h</span> 10.10.10.221
</code></pre></div></div>

<h2 id="netstat">netstat</h2>

<p>netstatä¸€èˆ¬<strong>ç”¨äºæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µ</strong>ï¼Œæ˜¾ç¤ºä¸IPã€TCPã€UDPå’ŒICMPåè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ï¼Œnetstatæ˜¯åœ¨å†…æ ¸ä¸­è®¿é—®ç½‘ç»œåŠç›¸å…³ä¿¡æ¯çš„ç¨‹åºã€‚
<strong>å¸¸ç”¨é€‰é¡¹</strong>ï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-a</span> <span class="o">(</span>all<span class="o">)</span>æ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºLISTENç›¸å…³
<span class="nt">-t</span> <span class="o">(</span>tcp<span class="o">)</span>ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹
<span class="nt">-u</span> <span class="o">(</span>udp<span class="o">)</span>ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹
<span class="nt">-n</span> æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–æˆæ•°å­—
<span class="nt">-l</span> ä»…åˆ—å‡ºæœ‰åœ¨ Listen <span class="o">(</span>ç›‘å¬<span class="o">)</span> çš„æœå‹™çŠ¶æ€
<span class="nt">-p</span> æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æ¥çš„ç¨‹åºå
<span class="nt">-r</span> æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯ï¼Œè·¯ç”±è¡¨
<span class="nt">-e</span> æ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ï¼Œä¾‹å¦‚uidç­‰
<span class="nt">-s</span> æŒ‰å„ä¸ªåè®®è¿›è¡Œç»Ÿè®¡
<span class="nt">-c</span> æ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´ï¼Œæ‰§è¡Œè¯¥netstatå‘½ä»¤
</code></pre></div></div>

<p><strong>çŠ¶æ€status</strong>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LISTENï¼šä¾¦å¬æ¥è‡ªè¿œæ–¹çš„TCPç«¯å£çš„è¿æ¥è¯·æ±‚
SYN-SENTï¼šå†å‘é€è¿æ¥è¯·æ±‚åç­‰å¾…åŒ¹é…çš„è¿æ¥è¯·æ±‚ï¼ˆå¦‚æœæœ‰å¤§é‡è¿™æ ·çš„çŠ¶æ€åŒ…ï¼Œæ£€æŸ¥æ˜¯å¦ä¸­æ‹›äº†ï¼‰
SYN-RECEIVEDï¼šå†æ”¶åˆ°å’Œå‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚åç­‰å¾…å¯¹æ–¹å¯¹è¿æ¥è¯·æ±‚çš„ç¡®è®¤ï¼ˆå¦‚æœ‰å¤§é‡æ­¤çŠ¶æ€ï¼Œä¼°è®¡è¢«floodæ”»å‡»äº†ï¼‰
ESTABLISHEDï¼šä»£è¡¨ä¸€ä¸ªæ‰“å¼€çš„è¿æ¥
FIN-WAIT-1ï¼šç­‰å¾…è¿œç¨‹TCPè¿æ¥ä¸­æ–­è¯·æ±‚ï¼Œæˆ–å…ˆå‰çš„è¿æ¥ä¸­æ–­è¯·æ±‚çš„ç¡®è®¤
FIN-WAIT-2ï¼šä»è¿œç¨‹TCPç­‰å¾…è¿æ¥ä¸­æ–­è¯·æ±‚
CLOSE-WAITï¼šç­‰å¾…ä»æœ¬åœ°ç”¨æˆ·å‘æ¥çš„è¿æ¥ä¸­æ–­è¯·æ±‚
CLOSINGï¼šç­‰å¾…è¿œç¨‹TCPå¯¹è¿æ¥ä¸­æ–­çš„ç¡®è®¤
LAST-ACKï¼šç­‰å¾…åŸæ¥çš„å‘å‘è¿œç¨‹TCPçš„è¿æ¥ä¸­æ–­è¯·æ±‚çš„ç¡®è®¤ï¼ˆä¸æ˜¯ä»€ä¹ˆå¥½ä¸œè¥¿ï¼Œæ­¤é¡¹å‡ºç°ï¼Œæ£€æŸ¥æ˜¯å¦è¢«æ”»å‡»ï¼‰
TIME-WAITï¼šç­‰å¾…è¶³å¤Ÿçš„æ—¶é—´ä»¥ç¡®ä¿è¿œç¨‹TCPæ¥æ”¶åˆ°è¿æ¥ä¸­æ–­è¯·æ±‚çš„ç¡®è®¤
CLOSEDï¼šæ²¡æœ‰ä»»ä½•è¿æ¥çŠ¶æ€
</code></pre></div></div>

<h3 id="æŸ¥çœ‹å¤„äºç›‘å¬çš„tcpè¿æ¥åŠç«¯å£å·">æŸ¥çœ‹å¤„äºç›‘å¬çš„tcpè¿æ¥åŠç«¯å£å·</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>netstat <span class="nt">-tnlp</span>
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:33622         0.0.0.0:<span class="k">*</span>               LISTEN      68787/python3.5 
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN      877/sshd        
tcp        0      0 0.0.0.0:6379            0.0.0.0:<span class="k">*</span>               LISTEN      60037/redis-server 
tcp        0      0 0.0.0.0:6380            0.0.0.0:<span class="k">*</span>               LISTEN      60049/redis-server 
tcp        0      0 0.0.0.0:6381            0.0.0.0:<span class="k">*</span>               LISTEN      60055/redis-server 
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN      877/sshd        
tcp6       0      0 :::6380                 :::<span class="k">*</span>                    LISTEN      60049/redis-server 
tcp6       0      0 :::6381                 :::<span class="k">*</span>                    LISTEN      60055/redis-server 
<span class="nv">$ </span>netstat <span class="nt">-lntp</span> | <span class="nb">awk</span> <span class="s1">'{print $4}'</span> | <span class="nb">cut</span> <span class="nt">-f2</span> <span class="nt">-d</span>: | <span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'[0-9]*'</span>
33622
22
6379
6380
6381
</code></pre></div></div>

<p>ç«¯å£å·33622ã€22ã€6379ã€6380ã€6381å¤„äºç›‘å¬çŠ¶æ€ã€‚</p>

<h3 id="æŸ¥çœ‹è·¯ç”±">æŸ¥çœ‹è·¯ç”±</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>netstat  <span class="nt">-rn</span>
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         10.10.10.2      0.0.0.0         UG        0 0          0 ens33
10.10.10.0      0.0.0.0         255.255.255.0   U         0 0          0 ens33
</code></pre></div></div>

<p>Flagsï¼š</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>U <span class="o">(</span>route is up<span class="o">)</span>ï¼šè¯¥è·¯ç”±æ˜¯æœ‰æ•ˆçš„ï¼›
H <span class="o">(</span>target is a host<span class="o">)</span>ï¼šç›®æ ‡æ˜¯ä¸»æœºè€Œéç½‘åŸŸï¼›
G <span class="o">(</span>use gateway<span class="o">)</span>ï¼šéœ€è¦é€è¿‡å¤–éƒ¨çš„ä¸»æœº <span class="o">(</span>gateway<span class="o">)</span> æ¥è½¬é€’å°åŒ…ï¼ˆä¸€èˆ¬æŒ‡å‘é»˜è®¤ç½‘å…³ï¼‰ï¼›
R <span class="o">(</span>reinstate route <span class="k">for </span>dynamic routing<span class="o">)</span>ï¼šä½¿ç”¨åŠ¨æ€è·¯ç”±æ—¶ï¼Œæ¢å¤è·¯ç”±èµ„è®¯çš„æ——æ ‡ï¼›
D <span class="o">(</span>dynamically installed by daemon or redirect<span class="o">)</span>ï¼šå·²ç»ç”±æœåŠ¡æˆ–è½¬ port åŠŸèƒ½è®¾å®šä¸ºåŠ¨æ€è·¯ç”± <span class="p">;</span>
M <span class="o">(</span>modified from routing daemon or redirect<span class="o">)</span>ï¼šè·¯ç”±å·²ç»è¢«ä¿®æ”¹äº†ï¼›
<span class="o">!</span> <span class="o">(</span>reject route<span class="o">)</span>ï¼šè¿™ä¸ªè·¯ç”±å°†ä¸ä¼šè¢«æ¥å—<span class="o">(</span>ç”¨æ¥æŠµæŒ¡ä¸å®‰å…¨çš„ç½‘åŸŸ<span class="o">)</span><span class="nb">.</span>
</code></pre></div></div>

<h3 id="æŸ¥çœ‹ç½‘å…³">æŸ¥çœ‹ç½‘å…³</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>netstat  <span class="nt">-rn</span>  | <span class="nb">grep  </span>UG  | <span class="nb">tr</span>  <span class="nt">-s</span> <span class="s2">" "</span>  | <span class="nb">cut</span>  <span class="nt">-d</span>  <span class="s2">" "</span>  <span class="nt">-f2</span>
10.10.10.2
</code></pre></div></div>

<h2 id="traceroute">traceroute</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>traceroute <span class="nt">--help</span>
Usage: traceroute <span class="o">[</span>OPTION...] HOST
Print the route packets trace to network host.


  <span class="nt">-m</span>, <span class="nt">--max-hop</span><span class="o">=</span>NUM          è®¾ç½®æ£€æµ‹æ•°æ®åŒ…çš„æœ€å¤§è·³æ•°ï¼Œé»˜è®¤64
  <span class="nt">-M</span>, <span class="nt">--type</span><span class="o">=</span>METHOD          use METHOD <span class="o">(</span><span class="sb">`</span>icmp<span class="s1">' or `udp'</span><span class="o">)</span> <span class="k">for </span>traceroute
                             operations, defaulting to <span class="sb">`</span>udp<span class="s1">'
  -p, --port=PORT            use destination PORT port (default: 33434)
  -w, --wait=NUM             è¶…æ—¶æ—¶é—´ï¼Œè®¾ç½®ç­‰å¾…è¿œç«¯ä¸»æœºå›åº”çš„æ—¶é—´ä¸ºNUMç§’ (default: 3)
</span></code></pre></div></div>

<p>åœ¨windowsä¸Šï¼Œä½¿ç”¨tracertä»£æ›¿ã€‚
æŸ¥çœ‹æœ¬æœºä¸ç›®æ ‡ä¹‹é—´çš„æ‰€æœ‰è·¯ç”±è·¯å¾„ï¼Œèƒ½çœ‹åˆ°æ¯ä¸€è·³çš„ipå’Œè€—æ—¶ã€‚</p>

<h3 id="æŸ¥çœ‹ä¸»æœºåŠç›®æ ‡ä¹‹é—´çš„è·¯ç”±è·¯å¾„">æŸ¥çœ‹ä¸»æœºåŠç›®æ ‡ä¹‹é—´çš„è·¯ç”±è·¯å¾„</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>traceroute www.baidu.com
traceroute to www.a.shifen.com <span class="o">(</span>220.181.38.150<span class="o">)</span>, 64 hops max
  1   10.13.12.1  7.245ms  9.447ms  6.432ms 
  2   10.13.1.1  3.703ms  7.225ms  4.653ms 
  3   211.103.216.33  45.470ms  6.834ms  13.013ms 
  4   10.255.55.17  20.143ms  6.391ms  8.641ms 
  5   10.255.199.173  6.213ms  4.279ms  3.210ms 
  6   124.205.98.141  5.556ms  4.385ms  3.103ms 
  7   124.205.98.53  6.918ms  9.023ms  5.157ms 
  8   218.241.244.149  7.692ms  <span class="k">*</span>  <span class="k">*</span> 
  9   61.149.212.225  6.847ms  <span class="k">*</span>  <span class="k">*</span> 
 10   202.96.13.49  7.415ms  9.764ms  19.080ms 
 11   124.65.194.153  5.189ms  6.904ms  4.337ms 
 12   219.158.13.90  5.172ms  8.460ms  8.154ms 
 13   219.158.44.134  5.351ms  8.369ms  5.777ms 
 14   202.97.18.121  13.423ms  10.767ms  6.134ms 
 15   36.110.246.230  7.364ms  7.476ms  <span class="k">*</span> 
 16   36.110.246.205  16.692ms  17.621ms  10.109ms 
 17   <span class="k">*</span>  <span class="k">*</span>  <span class="k">*</span> 
 18   106.38.244.134  44.541ms  28.065ms  31.264ms 
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ç¬¬ä¸€è·³æ˜¯æœ¬æœºå±€åŸŸç½‘çš„ç½‘å…³:	10.13.12.1
<span class="k">***</span>ï¼šå¯èƒ½æ˜¯é˜²ç«å¢™å°æ‰äº†ICMPçš„è¿”å›ä¿¡æ¯
</code></pre></div></div>

<p>è®¾ç½®è·³æ•° -m</p>

<h2 id="nc">nc</h2>

<p><strong>nc</strong>ï¼ˆæˆ–<strong>netcat</strong>ï¼‰å‡ ä¹æ¶‰åŠæ‰€æœ‰ TCP æˆ– UDP çš„äº‹æƒ…ã€‚å®ƒå¯ä»¥æ‰“å¼€ TCP è¿æ¥ã€å‘é€ UDP æ•°æ®åŒ…ã€ä¾¦å¬ä»»æ„ TCP å’Œ UDP ç«¯å£ã€‚
é»˜è®¤æ˜¯TCPï¼Œ-uå‚æ•°è°ƒæ•´ä¸ºudpã€‚</p>

<h3 id="æµ‹è¯•å¯¹æ–¹å¼€æ”¾çš„ç«¯å£-1">æµ‹è¯•å¯¹æ–¹å¼€æ”¾çš„ç«¯å£</h3>

<p>é»‘å®¢æ”»å‡»å¿…å¤‡</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ä»¥tcpçš„æ–¹å¼å‘ä¸»æœº10.10.10.221çš„20åˆ°30å·ç«¯å£å‘é€è¿æ¥è¯·æ±‚</span>
<span class="nv">$ </span>nc <span class="nt">-zv</span> 10.10.10.221 20-30
nc: connectx to 10.10.10.221 port 20 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 21 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
found 0 associations
found 1 connections:
     1: <span class="nv">flags</span><span class="o">=</span>82&lt;CONNECTED,PREFERRED&gt;
        outif vmnet2
        src 10.10.10.1 port 64439
        dst 10.10.10.221 port 22
        rank info not available
        TCP aux info available

Connection to 10.10.10.221 port 22 <span class="o">[</span>tcp/ssh] succeeded!
nc: connectx to 10.10.10.221 port 23 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 24 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 25 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 26 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 27 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 28 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 29 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
nc: connectx to 10.10.10.221 port 30 <span class="o">(</span>tcp<span class="o">)</span> failed: Connection refused
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-z	: åªè¿æ¥,ä¸å‘é€æ•°æ®
-v	:è¯¦ç»†ä¿¡æ¯
</code></pre></div></div>

<h3 id="å½“åšèŠå¤©å·¥å…·">å½“åšèŠå¤©å·¥å…·</h3>

<p>è¾“å…¥è¾“å‡ºéƒ½åœ¨ç»ˆç«¯ä¸Šã€‚
æ­å»ºï¼šclient1å’Œclient2èŠå¤©</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># åœ¨client1çš„æœ¬æœº(10.10.10.221)ä¸Šç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ¯”å¦‚1567</span>
<span class="nv">$ </span>nc <span class="nt">-l</span> 1567
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># client2å‘client1å‘èµ·tcpè¿æ¥è¯·æ±‚ï¼Œè¿æ¥æˆåŠŸåå³å¯é€šä¿¡</span>
<span class="nv">$ </span>nc 10.10.10.221
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># client1</span>
<span class="nv">$ </span>nc <span class="nt">-l</span> 1567
hello
good
ä½ å¥½ï¼Œzhongguoren
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># client2</span>
<span class="nv">$ </span>nc 10.10.10.221 1567
hello
good
ä½ å¥½ï¼Œzhongguoren
</code></pre></div></div>

<h3 id="æ–‡ä»¶ä¼ è¾“">æ–‡ä»¶ä¼ è¾“</h3>

<p>ä¸»æœºaå‘ä¸»æœºbä¼ è¾“æ–‡ä»¶ã€‚
æ–‡ä»¶ä¼ è¾“å°±æ˜¯åœ¨èŠå¤©åŠŸèƒ½çš„åŸºç¡€ä¸ŠåŠ å…¥äº†é‡å®šå‘åˆ°æ–‡ä»¶çš„åŠŸèƒ½ã€‚
æ­å»ºï¼šclient1å’Œclient2æ–‡ä»¶ä¼ è¾“</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># &lt;å‘é€æ–‡ä»¶</span>
<span class="nv">$ </span>nc <span class="nt">-l</span> 1567 &lt; a.txt
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># &gt;æ¥æ”¶æ–‡ä»¶</span>
<span class="nv">$ </span>nc 10.10.10.221 <span class="o">&gt;</span> a.txt
</code></pre></div></div>
:ET